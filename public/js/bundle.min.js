"use strict";function init(){sticky(),windowScrollDown()}function sticky(){$(".sticky").sticky({topSpacing:60})}function windowScrollDown(){var e,o=0;$(window).scroll(function(){e=$(this).scrollTop(),$(window).scrollTop()>30&&(o>e?($(".home-page nav").removeClass("folded"),$(".home-page nav").css("border-bottom","0px solid")):$(".home-page nav").addClass("folded")),o=e,$(window).scrollTop()<10&&$(".home-page nav").addClass("top"),$(window).scrollTop()>10&&$(".home-page nav").removeClass("top"),$(window).scrollTop()>30,$(window).scrollTop()<540&&$(".home-page nav").css("box-shadow","inset 0 -1px 0px 0px rgba(0,0,0,0)"),$(window).scrollTop()>540&&$(".home-page nav").css("box-shadow","inset 0 -1px 0px 0px rgba(0,0,0,0.1)")})}function Account(e){this.getCurrentUser=function(){return e({method:"GET",url:"/api/auth/currentUser"})},this.sendVerifyCode=function(o){return e({method:"POST",url:"/api/verify/phone",data:o})},this.verifyCode=function(o){return e({method:"PUT",url:"/api/verify/phone",data:o})},this.getUserData=function(o){return e({method:"GET",url:"/api/users/"+o})},this.updateUserData=function(o,t){return e({method:"PUT",url:"/api/users/"+o,data:t})}}function Payment(e){this.chargeNow=function(o){return e({method:"POST",url:"/api/payment/chargeNow",data:o})}}function focus(e,o){return function(t){o(function(){e.$broadcast("focusOn",t)},0)}}function Plan(e,o){this.addSinglePreview=function(e){o.save(e)},this.getSinglePreview=function(){return e(function(e,t){o.get().then(function(){e(o.get().planPreviewData)})})}}function Storage(e){this.get=function(){},this.save=function(e){console.log("obj: ",e)}}function homeCtrl(e,o,t,a,n,r){function l(){console.log("check"),o.getToken()&&(console.log("check"),a.getCurrentUser(o.getToken()).then(function(o){console.log("res @getCurrentUser from state change: ",o.data),e.currentUser=o.data},function(e){t.go("authEntrance")}))}console.log("homeCtrl loaded"),r.$on("$stateChangeSuccess",function(e,o,t,a,n){r.previousState=a.name,r.currentState=o.name,console.log("Previous state:"+r.previousState),console.log("Current state:"+r.currentState),l()})}function authCtrl(e,o,t,a,n,r){console.log("authCtrl loaded"),e.auth_enter=function(e){o.signup(e).then(function(e){o.setToken(e),t.go("dashboard",{},{reload:!0}),console.log("res @auth_enter: ",e.data)},function(e){console.log("err @auth_enter: ",e)})},e.authenticate=function(e){o.authenticate(e)}}function dashboardCtrl(e,o,t,a,n,r,l){console.log("dashboardCtrl loaded"),e.logout=function(){console.log("check"),o.logout(),e.currentUser=null,t.go("landing",{},{reload:!0}),l.location.reload()},e.sendVerifyCode=function(o){if(console.log("phone: ",o),o.length>5){var t={userData:n.currentUser,phone:o};a.sendVerifyCode(t).then(function(t){console.log("res @sendVerifyCode: ",t.data),n.currentUser.phone.data=o,e.verifyPhoneSentOut=!0},function(e){console.log("err @sendVerifyCode: ",e)})}},e.verifyCode=function(e){if(console.log("code: ",e),0!==e.length){var o={userData:n.currentUser,code:e};a.verifyCode(o).then(function(e){console.log("res @verifyCode: ",e.data),n.currentUser.phone.verified=!0},function(e){console.log("err @verifyCode: ",e)})}},e.doCheckout=function(e){console.log("fff"),console.log("token: ",e);var o={stripeToken:e,userData:n.currentUser};r.chargeNow(o).then(function(e){console.log("res: ",e.data)},function(e){console.log("err: ",e)})}}function dashboardPlanCtrl(e,o,t,a,n,r){if(console.log("dashboardPlanCtrl loaded"),"dashboard_plan_single"==r.currentState&&(e.updateTimes=function(o){e.installmentsGraphData=[];for(var t=0;o>t;t++){var a=~~(e.plan.total/o),n=~~(200*(2/o));e.installmentsGraphData.push({price:a,style:{height:n+"px",width:"90%"}})}},e.previewSinglePlan=function(e){n.addSinglePreview(e).then(function(e){a.go("dashboard_plan_single_preview")},function(e){return console.log("err @addSinglePreview: ",e)})}),"dashboard_plan_single_preview"==r.currentState){var l=function(){for(var e=[],o="0123456789abcdef",t=0;36>t;t++)e[t]=o.substr(Math.floor(16*Math.random()),1);e[14]="4",e[19]=o.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-";var a=e.join("");return a};n.getSinglePreview().then(function(o){console.log("res @getSinglePreview: ",o),e.planPreview=o,e.planPreview.installment=(o.total-o.downpay)/o.times},function(e){return console.log("err @getSinglePreview: ",e)});var s=l();console.log("uuid: ",s)}}function focusOn(){return function(e,o,t){e.$on("focusOn",function(e,a){a===t.focusOn&&o[0].focus()})}}function toolTip(){return function(e,o,t){angular.element(".tool-tip").on("click mouseleave",hideTooltip),angular.element(".tool-tip").on("mouseenter",showTooltip)}}function hideTooltip(){$(this).tooltip("hide")}function showTooltip(){$(this).tooltip("show")}angular.module("pinchApp",["ui.router","satellizer","ngAnimate","ngFileUpload","ngImgCrop","stripe.checkout","angular-loading-bar","anim-in-out"]).config(["$stateProvider","$urlRouterProvider","$authProvider",function(e,o,t){Stripe.setPublishableKey("pk_test_t1eThhOKl6esrp6f4jyWqU4J"),e.state(landing).state(authEntrance).state(dashboard).state(dashboard_payment).state(dashboard_plan).state(dashboard_plan_start).state(dashboard_plan_choose).state(dashboard_plan_single).state(dashboard_plan_single_preview).state(dashboard_plan_multiple).state(dashboard_account),o.otherwise("/")}]);var landing={name:"landing",url:"/",views:{main:{templateUrl:"/html/landing.html",controller:"authCtrl"}}},authEntrance={name:"authEntrance",url:"/entrance",views:{main:{templateUrl:"/html/entrance.html",controller:"authCtrl"}}},dashboard={name:"dashboard",url:"/dashboard",views:{main:{templateUrl:"/html/dashboard.html",controller:"dashboardCtrl"}}},dashboard_payment={name:"dashboard_payment",url:"/payment",parent:"dashboard",views:{dashboard_section:{templateUrl:"/html/dashboard_payment.html",controller:"dashboardCtrl"}}},dashboard_plan={name:"dashboard_plan",url:"/plan",parent:"dashboard",views:{dashboard_section:{templateUrl:"/html/dashboard_plan.html",controller:"dashboardCtrl"}}},dashboard_plan_start={name:"dashboard_plan_start",url:"/start",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_start.html",controller:"dashboardCtrl"}}},dashboard_plan_choose={name:"dashboard_plan_choose",url:"/choose",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_choose.html",controller:"dashboardCtrl"}}},dashboard_plan_single={name:"dashboard_plan_single",url:"/choose/single",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_single.html",controller:"dashboardPlanCtrl"}}},dashboard_plan_single_preview={name:"dashboard_plan_single_preview",url:"/choose/single/preview",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_single_preview.html",controller:"dashboardPlanCtrl"}}},dashboard_plan_multiple={name:"dashboard_plan_multiple",url:"/choose/mutiple",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_multiple.html",controller:"dashboardCtrl"}}},dashboard_account={name:"dashboard_account",url:"/account",parent:"dashboard",views:{dashboard_section:{templateUrl:"/html/dashboard_account.html",controller:"dashboardCtrl"}}};$(document).ready(init),Account.$inject=["$http"],Payment.$inject=["$http"],focus.$inject=["$rootScope","$timeout"],Plan.$inject=["$q","Storage"],Storage.$inject=["$q"],angular.module("pinchApp").service("Account",Account).service("Payment",Payment).factory("focus",focus).service("Plan",Plan).service("Storage",Storage),homeCtrl.$inject=["$scope","$auth","$state","Account","$window","$rootScope"],authCtrl.$inject=["$scope","$auth","$state","Account","$window","$rootScope"],dashboardCtrl.$inject=["$scope","$auth","$state","Account","$rootScope","Payment","$window"],dashboardPlanCtrl.$inject=["$scope","Account","$stateParams","$state","Plan","$rootScope"],angular.module("pinchApp").controller("homeCtrl",homeCtrl).controller("authCtrl",authCtrl).controller("dashboardCtrl",dashboardCtrl).controller("dashboardPlanCtrl",dashboardPlanCtrl),angular.module("pinchApp").directive("focusOn",focusOn),angular.module("pinchApp").directive("toolTip",toolTip);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFtb2R1bGUuanMiLCJtYWluLmpzIiwic2VydmljZXMuanMiLCJjb250cm9sbGVycy9jb250cm9sbGVycy5qcyIsImRpcmVjdGl2ZXMvZm9jdXNPbi5kaXJlY3RpdmUuanMiLCJkaXJlY3RpdmVzL3Rvb2xUaXAuZGlyZWN0aXZlLmpzIl0sIm5hbWVzIjpbImluaXQiLCJzdGlja3kiLCJ3aW5kb3dTY3JvbGxEb3duIiwiJCIsInRvcFNwYWNpbmciLCJzdCIsImxhc3RTY3JvbGxUb3AiLCJ3aW5kb3ciLCJzY3JvbGwiLCJ0aGlzIiwic2Nyb2xsVG9wIiwicmVtb3ZlQ2xhc3MiLCJjc3MiLCJhZGRDbGFzcyIsIkFjY291bnQiLCIkaHR0cCIsImdldEN1cnJlbnRVc2VyIiwibWV0aG9kIiwidXJsIiwic2VuZFZlcmlmeUNvZGUiLCJ1c2VyT2JqIiwiZGF0YSIsInZlcmlmeUNvZGUiLCJnZXRVc2VyRGF0YSIsInVyaVVzZXJJZCIsInVwZGF0ZVVzZXJEYXRhIiwiUGF5bWVudCIsImNoYXJnZU5vdyIsImRhdGFPYmoiLCJmb2N1cyIsIiRyb290U2NvcGUiLCIkdGltZW91dCIsIm5hbWUiLCIkYnJvYWRjYXN0IiwiUGxhbiIsIiRxIiwiU3RvcmFnZSIsImFkZFNpbmdsZVByZXZpZXciLCJwbGFuIiwic2F2ZSIsImdldFNpbmdsZVByZXZpZXciLCJyZXMiLCJyZWoiLCJnZXQiLCJ0aGVuIiwicGxhblByZXZpZXdEYXRhIiwib2JqIiwiY29uc29sZSIsImxvZyIsImhvbWVDdHJsIiwiJHNjb3BlIiwiJGF1dGgiLCIkc3RhdGUiLCIkd2luZG93IiwiZ2V0VG9rZW4iLCJjdXJyZW50VXNlciIsImVyciIsImdvIiwiJG9uIiwiZXYiLCJ0byIsInRvUGFyYW1zIiwiZnJvbSIsImZyb21QYXJhbXMiLCJwcmV2aW91c1N0YXRlIiwiY3VycmVudFN0YXRlIiwiYXV0aEN0cmwiLCJhdXRoX2VudGVyIiwiYXV0aERhdGEiLCJzaWdudXAiLCJzZXRUb2tlbiIsInJlbG9hZCIsImF1dGhlbnRpY2F0ZSIsInByb3ZpZGVyIiwiZGFzaGJvYXJkQ3RybCIsImxvZ291dCIsImxvY2F0aW9uIiwicGhvbmUiLCJsZW5ndGgiLCJ1c2VyRGF0YSIsInZlcmlmeVBob25lU2VudE91dCIsImNvZGUiLCJ2ZXJpZmllZCIsImRvQ2hlY2tvdXQiLCJ0b2tlbiIsInN0cmlwZVRva2VuIiwiZGFzaGJvYXJkUGxhbkN0cmwiLCIkc3RhdGVQYXJhbXMiLCJ1cGRhdGVUaW1lcyIsInRpbWVzIiwiaW5zdGFsbG1lbnRzR3JhcGhEYXRhIiwiaSIsImluc3RhbGxtZW50IiwidG90YWwiLCJoZWlnaHQiLCJwdXNoIiwicHJpY2UiLCJzdHlsZSIsIndpZHRoIiwicHJldmlld1NpbmdsZVBsYW4iLCJjcmVhdGVVVUlEIiwicyIsImhleERpZ2l0cyIsInN1YnN0ciIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInV1aWQiLCJqb2luIiwicGxhblByZXZpZXciLCJkb3ducGF5IiwiZm9jdXNPbiIsInNjb3BlIiwiZWxlbSIsImF0dHIiLCJlIiwidG9vbFRpcCIsImVsZW1lbnQiLCJhdHRycyIsImFuZ3VsYXIiLCJvbiIsImhpZGVUb29sdGlwIiwic2hvd1Rvb2x0aXAiLCJ0b29sdGlwIiwibW9kdWxlIiwiY29uZmlnIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCIkYXV0aFByb3ZpZGVyIiwiU3RyaXBlIiwic2V0UHVibGlzaGFibGVLZXkiLCJzdGF0ZSIsImxhbmRpbmciLCJhdXRoRW50cmFuY2UiLCJkYXNoYm9hcmQiLCJkYXNoYm9hcmRfcGF5bWVudCIsImRhc2hib2FyZF9wbGFuIiwiZGFzaGJvYXJkX3BsYW5fc3RhcnQiLCJkYXNoYm9hcmRfcGxhbl9jaG9vc2UiLCJkYXNoYm9hcmRfcGxhbl9zaW5nbGUiLCJkYXNoYm9hcmRfcGxhbl9zaW5nbGVfcHJldmlldyIsImRhc2hib2FyZF9wbGFuX211bHRpcGxlIiwiZGFzaGJvYXJkX2FjY291bnQiLCJvdGhlcndpc2UiLCJ2aWV3cyIsIm1haW4iLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJwYXJlbnQiLCJkYXNoYm9hcmRfc2VjdGlvbiIsImRhc2hib2FyZF9jaGlsZF9zZWN0aW9uIiwiZG9jdW1lbnQiLCJyZWFkeSIsIiRpbmplY3QiLCJzZXJ2aWNlIiwiZmFjdG9yeSIsImRpcmVjdGl2ZSJdLCJtYXBwaW5ncyI6IkFBQUEsWUNJQSxTQUFTQSxRQUVMQyxTQUNBQyxtQkFHSixRQUFTRCxVQUNMRSxFQUFFLFdBQVdGLFFBQ1RHLFdBQVksS0FJcEIsUUFBU0Ysb0JBQ0wsR0FDSUcsR0FEQUMsRUFBZ0IsQ0FFcEJILEdBQUVJLFFBQVFDLE9BQU8sV0FFYkgsRUFBS0YsRUFBRU0sTUFBTUMsWUFDVlAsRUFBRUksUUFBUUcsWUFBYyxLQUNkSixFQUFMRCxHQUNBRixFQUFFLGtCQUFrQlEsWUFBWSxVQUNoQ1IsRUFBRSxrQkFBa0JTLElBQUksZ0JBQWlCLGNBRXpDVCxFQUFFLGtCQUFrQlUsU0FBUyxXQUdyQ1AsRUFBZ0JELEVBRVpGLEVBQUVJLFFBQVFHLFlBQWMsSUFDeEJQLEVBQUUsa0JBQWtCVSxTQUFTLE9BRTdCVixFQUFFSSxRQUFRRyxZQUFjLElBQ3hCUCxFQUFFLGtCQUFrQlEsWUFBWSxPQUVoQ1IsRUFBRUksUUFBUUcsWUFBYyxHQUd4QlAsRUFBRUksUUFBUUcsWUFBYyxLQUN4QlAsRUFBRSxrQkFBa0JTLElBQUksYUFBYyxzQ0FFdENULEVBQUVJLFFBQVFHLFlBQWMsS0FDeEJQLEVBQUUsa0JBQWtCUyxJQUFJLGFBQWMsMENDbkNsRCxRQUFTRSxTQUFRQyxHQUNiTixLQUFLTyxlQUFpQixXQU1sQixNQUFPRCxJQUNIRSxPQUFRLE1BQ1JDLElBQUEsMkJBRlJULEtBQUtVLGVBQWlCLFNBQUFDLEdBTWxCLE1BQU9MLElBQ0hFLE9BQVEsT0FDUkMsSUFBQSxvQkFDQUcsS0FBTUQsS0FGZFgsS0FBS2EsV0FBYSxTQUFBRixHQU1kLE1BQU9MLElBQ0hFLE9BQVEsTUFDUkMsSUFBQSxvQkFDQUcsS0FBTUQsS0FGZFgsS0FBS2MsWUFB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Q29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdwaW5jaEFwcCcsIFtcbiAgICAgICAgJ3VpLnJvdXRlcicsXG4gICAgICAgICdzYXRlbGxpemVyJyxcbiAgICAgICAgJ25nQW5pbWF0ZScsXG4gICAgICAgIC8vICd1aS5ib290c3RyYXAnLFxuICAgICAgICAnbmdGaWxlVXBsb2FkJyxcbiAgICAgICAgJ25nSW1nQ3JvcCcsXG4gICAgICAgICdzdHJpcGUuY2hlY2tvdXQnLFxuICAgICAgICAnYW5ndWxhci1sb2FkaW5nLWJhcicsXG4gICAgICAgICdhbmltLWluLW91dCdcbiAgICBdKVxuICAgIC5jb25maWcoZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlciwgJGF1dGhQcm92aWRlcikge1xuICAgICAgICBTdHJpcGUuc2V0UHVibGlzaGFibGVLZXkoJ3BrX3Rlc3RfdDFlVGhoT0tsNmVzcnA2ZjRqeVdxVTRKJylcblxuICAgICAgICAvLyAkYXV0aFByb3ZpZGVyXG4gICAgICAgIC8vICAgICAuZmFjZWJvb2soe1xuICAgICAgICAvLyAgICAgICAgIGNsaWVudElkOiAnMjk4MTY1MTEzODQ5MzY2J1xuICAgICAgICAvLyAgICAgfSk7XG5cbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZShsYW5kaW5nKVxuICAgICAgICAgICAgLnN0YXRlKGF1dGhFbnRyYW5jZSlcbiAgICAgICAgICAgIC5zdGF0ZShkYXNoYm9hcmQpXG4gICAgICAgICAgICAuc3RhdGUoZGFzaGJvYXJkX3BheW1lbnQpXG4gICAgICAgICAgICAuc3RhdGUoZGFzaGJvYXJkX3BsYW4pXG4gICAgICAgICAgICAuc3RhdGUoZGFzaGJvYXJkX3BsYW5fc3RhcnQpXG4gICAgICAgICAgICAuc3RhdGUoZGFzaGJvYXJkX3BsYW5fY2hvb3NlKVxuICAgICAgICAgICAgLnN0YXRlKGRhc2hib2FyZF9wbGFuX3NpbmdsZSlcbiAgICAgICAgICAgIC5zdGF0ZShkYXNoYm9hcmRfcGxhbl9zaW5nbGVfcHJldmlldylcbiAgICAgICAgICAgIC5zdGF0ZShkYXNoYm9hcmRfcGxhbl9tdWx0aXBsZSlcbiAgICAgICAgICAgIC5zdGF0ZShkYXNoYm9hcmRfYWNjb3VudClcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcGFnZSlcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcGFnZV9wcm9qZWN0cylcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcGFnZV9saWtlZClcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcGFnZV9mb2xsb3dlcnMpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHJvamVjdHBhZ2UpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHJvamVjdFNldHRpbmcpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHJvamVjdFNldHRpbmdfZ2VuZXJhbClcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcm9qZWN0U2V0dGluZ19yZXF1ZXN0KVxuICAgICAgICAgICAgLy8gLnN0YXRlKHByb2plY3RTZXR0aW5nX3ByaXZhY3kpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHJvamVjdFNldHRpbmdfZGFuZ2VyKVxuICAgICAgICAgICAgLy8gLnN0YXRlKHByb2ZpbGVTZXR0aW5nKVxuICAgICAgICAgICAgLy8gLnN0YXRlKHByb2ZpbGVTZXR0aW5nX2dlbmVyYWwpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHJvZmlsZVNldHRpbmdfcmVxdWVzdClcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcm9maWxlU2V0dGluZ19wcml2YWN5KVxuICAgICAgICAgICAgLy8gLnN0YXRlKHByb2ZpbGVTZXR0aW5nX2RhbmdlcilcblxuXG4gICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcbiAgICB9KTtcblxuXG5sZXQgbGFuZGluZyA9IHtcbiAgICBuYW1lOiAnbGFuZGluZycsXG4gICAgdXJsOiAnLycsXG4gICAgdmlld3M6IHtcbiAgICAgICAgbWFpbjoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9sYW5kaW5nLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2F1dGhDdHJsJ1xuICAgICAgICB9XG4gICAgfVxufVxubGV0IGF1dGhFbnRyYW5jZSA9IHtcbiAgICBuYW1lOiAnYXV0aEVudHJhbmNlJyxcbiAgICB1cmw6ICcvZW50cmFuY2UnLFxuICAgIHZpZXdzOiB7XG4gICAgICAgIG1haW46IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvZW50cmFuY2UuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnYXV0aEN0cmwnXG4gICAgICAgIH1cbiAgICB9XG59XG5sZXQgZGFzaGJvYXJkID0ge1xuICAgIG5hbWU6ICdkYXNoYm9hcmQnLFxuICAgIHVybDogJy9kYXNoYm9hcmQnLFxuICAgIHZpZXdzOiB7XG4gICAgICAgIG1haW46IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvZGFzaGJvYXJkLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2Rhc2hib2FyZEN0cmwnXG4gICAgICAgIH1cbiAgICB9XG59XG5cbmxldCBkYXNoYm9hcmRfcGF5bWVudCA9IHtcbiAgICBuYW1lOiAnZGFzaGJvYXJkX3BheW1lbnQnLFxuICAgIHVybDogJy9wYXltZW50JyxcbiAgICBwYXJlbnQ6ICdkYXNoYm9hcmQnLFxuICAgIHZpZXdzOiB7XG4gICAgICAgIGRhc2hib2FyZF9zZWN0aW9uOiB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL2Rhc2hib2FyZF9wYXltZW50Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2Rhc2hib2FyZEN0cmwnXG4gICAgICAgIH1cbiAgICB9XG59XG5sZXQgZGFzaGJvYXJkX3BsYW4gPSB7XG4gICAgbmFtZTogJ2Rhc2hib2FyZF9wbGFuJyxcbiAgICB1cmw6ICcvcGxhbicsXG4gICAgcGFyZW50OiAnZGFzaGJvYXJkJyxcbiAgICB2aWV3czoge1xuICAgICAgICBkYXNoYm9hcmRfc2VjdGlvbjoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9kYXNoYm9hcmRfcGxhbi5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdkYXNoYm9hcmRDdHJsJ1xuICAgICAgICB9XG4gICAgfVxufVxubGV0IGRhc2hib2FyZF9wbGFuX3N0YXJ0ID0ge1xuICAgIG5hbWU6ICdkYXNoYm9hcmRfcGxhbl9zdGFydCcsXG4gICAgdXJsOiAnL3N0YXJ0JyxcbiAgICBwYXJlbnQ6ICdkYXNoYm9hcmRfcGxhbicsXG4gICAgdmlld3M6IHtcbiAgICAgICAgZGFzaGJvYXJkX2NoaWxkX3NlY3Rpb246IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvZGFzaGJvYXJkL2Rhc2hib2FyZF9wbGFuX3N0YXJ0Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2Rhc2hib2FyZEN0cmwnXG4gICAgICAgIH1cbiAgICB9XG59XG5sZXQgZGFzaGJvYXJkX3BsYW5fY2hvb3NlID0ge1xuICAgIG5hbWU6ICdkYXNoYm9hcmRfcGxhbl9jaG9vc2UnLFxuICAgIHVybDogJy9jaG9vc2UnLFxuICAgIHBhcmVudDogJ2Rhc2hib2FyZF9wbGFuJyxcbiAgICB2aWV3czoge1xuICAgICAgICBkYXNoYm9hcmRfY2hpbGRfc2VjdGlvbjoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9kYXNoYm9hcmQvZGFzaGJvYXJkX3BsYW5fY2hvb3NlLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2Rhc2hib2FyZEN0cmwnXG4gICAgICAgIH1cbiAgICB9XG59XG5sZXQgZGFzaGJvYXJkX3BsYW5fc2luZ2xlID0ge1xuICAgIG5hbWU6ICdkYXNoYm9hcmRfcGxhbl9zaW5nbGUnLFxuICAgIHVybDogJy9jaG9vc2Uvc2luZ2xlJyxcbiAgICBwYXJlbnQ6ICdkYXNoYm9hcmRfcGxhbicsXG4gICAgdmlld3M6IHtcbiAgICAgICAgZGFzaGJvYXJkX2NoaWxkX3NlY3Rpb246IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvZGFzaGJvYXJkL2Rhc2hib2FyZF9wbGFuX3NpbmdsZS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdkYXNoYm9hcmRQbGFuQ3RybCdcbiAgICAgICAgfVxuICAgIH1cbn1cbmxldCBkYXNoYm9hcmRfcGxhbl9zaW5nbGVfcHJldmlldyA9IHtcbiAgICBuYW1lOiAnZGFzaGJvYXJkX3BsYW5fc2luZ2xlX3ByZXZpZXcnLFxuICAgIHVybDogJy9jaG9vc2Uvc2luZ2xlL3ByZXZpZXcnLFxuICAgIHBhcmVudDogJ2Rhc2hib2FyZF9wbGFuJyxcbiAgICB2aWV3czoge1xuICAgICAgICBkYXNoYm9hcmRfY2hpbGRfc2VjdGlvbjoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9kYXNoYm9hcmQvZGFzaGJvYXJkX3BsYW5fc2luZ2xlX3ByZXZpZXcuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnZGFzaGJvYXJkUGxhbkN0cmwnXG4gICAgICAgIH1cbiAgICB9XG59XG5sZXQgZGFzaGJvYXJkX3BsYW5fbXVsdGlwbGUgPSB7XG4gICAgbmFtZTogJ2Rhc2hib2FyZF9wbGFuX211bHRpcGxlJyxcbiAgICB1cmw6ICcvY2hvb3NlL211dGlwbGUnLFxuICAgIHBhcmVudDogJ2Rhc2hib2FyZF9wbGFuJyxcbiAgICB2aWV3czoge1xuICAgICAgICBkYXNoYm9hcmRfY2hpbGRfc2VjdGlvbjoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9kYXNoYm9hcmQvZGFzaGJvYXJkX3BsYW5fbXVsdGlwbGUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnZGFzaGJvYXJkQ3RybCdcbiAgICAgICAgfVxuICAgIH1cbn1cbmxldCBkYXNoYm9hcmRfYWNjb3VudCA9IHtcbiAgICBuYW1lOiAnZGFzaGJvYXJkX2FjY291bnQnLFxuICAgIHVybDogJy9hY2NvdW50JyxcbiAgICBwYXJlbnQ6ICdkYXNoYm9hcmQnLFxuICAgIHZpZXdzOiB7XG4gICAgICAgIGRhc2hib2FyZF9zZWN0aW9uOiB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL2Rhc2hib2FyZF9hY2NvdW50Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2Rhc2hib2FyZEN0cmwnXG4gICAgICAgIH1cbiAgICB9XG59XG4iLCIndXNlIHN0cmljdCdcblxuJChkb2N1bWVudCkucmVhZHkoaW5pdCk7XG5cbmZ1bmN0aW9uIGluaXQoKSB7XG4gICAgLy8gY29uc29sZS5sb2coJ2pxdWVyeSBsb2FkZWQnKTtcbiAgICBzdGlja3koKVxuICAgIHdpbmRvd1Njcm9sbERvd24oKVxufVxuXG5mdW5jdGlvbiBzdGlja3koKSB7XG4gICAgJChcIi5zdGlja3lcIikuc3RpY2t5KHtcbiAgICAgICAgdG9wU3BhY2luZzogNjBcbiAgICB9KVxufVxuXG5mdW5jdGlvbiB3aW5kb3dTY3JvbGxEb3duKCkge1xuICAgIHZhciBsYXN0U2Nyb2xsVG9wID0gMFxuICAgIHZhciBzdFxuICAgICQod2luZG93KS5zY3JvbGwoZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCQod2luZG93KS5zY3JvbGxUb3AoKSk7XG4gICAgICAgIHN0ID0gJCh0aGlzKS5zY3JvbGxUb3AoKTtcbiAgICAgICAgaWYoJCh3aW5kb3cpLnNjcm9sbFRvcCgpID4gMzApe1xuICAgICAgICAgICAgaWYgKHN0IDwgbGFzdFNjcm9sbFRvcCkge1xuICAgICAgICAgICAgICAgICQoJy5ob21lLXBhZ2UgbmF2JykucmVtb3ZlQ2xhc3MoJ2ZvbGRlZCcpXG4gICAgICAgICAgICAgICAgJCgnLmhvbWUtcGFnZSBuYXYnKS5jc3MoJ2JvcmRlci1ib3R0b20nLCAnMHB4IHNvbGlkJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICQoJy5ob21lLXBhZ2UgbmF2JykuYWRkQ2xhc3MoJ2ZvbGRlZCcpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbGFzdFNjcm9sbFRvcCA9IHN0XG5cbiAgICAgICAgaWYgKCQod2luZG93KS5zY3JvbGxUb3AoKSA8IDEwKSB7XG4gICAgICAgICAgICAkKCcuaG9tZS1wYWdlIG5hdicpLmFkZENsYXNzKCd0b3AnKVxuICAgICAgICB9XG4gICAgICAgIGlmICgkKHdpbmRvdykuc2Nyb2xsVG9wKCkgPiAxMCkge1xuICAgICAgICAgICAgJCgnLmhvbWUtcGFnZSBuYXYnKS5yZW1vdmVDbGFzcygndG9wJylcbiAgICAgICAgfVxuICAgICAgICBpZiAoJCh3aW5kb3cpLnNjcm9sbFRvcCgpID4gMzApIHtcblxuICAgICAgICB9XG4gICAgICAgIGlmICgkKHdpbmRvdykuc2Nyb2xsVG9wKCkgPCA1NDApIHtcbiAgICAgICAgICAgICQoJy5ob21lLXBhZ2UgbmF2JykuY3NzKCdib3gtc2hhZG93JywgJ2luc2V0IDAgLTFweCAwcHggMHB4IHJnYmEoMCwwLDAsMCknKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoJCh3aW5kb3cpLnNjcm9sbFRvcCgpID4gNTQwKSB7XG4gICAgICAgICAgICAkKCcuaG9tZS1wYWdlIG5hdicpLmNzcygnYm94LXNoYWRvdycsICdpbnNldCAwIC0xcHggMHB4IDBweCByZ2JhKDAsMCwwLDAuMSknKTtcbiAgICAgICAgfVxuXG4gICAgfSlcbn1cbiIsIid1c2Ugc3RyaWN0JztcblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ3BpbmNoQXBwJylcbiAgICAuc2VydmljZSgnQWNjb3VudCcsIEFjY291bnQpXG4gICAgLnNlcnZpY2UoJ1BheW1lbnQnLCBQYXltZW50KVxuICAgIC5mYWN0b3J5KCdmb2N1cycsIGZvY3VzKVxuICAgIC5zZXJ2aWNlKCdQbGFuJywgUGxhbilcbiAgICAuc2VydmljZSgnU3RvcmFnZScsIFN0b3JhZ2UpXG4gICAgLy8gLmRpcmVjdGl2ZSgnc3RhdGVMb2FkaW5nSW5kaWNhdG9yJywgc3RhdGVMb2FkaW5nSW5kaWNhdG9yKVxuZnVuY3Rpb24gQWNjb3VudCgkaHR0cCkge1xuICAgIHRoaXMuZ2V0Q3VycmVudFVzZXIgPSAoKSA9PiB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgdXJsOiBgL2FwaS9hdXRoL2N1cnJlbnRVc2VyYFxuICAgICAgICB9KVxuICAgIH1cbiAgICB0aGlzLnNlbmRWZXJpZnlDb2RlID0gKHVzZXJPYmopID0+IHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgdXJsOiBgL2FwaS92ZXJpZnkvcGhvbmVgLFxuICAgICAgICAgICAgZGF0YTogdXNlck9ialxuICAgICAgICB9KVxuICAgIH1cbiAgICB0aGlzLnZlcmlmeUNvZGUgPSAodXNlck9iaikgPT4ge1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUFVUJyxcbiAgICAgICAgICAgIHVybDogYC9hcGkvdmVyaWZ5L3Bob25lYCxcbiAgICAgICAgICAgIGRhdGE6IHVzZXJPYmpcbiAgICAgICAgfSlcbiAgICB9XG4gICAgdGhpcy5nZXRVc2VyRGF0YSA9ICh1cmlVc2VySWQpID0+IHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICB1cmw6IGAvYXBpL3VzZXJzLyR7dXJpVXNlcklkfWBcbiAgICAgICAgfSlcbiAgICB9XG4gICAgdGhpcy51cGRhdGVVc2VyRGF0YSA9ICh1cmlVc2VySWQsIHVwZGF0ZVVzZXJEYXRhKSA9PiB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdQVVQnLFxuICAgICAgICAgICAgdXJsOiBgL2FwaS91c2Vycy8ke3VyaVVzZXJJZH1gLFxuICAgICAgICAgICAgZGF0YTogdXBkYXRlVXNlckRhdGFcbiAgICAgICAgfSlcbiAgICB9XG59XG5cbmZ1bmN0aW9uIFBheW1lbnQoJGh0dHApIHtcbiAgICB0aGlzLmNoYXJnZU5vdyA9IChkYXRhT2JqKSA9PiB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIHVybDogYC9hcGkvcGF5bWVudC9jaGFyZ2VOb3dgLFxuICAgICAgICAgICAgZGF0YTogZGF0YU9ialxuICAgICAgICB9KVxuICAgIH1cbn1cblxuZnVuY3Rpb24gZm9jdXMoJHJvb3RTY29wZSwgJHRpbWVvdXQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24obmFtZSkge1xuICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnZm9jdXNPbicsIG5hbWUpO1xuICAgICAgICB9LCAwKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIFBsYW4oJHEsIFN0b3JhZ2UpIHtcbiAgICB0aGlzLmFkZFNpbmdsZVByZXZpZXcgPSAocGxhbikgPT4ge1xuICAgICAgICBTdG9yYWdlLnNhdmUocGxhbilcbiAgICB9XG4gICAgdGhpcy5nZXRTaW5nbGVQcmV2aWV3ID0gKCkgPT4ge1xuICAgICAgICByZXR1cm4gJHEoKHJlcywgcmVqKSA9PiB7XG4gICAgICAgICAgICBTdG9yYWdlLmdldCgpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcmVzKFN0b3JhZ2UuZ2V0KCkucGxhblByZXZpZXdEYXRhKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG59XG5cbmZ1bmN0aW9uIFN0b3JhZ2UoJHEpIHtcbiAgICB0aGlzLmdldCA9ICgpID0+IHtcbiAgICAgICAgLy8gcmV0dXJuICRxKChyZXMsIHJlaikgPT4ge1xuICAgICAgICAvLyAgICAgaWYgKCFsb2NhbFN0b3JhZ2Uuc2VwZXJwYXkpIHtcbiAgICAgICAgLy8gICAgICAgICBsb2NhbFN0b3JhZ2Uuc2VwZXJwYXkgPSB7fVxuICAgICAgICAvLyAgICAgICAgIHJlcyhKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5zZXBlcnBheSkpXG4gICAgICAgIC8vICAgICB9IGVsc2UgaWYgKGxvY2FsU3RvcmFnZS5zZXBlcnBheSkge1xuICAgICAgICAvLyAgICAgICAgIHJlcyhKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5zZXBlcnBheSkpXG4gICAgICAgIC8vICAgICB9XG4gICAgICAgIC8vIH0pXG4gICAgfVxuXG4gICAgdGhpcy5zYXZlID0gKG9iaikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygnb2JqOiAnLCBvYmopO1xuICAgICAgICAvLyB2YXIga2V5ID0gb2JqXG4gICAgICAgIC8vIHZhciBvYmogPSBKU09OLnN0cmluZ2lmeShvYmopXG4gICAgICAgIC8vIGxvY2FsU3RvcmFnZVxuICAgIH1cbn1cbi8vIGZ1bmN0aW9uIHN0YXRlTG9hZGluZ0luZGljYXRvcigkcm9vdFNjb3BlKSB7XG4vLyAgICAgcmV0dXJuIHtcbi8vICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbi8vICAgICAgICAgdGVtcGxhdGU6IFwiPGRpdiBuZy1zaG93PSdpc1N0YXRlTG9hZGluZycgY2xhc3M9J2xvYWRpbmctaW5kaWNhdG9yJz5cIiArXG4vLyAgICAgICAgICAgICBcIjxkaXYgY2xhc3M9J2xvYWRpbmctaW5kaWNhdG9yLWJvZHknPlwiICtcbi8vICAgICAgICAgICAgIFwiPGgzIGNsYXNzPSdsb2FkaW5nLXRpdGxlJz5Mb2FkaW5nLi4uPC9oMz5cIiArXG4vLyAgICAgICAgICAgICBcIjxkaXYgY2xhc3M9J3NwaW5uZXInPjxjaGFzaW5nLWRvdHMtc3Bpbm5lcj48L2NoYXNpbmctZG90cy1zcGlubmVyPjwvZGl2PlwiICtcbi8vICAgICAgICAgICAgIFwiPC9kaXY+XCIgK1xuLy8gICAgICAgICAgICAgXCI8L2Rpdj5cIixcbi8vICAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbi8vICAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW0sIGF0dHJzKSB7XG4vLyAgICAgICAgICAgICBzY29wZS5pc1N0YXRlTG9hZGluZyA9IGZhbHNlO1xuLy9cbi8vICAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdGFydCcsIGZ1bmN0aW9uKCkge1xuLy8gICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzdGFydCcpXG4vLyAgICAgICAgICAgICAgICAgc2NvcGUuaXNTdGF0ZUxvYWRpbmcgPSB0cnVlO1xuLy8gICAgICAgICAgICAgfSk7XG4vLyAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3VjY2VzcycsIGZ1bmN0aW9uKCkge1xuLy8gICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjb21wbGV0ZScpXG4vLyAgICAgICAgICAgICAgICAgc2NvcGUuaXNTdGF0ZUxvYWRpbmcgPSBmYWxzZTtcbi8vICAgICAgICAgICAgIH0pO1xuLy8gICAgICAgICB9XG4vLyAgICAgfTtcbi8vIH1cbiIsIid1c2Ugc3RyaWN0JztcblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ3BpbmNoQXBwJylcbiAgICAuY29udHJvbGxlcignaG9tZUN0cmwnLCBob21lQ3RybClcbiAgICAuY29udHJvbGxlcignYXV0aEN0cmwnLCBhdXRoQ3RybClcbiAgICAuY29udHJvbGxlcignZGFzaGJvYXJkQ3RybCcsIGRhc2hib2FyZEN0cmwpXG4gICAgLmNvbnRyb2xsZXIoJ2Rhc2hib2FyZFBsYW5DdHJsJywgZGFzaGJvYXJkUGxhbkN0cmwpXG5cbmZ1bmN0aW9uIGhvbWVDdHJsKCRzY29wZSwgJGF1dGgsICRzdGF0ZSwgQWNjb3VudCwgJHdpbmRvdywgJHJvb3RTY29wZSkge1xuICAgIGNvbnNvbGUubG9nKCdob21lQ3RybCBsb2FkZWQnKVxuICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdWNjZXNzJywgZnVuY3Rpb24oZXYsIHRvLCB0b1BhcmFtcywgZnJvbSwgZnJvbVBhcmFtcykge1xuICAgICAgICAkcm9vdFNjb3BlLnByZXZpb3VzU3RhdGUgPSBmcm9tLm5hbWU7XG4gICAgICAgICRyb290U2NvcGUuY3VycmVudFN0YXRlID0gdG8ubmFtZTtcbiAgICAgICAgY29uc29sZS5sb2coJ1ByZXZpb3VzIHN0YXRlOicgKyAkcm9vdFNjb3BlLnByZXZpb3VzU3RhdGUpXG4gICAgICAgIGNvbnNvbGUubG9nKCdDdXJyZW50IHN0YXRlOicgKyAkcm9vdFNjb3BlLmN1cnJlbnRTdGF0ZSlcbiAgICAgICAgZ2V0Q3VycmVudFVzZXIoKVxuICAgIH0pXG4gICAgLy8gJHJvb3RTY29wZS4kb24oJ2FuaW1TdGFydCcsIGZ1bmN0aW9uKCRldmVudCwgZWxlbWVudCwgc3BlZWQpIHt9KVxuICAgIC8vICRyb290U2NvcGUuJG9uKCdhbmltRW5kJywgZnVuY3Rpb24oJGV2ZW50LCBlbGVtZW50LCBzcGVlZCkge30pXG4gICAgZnVuY3Rpb24gZ2V0Q3VycmVudFVzZXIoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdjaGVjaycpO1xuICAgICAgICBpZiAoJGF1dGguZ2V0VG9rZW4oKSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2NoZWNrJyk7XG4gICAgICAgICAgICBBY2NvdW50LmdldEN1cnJlbnRVc2VyKCRhdXRoLmdldFRva2VuKCkpXG4gICAgICAgICAgICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlcyBAZ2V0Q3VycmVudFVzZXIgZnJvbSBzdGF0ZSBjaGFuZ2U6ICcsIHJlcy5kYXRhKVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY3VycmVudFVzZXIgPSByZXMuZGF0YVxuICAgICAgICAgICAgICAgIH0sIGVyciA9PiB7XG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnYXV0aEVudHJhbmNlJylcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfVxufVxuXG5mdW5jdGlvbiBhdXRoQ3RybCgkc2NvcGUsICRhdXRoLCAkc3RhdGUsIEFjY291bnQsICR3aW5kb3csICRyb290U2NvcGUpIHtcbiAgICBjb25zb2xlLmxvZygnYXV0aEN0cmwgbG9hZGVkJylcblxuICAgICRzY29wZS5hdXRoX2VudGVyID0gKGF1dGhEYXRhKSA9PiB7XG4gICAgICAgICRhdXRoLnNpZ251cChhdXRoRGF0YSlcbiAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgJGF1dGguc2V0VG9rZW4ocmVzKTtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2Rhc2hib2FyZCcsIHt9LCB7XG4gICAgICAgICAgICAgICAgICAgIHJlbG9hZDogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlcyBAYXV0aF9lbnRlcjogJywgcmVzLmRhdGEpXG4gICAgICAgICAgICB9LCBlcnIgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnIgQGF1dGhfZW50ZXI6ICcsIGVycilcbiAgICAgICAgICAgIH0pXG4gICAgfVxuXG4gICAgJHNjb3BlLmF1dGhlbnRpY2F0ZSA9IChwcm92aWRlcikgPT4ge1xuICAgICAgICAkYXV0aC5hdXRoZW50aWNhdGUocHJvdmlkZXIpO1xuICAgIH1cblxufVxuXG5mdW5jdGlvbiBkYXNoYm9hcmRDdHJsKCRzY29wZSwgJGF1dGgsICRzdGF0ZSwgQWNjb3VudCwgJHJvb3RTY29wZSwgUGF5bWVudCwgJHdpbmRvdykge1xuICAgIGNvbnNvbGUubG9nKCdkYXNoYm9hcmRDdHJsIGxvYWRlZCcpXG4gICAgLy8gY2hlY2tWZXJpZnlQaG9uZVNlbnRTdGF0dXMoJHJvb3RTY29wZS5jdXJyZW50VXNlcilcblxuICAgICRzY29wZS5sb2dvdXQgPSAoKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdjaGVjaycpO1xuICAgICAgICAkYXV0aC5sb2dvdXQoKVxuICAgICAgICAkc2NvcGUuY3VycmVudFVzZXIgPSBudWxsO1xuICAgICAgICAkc3RhdGUuZ28oJ2xhbmRpbmcnLCB7fSwge1xuICAgICAgICAgICAgcmVsb2FkOiB0cnVlXG4gICAgICAgIH0pXG4gICAgICAgICR3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2hlY2tWZXJpZnlQaG9uZVNlbnRTdGF0dXMoY3VycmVudFVzZXJEYXRhKSB7XG4gICAgICAgICRzY29wZS52ZXJpZnlQaG9uZVNlbnRPdXQgPSBmYWxzZVxuXG4gICAgICAgIGxldCBleHBpcmVkVGltZSA9IE51bWJlcihjdXJyZW50VXNlckRhdGEucGhvbmUudmVyaWZ5Q29kZS5leHBpcmVkQXQpXG4gICAgICAgIGxldCBub3dUaW1lID0gRGF0ZS5ub3coKVxuICAgICAgICBpZiAoZXhwaXJlZFRpbWUgPiBub3dUaW1lKSB7XG4gICAgICAgICAgICAkc2NvcGUudmVyaWZ5UGhvbmVTZW50T3V0ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICAkc2NvcGUudmVyaWZ5UGhvbmVDb3VudERvd24gPSAoKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gYCR7ZXhwaXJlZFRpbWV9YFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgJHNjb3BlLnNlbmRWZXJpZnlDb2RlID0gKHBob25lKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdwaG9uZTogJywgcGhvbmUpXG4gICAgICAgIGlmIChwaG9uZS5sZW5ndGggPiA1KSB7XG4gICAgICAgICAgICB2YXIgdXNlck9iaiA9IHtcbiAgICAgICAgICAgICAgICB1c2VyRGF0YTogJHJvb3RTY29wZS5jdXJyZW50VXNlcixcbiAgICAgICAgICAgICAgICBwaG9uZTogcGhvbmVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIEFjY291bnQuc2VuZFZlcmlmeUNvZGUodXNlck9iailcbiAgICAgICAgICAgICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncmVzIEBzZW5kVmVyaWZ5Q29kZTogJywgcmVzLmRhdGEpXG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuY3VycmVudFVzZXIucGhvbmUuZGF0YSA9IHBob25lO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudmVyaWZ5UGhvbmVTZW50T3V0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9LCBlcnIgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZXJyIEBzZW5kVmVyaWZ5Q29kZTogJywgZXJyKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfVxuICAgICRzY29wZS52ZXJpZnlDb2RlID0gKGNvZGUpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ2NvZGU6ICcsIGNvZGUpXG4gICAgICAgIGlmIChjb2RlLmxlbmd0aCAhPT0gMCkge1xuICAgICAgICAgICAgdmFyIHVzZXJPYmogPSB7XG4gICAgICAgICAgICAgICAgdXNlckRhdGE6ICRyb290U2NvcGUuY3VycmVudFVzZXIsXG4gICAgICAgICAgICAgICAgY29kZTogY29kZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgQWNjb3VudC52ZXJpZnlDb2RlKHVzZXJPYmopXG4gICAgICAgICAgICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlcyBAdmVyaWZ5Q29kZTogJywgcmVzLmRhdGEpXG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuY3VycmVudFVzZXIucGhvbmUudmVyaWZpZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0sIGVyciA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnIgQHZlcmlmeUNvZGU6ICcsIGVycik7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH1cblxuICAgICRzY29wZS5kb0NoZWNrb3V0ID0gKHRva2VuKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdmZmYnKTtcbiAgICAgICAgY29uc29sZS5sb2coJ3Rva2VuOiAnLCB0b2tlbik7XG4gICAgICAgIHZhciBkYXRhT2JqID0ge1xuICAgICAgICAgICAgc3RyaXBlVG9rZW46IHRva2VuLFxuICAgICAgICAgICAgdXNlckRhdGE6ICRyb290U2NvcGUuY3VycmVudFVzZXJcbiAgICAgICAgfVxuICAgICAgICBQYXltZW50LmNoYXJnZU5vdyhkYXRhT2JqKS50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygncmVzOiAnLCByZXMuZGF0YSk7XG4gICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2VycjogJywgZXJyKTtcbiAgICAgICAgfSlcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRhc2hib2FyZFBsYW5DdHJsKCRzY29wZSwgQWNjb3VudCwgJHN0YXRlUGFyYW1zLCAkc3RhdGUsIFBsYW4sICRyb290U2NvcGUpIHtcbiAgICBjb25zb2xlLmxvZygnZGFzaGJvYXJkUGxhbkN0cmwgbG9hZGVkJyk7XG5cbiAgICBpZiAoJHJvb3RTY29wZS5jdXJyZW50U3RhdGUgPT0gJ2Rhc2hib2FyZF9wbGFuX3NpbmdsZScpIHtcbiAgICAgICAgJHNjb3BlLnVwZGF0ZVRpbWVzID0gKHRpbWVzKSA9PiB7XG4gICAgICAgICAgICAkc2NvcGUuaW5zdGFsbG1lbnRzR3JhcGhEYXRhID0gW11cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGltZXM7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBpbnN0YWxsbWVudCA9IH5+KCgkc2NvcGUucGxhbi50b3RhbCAvIHRpbWVzKSk7XG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IH5+KDIwMCAqICgyIC8gdGltZXMpKVxuICAgICAgICAgICAgICAgICRzY29wZS5pbnN0YWxsbWVudHNHcmFwaERhdGEucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIHByaWNlOiBpbnN0YWxsbWVudCxcbiAgICAgICAgICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogYCR7aGVpZ2h0fXB4YCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBgOTAlYFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS5wcmV2aWV3U2luZ2xlUGxhbiA9IChwbGFuKSA9PiB7XG4gICAgICAgICAgICBQbGFuLmFkZFNpbmdsZVByZXZpZXcocGxhbikudGhlbihyZXMgPT4ge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnZGFzaGJvYXJkX3BsYW5fc2luZ2xlX3ByZXZpZXcnKVxuICAgICAgICAgICAgfSwgZXJyID0+IGNvbnNvbGUubG9nKCdlcnIgQGFkZFNpbmdsZVByZXZpZXc6ICcsIGVycikpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoJHJvb3RTY29wZS5jdXJyZW50U3RhdGUgPT0gJ2Rhc2hib2FyZF9wbGFuX3NpbmdsZV9wcmV2aWV3Jykge1xuICAgICAgICBQbGFuLmdldFNpbmdsZVByZXZpZXcoKS50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygncmVzIEBnZXRTaW5nbGVQcmV2aWV3OiAnLCByZXMpXG4gICAgICAgICAgICAkc2NvcGUucGxhblByZXZpZXcgPSByZXM7XG4gICAgICAgICAgICAkc2NvcGUucGxhblByZXZpZXcuaW5zdGFsbG1lbnQgPSAocmVzLnRvdGFsIC0gcmVzLmRvd25wYXkpIC8gcmVzLnRpbWVzXG4gICAgICAgIH0sIGVyciA9PiBjb25zb2xlLmxvZygnZXJyIEBnZXRTaW5nbGVQcmV2aWV3OiAnLCBlcnIpKVxuXG4gICAgICAgIHZhciB1dWlkID0gY3JlYXRlVVVJRCgpXG4gICAgICAgIGNvbnNvbGUubG9nKCd1dWlkOiAnLCB1dWlkKVxuXG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZVVVSUQoKSB7XG4gICAgICAgICAgICB2YXIgcyA9IFtdO1xuICAgICAgICAgICAgdmFyIGhleERpZ2l0cyA9IFwiMDEyMzQ1Njc4OWFiY2RlZlwiO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAzNjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgc1tpXSA9IGhleERpZ2l0cy5zdWJzdHIoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMHgxMCksIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc1sxNF0gPSBcIjRcIjsgLy8gYml0cyAxMi0xNSBvZiB0aGUgdGltZV9oaV9hbmRfdmVyc2lvbiBmaWVsZCB0byAwMDEwXG4gICAgICAgICAgICBzWzE5XSA9IGhleERpZ2l0cy5zdWJzdHIoKHNbMTldICYgMHgzKSB8IDB4OCwgMSk7IC8vIGJpdHMgNi03IG9mIHRoZSBjbG9ja19zZXFfaGlfYW5kX3Jlc2VydmVkIHRvIDAxXG4gICAgICAgICAgICBzWzhdID0gc1sxM10gPSBzWzE4XSA9IHNbMjNdID0gXCItXCI7XG5cbiAgICAgICAgICAgIHZhciB1dWlkID0gcy5qb2luKFwiXCIpO1xuICAgICAgICAgICAgcmV0dXJuIHV1aWQ7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCIndXNlIHN0cmljdCc7XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdwaW5jaEFwcCcpXG4gICAgLmRpcmVjdGl2ZSgnZm9jdXNPbicsIGZvY3VzT24pXG5cbmZ1bmN0aW9uIGZvY3VzT24oKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBlbGVtLCBhdHRyKSB7XG4gICAgICAgIHNjb3BlLiRvbignZm9jdXNPbicsIGZ1bmN0aW9uKGUsIG5hbWUpIHtcbiAgICAgICAgICAgIGlmIChuYW1lID09PSBhdHRyLmZvY3VzT24pIHtcbiAgICAgICAgICAgICAgICBlbGVtWzBdLmZvY3VzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG59XG4iLCIndXNlIHN0cmljdCc7XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdwaW5jaEFwcCcpXG4gICAgLmRpcmVjdGl2ZSgndG9vbFRpcCcsIHRvb2xUaXApXG5cbmZ1bmN0aW9uIHRvb2xUaXAoKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgICBhbmd1bGFyLmVsZW1lbnQoJy50b29sLXRpcCcpLm9uKCdjbGljayBtb3VzZWxlYXZlJywgaGlkZVRvb2x0aXApO1xuICAgICAgICBhbmd1bGFyLmVsZW1lbnQoJy50b29sLXRpcCcpLm9uKCdtb3VzZWVudGVyJywgc2hvd1Rvb2x0aXApO1xuICAgIH07XG59XG5cbmZ1bmN0aW9uIGhpZGVUb29sdGlwKCkge1xuICAgICQodGhpcykudG9vbHRpcCgnaGlkZScpO1xufVxuXG5mdW5jdGlvbiBzaG93VG9vbHRpcCgpIHtcbiAgICAkKHRoaXMpLnRvb2x0aXAoJ3Nob3cnKTtcbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
