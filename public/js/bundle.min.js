"use strict";function init(){console.log("jquery loaded"),sticky(),windowScrollDown()}function sticky(){$(".sticky").sticky({topSpacing:60})}function windowScrollDown(){var o,t=0;$(window).scroll(function(){o=$(this).scrollTop(),t>o?($(".home-page nav").removeClass("folded"),$(".home-page nav").css("border-bottom","0px solid")):$(".home-page nav").addClass("folded"),t=o,$(window).scrollTop()<1&&$(".home-page nav").addClass("top"),$(window).scrollTop()>1&&$(".home-page nav").removeClass("top"),$(window).scrollTop()>30,$(window).scrollTop()<540&&$(".home-page nav").css("box-shadow","inset 0 -1px 0px 0px rgba(0,0,0,0)"),$(window).scrollTop()>540&&$(".home-page nav").css("box-shadow","inset 0 -1px 0px 0px rgba(0,0,0,0.1)")})}function Account(o){this.getCurrentUser=function(){return o({method:"GET",url:"/api/auth/currentUser"})},this.sendVerifyCode=function(t){return o({method:"POST",url:"/api/verify/phone",data:t})},this.verifyCode=function(t){return o({method:"PUT",url:"/api/verify/phone",data:t})},this.getUserData=function(t){return o({method:"GET",url:"/api/users/"+t})},this.updateUserData=function(t,e){return o({method:"PUT",url:"/api/users/"+t,data:e})}}function Payment(o){this.chargeNow=function(t){return o({method:"POST",url:"/api/payment/chargeNow",data:t})}}function focus(o,t){return function(e){t(function(){o.$broadcast("focusOn",e)},0)}}function homeCtrl(){console.log("homeCtrl loaded")}function authCtrl(o,t,e,n){function a(){t.getToken()&&n.getCurrentUser(t.getToken()).then(function(t){console.log("res @getCurrentUser: ",t.data),o.currentUser=t.data},function(o){e.go("authEntrance")})}console.log("authCtrl loaded"),o.getCurrentUser=function(){a()},o.auth_enter=function(o){console.log("authData: ",o),t.signup(o).then(function(o){t.setToken(o),e.go("dashboard"),console.log("res @auth_enter: ",o.data),a()},function(o){console.log("err @auth_enter: ",o)})},o.authenticate=function(o){t.authenticate(o)},o.logout=function(){t.logout(),e.go("authEntrance")}}function dashboardCtrl(o,t,e,n,a,r){console.log("dashboardCtrl loaded"),n.getCurrentUser(t.getToken()).then(function(o){a.currentUser||(a.currentUser=o.data),console.log("res @getCurrentUser: ",o.data)},function(o){e.go("home")}),o.sendVerifyCode=function(t){if(console.log("phone: ",t),t.length>5){var e={userData:o.currentUser,phone:t};n.sendVerifyCode(e).then(function(o){console.log("res @sendVerifyCode: ",o.data)},function(o){console.log("err @sendVerifyCode: ",o)})}},o.verifyCode=function(t){if(console.log("code: ",t),0!==t.length){var e={userData:o.currentUser,code:t};n.verifyCode(e).then(function(o){console.log("res @verifyCode: ",o.data)},function(o){console.log("err @verifyCode: ",o)})}},o.doCheckout=function(t){console.log("fff"),console.log("token: ",t);var e={stripeToken:t,userData:o.currentUser};r.chargeNow(e).then(function(o){console.log("res: ",o.data)},function(o){console.log("err: ",o)})},o.installmentsGraphData=[],o.updateTimes=function(t){o.installmentsGraphData=[];for(var e=0;t>e;e++){var n=~~(o.plan.total/t),a=~~(140*(2/t));o.installmentsGraphData.push({price:n,style:{height:a+"px",width:"90%"}})}}}function focusOn(){return function(o,t,e){o.$on("focusOn",function(o,n){n===e.focusOn&&t[0].focus()})}}function toolTip(){return function(o,t,e){angular.element(".tool-tip").on("click mouseleave",hideTooltip),angular.element(".tool-tip").on("mouseenter",showTooltip)}}function hideTooltip(){$(this).tooltip("hide")}function showTooltip(){$(this).tooltip("show")}angular.module("pinchApp",["ui.router","satellizer","ngFileUpload","ngImgCrop","stripe.checkout","angular-loading-bar"]).config(["$stateProvider","$urlRouterProvider","$authProvider",function(o,t,e){Stripe.setPublishableKey("pk_test_t1eThhOKl6esrp6f4jyWqU4J"),o.state(home).state(authEntrance).state(dashboard).state(dashboard_payment).state(dashboard_plan).state(dashboard_account),t.otherwise("/")}]);var home={name:"home",url:"/",views:{main:{templateUrl:"/html/home.html",controller:"homeCtrl"}}},authEntrance={name:"authEntrance",url:"/entrance",views:{main:{templateUrl:"/html/entrance.html",controller:"authCtrl"}}},dashboard={name:"dashboard",url:"/dashboard",views:{main:{templateUrl:"/html/dashboard.html",controller:"dashboardCtrl"}}},dashboard_payment={name:"dashboard_payment",url:"/payment",parent:"dashboard",views:{dashboard_section:{templateUrl:"/html/dashboard_payment.html",controller:"dashboardCtrl"}}},dashboard_plan={name:"dashboard_plan",url:"/plan",parent:"dashboard",views:{dashboard_section:{templateUrl:"/html/dashboard_plan.html",controller:"dashboardCtrl"}}},dashboard_account={name:"dashboard_account",url:"/account",parent:"dashboard",views:{dashboard_section:{templateUrl:"/html/dashboard_account.html",controller:"dashboardCtrl"}}};$(document).ready(init),Account.$inject=["$http"],Payment.$inject=["$http"],focus.$inject=["$rootScope","$timeout"],angular.module("pinchApp").service("Account",Account).service("Payment",Payment).factory("focus",focus),authCtrl.$inject=["$scope","$auth","$state","Account"],dashboardCtrl.$inject=["$scope","$auth","$state","Account","$rootScope","Payment"],angular.module("pinchApp").controller("homeCtrl",homeCtrl).controller("authCtrl",authCtrl).controller("dashboardCtrl",dashboardCtrl),angular.module("pinchApp").directive("focusOn",focusOn),angular.module("pinchApp").directive("toolTip",toolTip);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFtb2R1bGUuanMiLCJtYWluLmpzIiwic2VydmljZXMuanMiLCJjb250cm9sbGVycy9jb250cm9sbGVycy5qcyIsImRpcmVjdGl2ZXMvZm9jdXNPbi5kaXJlY3RpdmUuanMiLCJkaXJlY3RpdmVzL3Rvb2xUaXAuZGlyZWN0aXZlLmpzIl0sIm5hbWVzIjpbImluaXQiLCJjb25zb2xlIiwibG9nIiwic3RpY2t5Iiwid2luZG93U2Nyb2xsRG93biIsIiQiLCJ0b3BTcGFjaW5nIiwic3QiLCJsYXN0U2Nyb2xsVG9wIiwid2luZG93Iiwic2Nyb2xsIiwidGhpcyIsInNjcm9sbFRvcCIsInJlbW92ZUNsYXNzIiwiY3NzIiwiYWRkQ2xhc3MiLCJBY2NvdW50IiwiJGh0dHAiLCJnZXRDdXJyZW50VXNlciIsIm1ldGhvZCIsInVybCIsInNlbmRWZXJpZnlDb2RlIiwidXNlck9iaiIsImRhdGEiLCJ2ZXJpZnlDb2RlIiwiZ2V0VXNlckRhdGEiLCJ1cmlVc2VySWQiLCJ1cGRhdGVVc2VyRGF0YSIsIlBheW1lbnQiLCJjaGFyZ2VOb3ciLCJkYXRhT2JqIiwiZm9jdXMiLCIkcm9vdFNjb3BlIiwiJHRpbWVvdXQiLCJuYW1lIiwiJGJyb2FkY2FzdCIsImhvbWVDdHJsIiwiYXV0aEN0cmwiLCIkc2NvcGUiLCIkYXV0aCIsIiRzdGF0ZSIsImdldFRva2VuIiwidGhlbiIsInJlcyIsImN1cnJlbnRVc2VyIiwiZXJyIiwiZ28iLCJhdXRoX2VudGVyIiwiYXV0aERhdGEiLCJzaWdudXAiLCJzZXRUb2tlbiIsImF1dGhlbnRpY2F0ZSIsInByb3ZpZGVyIiwibG9nb3V0IiwiZGFzaGJvYXJkQ3RybCIsInBob25lIiwibGVuZ3RoIiwidXNlckRhdGEiLCJjb2RlIiwiZG9DaGVja291dCIsInRva2VuIiwic3RyaXBlVG9rZW4iLCJpbnN0YWxsbWVudHNHcmFwaERhdGEiLCJ1cGRhdGVUaW1lcyIsInRpbWVzIiwiaSIsImluc3RhbGxtZW50IiwicGxhbiIsInRvdGFsIiwiaGVpZ2h0IiwicHVzaCIsInByaWNlIiwic3R5bGUiLCJ3aWR0aCIsImZvY3VzT24iLCJzY29wZSIsImVsZW0iLCJhdHRyIiwiJG9uIiwiZSIsInRvb2xUaXAiLCJlbGVtZW50IiwiYXR0cnMiLCJhbmd1bGFyIiwib24iLCJoaWRlVG9vbHRpcCIsInNob3dUb29sdGlwIiwidG9vbHRpcCIsIm1vZHVsZSIsImNvbmZpZyIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwiJGF1dGhQcm92aWRlciIsIlN0cmlwZSIsInNldFB1Ymxpc2hhYmxlS2V5Iiwic3RhdGUiLCJob21lIiwiYXV0aEVudHJhbmNlIiwiZGFzaGJvYXJkIiwiZGFzaGJvYXJkX3BheW1lbnQiLCJkYXNoYm9hcmRfcGxhbiIsImRhc2hib2FyZF9hY2NvdW50Iiwib3RoZXJ3aXNlIiwidmlld3MiLCJtYWluIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwicGFyZW50IiwiZGFzaGJvYXJkX3NlY3Rpb24iLCJkb2N1bWVudCIsInJlYWR5IiwiJGluamVjdCIsInNlcnZpY2UiLCJmYWN0b3J5IiwiZGlyZWN0aXZlIl0sIm1hcHBpbmdzIjoiQUFBQSxZQ0lBLFNBQVNBLFFBQ0xDLFFBQVFDLElBQUksaUJBQ1pDLFNBQ0FDLG1CQUdKLFFBQVNELFVBQ0xFLEVBQUUsV0FBV0YsUUFDVEcsV0FBWSxLQUlwQixRQUFTRixvQkFDTCxHQUNJRyxHQURBQyxFQUFnQixDQUVwQkgsR0FBRUksUUFBUUMsT0FBTyxXQUViSCxFQUFLRixFQUFFTSxNQUFNQyxZQUNKSixFQUFMRCxHQUNBRixFQUFFLGtCQUFrQlEsWUFBWSxVQUNoQ1IsRUFBRSxrQkFBa0JTLElBQUksZ0JBQWlCLGNBRXpDVCxFQUFFLGtCQUFrQlUsU0FBUyxVQUVqQ1AsRUFBZ0JELEVBRVpGLEVBQUVJLFFBQVFHLFlBQWMsR0FDeEJQLEVBQUUsa0JBQWtCVSxTQUFTLE9BRTdCVixFQUFFSSxRQUFRRyxZQUFjLEdBQ3hCUCxFQUFFLGtCQUFrQlEsWUFBWSxPQUVoQ1IsRUFBRUksUUFB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QU8sWUFDUGtCLFdBQVcsV0FBWXRFLFVBQ3ZCc0UsV0FBVyxXQUFZckUsVUFDdkJxRSxXQUFXLGdCQUFpQnBELGVDSmpDNkIsUUFDS0ssT0FBTyxZQUNQMEIsVUFBVSxVQUFXeEMsU0NGMUJTLFFBQ0tLLE9BQU8sWUFDUDBCLFVBQVUsVUFBV2xDIiwiZmlsZSI6ImJ1bmRsZS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdwaW5jaEFwcCcsIFtcbiAgICAgICAgJ3VpLnJvdXRlcicsXG4gICAgICAgICdzYXRlbGxpemVyJyxcbiAgICAgICAgLy8gJ3VpLmJvb3RzdHJhcCcsXG4gICAgICAgICduZ0ZpbGVVcGxvYWQnLFxuICAgICAgICAnbmdJbWdDcm9wJyxcbiAgICAgICAgJ3N0cmlwZS5jaGVja291dCcsXG4gICAgICAgICdhbmd1bGFyLWxvYWRpbmctYmFyJ1xuICAgIF0pXG4gICAgLmNvbmZpZyhmdW5jdGlvbigkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyLCAkYXV0aFByb3ZpZGVyKSB7XG4gICAgICAgIFN0cmlwZS5zZXRQdWJsaXNoYWJsZUtleSgncGtfdGVzdF90MWVUaGhPS2w2ZXNycDZmNGp5V3FVNEonKVxuXG4gICAgICAgIC8vICRhdXRoUHJvdmlkZXJcbiAgICAgICAgLy8gICAgIC5mYWNlYm9vayh7XG4gICAgICAgIC8vICAgICAgICAgY2xpZW50SWQ6ICcyOTgxNjUxMTM4NDkzNjYnXG4gICAgICAgIC8vICAgICB9KTtcblxuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKGhvbWUpXG4gICAgICAgICAgICAuc3RhdGUoYXV0aEVudHJhbmNlKVxuICAgICAgICAgICAgLnN0YXRlKGRhc2hib2FyZClcbiAgICAgICAgICAgIC5zdGF0ZShkYXNoYm9hcmRfcGF5bWVudClcbiAgICAgICAgICAgIC5zdGF0ZShkYXNoYm9hcmRfcGxhbilcbiAgICAgICAgICAgIC5zdGF0ZShkYXNoYm9hcmRfYWNjb3VudClcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcGFnZSlcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcGFnZV9wcm9qZWN0cylcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcGFnZV9saWtlZClcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcGFnZV9mb2xsb3dlcnMpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHJvamVjdHBhZ2UpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHJvamVjdFNldHRpbmcpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHJvamVjdFNldHRpbmdfZ2VuZXJhbClcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcm9qZWN0U2V0dGluZ19yZXF1ZXN0KVxuICAgICAgICAgICAgLy8gLnN0YXRlKHByb2plY3RTZXR0aW5nX3ByaXZhY3kpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHJvamVjdFNldHRpbmdfZGFuZ2VyKVxuICAgICAgICAgICAgLy8gLnN0YXRlKHByb2ZpbGVTZXR0aW5nKVxuICAgICAgICAgICAgLy8gLnN0YXRlKHByb2ZpbGVTZXR0aW5nX2dlbmVyYWwpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHJvZmlsZVNldHRpbmdfcmVxdWVzdClcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcm9maWxlU2V0dGluZ19wcml2YWN5KVxuICAgICAgICAgICAgLy8gLnN0YXRlKHByb2ZpbGVTZXR0aW5nX2RhbmdlcilcblxuXG4gICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcbiAgICB9KTtcblxuXG5sZXQgaG9tZSA9IHtcbiAgICBuYW1lOiAnaG9tZScsXG4gICAgdXJsOiAnLycsXG4gICAgdmlld3M6IHtcbiAgICAgICAgbWFpbjoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9ob21lLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2hvbWVDdHJsJ1xuICAgICAgICB9XG4gICAgfVxufVxubGV0IGF1dGhFbnRyYW5jZSA9IHtcbiAgICBuYW1lOiAnYXV0aEVudHJhbmNlJyxcbiAgICB1cmw6ICcvZW50cmFuY2UnLFxuICAgIHZpZXdzOiB7XG4gICAgICAgIG1haW46IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvZW50cmFuY2UuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnYXV0aEN0cmwnXG4gICAgICAgIH1cbiAgICB9XG59XG5sZXQgZGFzaGJvYXJkID0ge1xuICAgIG5hbWU6ICdkYXNoYm9hcmQnLFxuICAgIHVybDogJy9kYXNoYm9hcmQnLFxuICAgIHZpZXdzOiB7XG4gICAgICAgIG1haW46IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvZGFzaGJvYXJkLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2Rhc2hib2FyZEN0cmwnXG4gICAgICAgIH1cbiAgICB9XG59XG5cbmxldCBkYXNoYm9hcmRfcGF5bWVudCA9IHtcbiAgICBuYW1lOiAnZGFzaGJvYXJkX3BheW1lbnQnLFxuICAgIHVybDogJy9wYXltZW50JyxcbiAgICBwYXJlbnQ6ICdkYXNoYm9hcmQnLFxuICAgIHZpZXdzOiB7XG4gICAgICAgIGRhc2hib2FyZF9zZWN0aW9uOiB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL2Rhc2hib2FyZF9wYXltZW50Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2Rhc2hib2FyZEN0cmwnXG4gICAgICAgIH1cbiAgICB9XG59XG5sZXQgZGFzaGJvYXJkX3BsYW4gPSB7XG4gICAgbmFtZTogJ2Rhc2hib2FyZF9wbGFuJyxcbiAgICB1cmw6ICcvcGxhbicsXG4gICAgcGFyZW50OiAnZGFzaGJvYXJkJyxcbiAgICB2aWV3czoge1xuICAgICAgICBkYXNoYm9hcmRfc2VjdGlvbjoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9kYXNoYm9hcmRfcGxhbi5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdkYXNoYm9hcmRDdHJsJ1xuICAgICAgICB9XG4gICAgfVxufVxubGV0IGRhc2hib2FyZF9hY2NvdW50ID0ge1xuICAgIG5hbWU6ICdkYXNoYm9hcmRfYWNjb3VudCcsXG4gICAgdXJsOiAnL2FjY291bnQnLFxuICAgIHBhcmVudDogJ2Rhc2hib2FyZCcsXG4gICAgdmlld3M6IHtcbiAgICAgICAgZGFzaGJvYXJkX3NlY3Rpb246IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvZGFzaGJvYXJkX2FjY291bnQuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnZGFzaGJvYXJkQ3RybCdcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLy8gbGV0IHBwYWdlID0ge1xuLy8gICAgIG5hbWU6ICdwcGFnZScsXG4vLyAgICAgdXJsOiAnL20vOnVzZXJJZCcsXG4vLyAgICAgdmlld3M6IHtcbi8vICAgICAgICAgJ21haW4nOiB7XG4vLyAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL3BwYWdlLmh0bWwnLFxuLy8gICAgICAgICAgICAgY29udHJvbGxlcjogJ3BwYWdlQ3RybCdcbi8vICAgICAgICAgfSxcbi8vICAgICAgICAgJ3JpZ2h0X3NlY3Rpb24nOiB7XG4vLyAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL3BwYWdlX3Byb2plY3RzLmh0bWwnLFxuLy8gICAgICAgICAgICAgY29udHJvbGxlcjogJ3BwYWdlQ3RybCdcbi8vICAgICAgICAgfVxuLy8gICAgIH1cbi8vIH1cbi8vXG4vLyBsZXQgcHBhZ2VfcHJvamVjdHMgPSB7XG4vLyAgICAgbmFtZTogJ3BwYWdlX3Byb2plY3RzJyxcbi8vICAgICB1cmw6ICcvcHJvamVjdHMnLFxuLy8gICAgIHBhcmVudDogJ3BwYWdlJyxcbi8vICAgICB2aWV3czoge1xuLy8gICAgICAgICByaWdodF9zZWN0aW9uOiB7XG4vLyAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL3BwYWdlX3Byb2plY3RzLmh0bWwnLFxuLy8gICAgICAgICAgICAgY29udHJvbGxlcjogJ3BwYWdlQ3RybCdcbi8vICAgICAgICAgfVxuLy8gICAgIH1cbi8vIH1cbi8vIGxldCBwcGFnZV9saWtlZCA9IHtcbi8vICAgICBuYW1lOiAncHBhZ2VfbGlrZWQnLFxuLy8gICAgIHVybDogJy9saWtlZCcsXG4vLyAgICAgcGFyZW50OiAncHBhZ2UnLFxuLy8gICAgIHZpZXdzOiB7XG4vLyAgICAgICAgIHJpZ2h0X3NlY3Rpb246IHtcbi8vICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvcHBhZ2VfbGlrZWQuaHRtbCcsXG4vLyAgICAgICAgICAgICBjb250cm9sbGVyOiAncHBhZ2VDdHJsJ1xuLy8gICAgICAgICB9XG4vLyAgICAgfVxuLy8gfVxuLy8gbGV0IHBwYWdlX2ZvbGxvd2VycyA9IHtcbi8vICAgICBuYW1lOiAncHBhZ2VfZm9sbG93ZXJzJyxcbi8vICAgICB1cmw6ICcvZm9sbG93ZXJzJyxcbi8vICAgICBwYXJlbnQ6ICdwcGFnZScsXG4vLyAgICAgdmlld3M6IHtcbi8vICAgICAgICAgcmlnaHRfc2VjdGlvbjoge1xuLy8gICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9wcGFnZV9mb2xsb3dlcnMuaHRtbCcsXG4vLyAgICAgICAgICAgICBjb250cm9sbGVyOiAncHBhZ2VDdHJsJ1xuLy8gICAgICAgICB9XG4vLyAgICAgfVxuLy8gfVxuLy8gbGV0IHByb2plY3RwYWdlID0ge1xuLy8gICAgIG5hbWU6ICdwcm9qZWN0cGFnZScsXG4vLyAgICAgdXJsOiAnLzpwcm9qZWN0SWQnLFxuLy8gICAgIHZpZXdzOiB7XG4vLyAgICAgICAgIG1haW46IHtcbi8vICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvcHJvamVjdHBhZ2UuaHRtbCcsXG4vLyAgICAgICAgICAgICBjb250cm9sbGVyOiAncHJvamVjdHBhZ2VDdHJsJ1xuLy8gICAgICAgICB9XG4vLyAgICAgfVxuLy8gfVxuLy8gbGV0IHByb2plY3RTZXR0aW5nID0ge1xuLy8gICAgIG5hbWU6ICdwcm9qZWN0U2V0dGluZycsXG4vLyAgICAgdXJsOiAnL3Byb2plY3QvOnByb2plY3RJZC9zZXR0aW5nJyxcbi8vICAgICB2aWV3czoge1xuLy8gICAgICAgICBtYWluOiB7XG4vLyAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL3Byb2plY3RTZXR0aW5nLmh0bWwnLFxuLy8gICAgICAgICAgICAgY29udHJvbGxlcjogJ3Byb2plY3RTZXR0aW5nQ3RybCdcbi8vICAgICAgICAgfVxuLy8gICAgIH1cbi8vIH1cbi8vIGxldCBwcm9qZWN0U2V0dGluZ19nZW5lcmFsID0ge1xuLy8gICAgIG5hbWU6ICdwcm9qZWN0U2V0dGluZ19nZW5lcmFsJyxcbi8vICAgICB1cmw6ICcvZ2VuZXJhbCcsXG4vLyAgICAgcGFyZW50OiAncHJvamVjdFNldHRpbmcnLFxuLy8gICAgIHZpZXdzOiB7XG4vLyAgICAgICAgIHJpZ2h0X3NlY3Rpb246IHtcbi8vICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvcHJvamVjdFNldHRpbmdfZ2VuZXJhbC5odG1sJyxcbi8vICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwcm9qZWN0U2V0dGluZ0N0cmwnXG4vLyAgICAgICAgIH1cbi8vICAgICB9XG4vLyB9XG4vLyBsZXQgcHJvamVjdFNldHRpbmdfcmVxdWVzdCA9IHtcbi8vICAgICBuYW1lOiAncHJvamVjdFNldHRpbmdfcmVxdWVzdCcsXG4vLyAgICAgdXJsOiAnL3JlcXVlc3QnLFxuLy8gICAgIHBhcmVudDogJ3Byb2plY3RTZXR0aW5nJyxcbi8vICAgICB2aWV3czoge1xuLy8gICAgICAgICByaWdodF9zZWN0aW9uOiB7XG4vLyAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL3Byb2plY3RTZXR0aW5nX3JlcXVlc3QuaHRtbCcsXG4vLyAgICAgICAgICAgICBjb250cm9sbGVyOiAncHJvamVjdFNldHRpbmdDdHJsJ1xuLy8gICAgICAgICB9XG4vLyAgICAgfVxuLy8gfVxuLy8gbGV0IHByb2plY3RTZXR0aW5nX3ByaXZhY3kgPSB7XG4vLyAgICAgbmFtZTogJ3Byb2plY3RTZXR0aW5nX3ByaXZhY3knLFxuLy8gICAgIHVybDogJy9wcml2YWN5Jyxcbi8vICAgICBwYXJlbnQ6ICdwcm9qZWN0U2V0dGluZycsXG4vLyAgICAgdmlld3M6IHtcbi8vICAgICAgICAgcmlnaHRfc2VjdGlvbjoge1xuLy8gICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9wcm9qZWN0U2V0dGluZ19wcml2YWN5Lmh0bWwnLFxuLy8gICAgICAgICAgICAgY29udHJvbGxlcjogJ3Byb2plY3RTZXR0aW5nQ3RybCdcbi8vICAgICAgICAgfVxuLy8gICAgIH1cbi8vIH1cbi8vIGxldCBwcm9qZWN0U2V0dGluZ19kYW5nZXIgPSB7XG4vLyAgICAgbmFtZTogJ3Byb2plY3RTZXR0aW5nX2RhbmdlcicsXG4vLyAgICAgdXJsOiAnL2RhbmdlcicsXG4vLyAgICAgcGFyZW50OiAncHJvamVjdFNldHRpbmcnLFxuLy8gICAgIHZpZXdzOiB7XG4vLyAgICAgICAgIHJpZ2h0X3NlY3Rpb246IHtcbi8vICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvcHJvamVjdFNldHRpbmdfZGFuZ2VyLmh0bWwnLFxuLy8gICAgICAgICAgICAgY29udHJvbGxlcjogJ3Byb2plY3RTZXR0aW5nQ3RybCdcbi8vICAgICAgICAgfVxuLy8gICAgIH1cbi8vIH1cbi8vIGxldCBwcm9maWxlU2V0dGluZyA9IHtcbi8vICAgICBuYW1lOiAncHJvZmlsZVNldHRpbmcnLFxuLy8gICAgIHVybDogJy91c2VyLzp1c2VySWQvc2V0dGluZycsXG4vLyAgICAgdmlld3M6IHtcbi8vICAgICAgICAgbWFpbjoge1xuLy8gICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9wcm9maWxlU2V0dGluZy5odG1sJyxcbi8vICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwcm9maWxlU2V0dGluZ0N0cmwnXG4vLyAgICAgICAgIH1cbi8vICAgICB9XG4vLyB9XG4vLyBsZXQgcHJvZmlsZVNldHRpbmdfZ2VuZXJhbCA9IHtcbi8vICAgICBuYW1lOiAncHJvZmlsZVNldHRpbmdfZ2VuZXJhbCcsXG4vLyAgICAgdXJsOiAnL2dlbmVyYWwnLFxuLy8gICAgIHBhcmVudDogJ3Byb2ZpbGVTZXR0aW5nJyxcbi8vICAgICB2aWV3czoge1xuLy8gICAgICAgICByaWdodF9zZWN0aW9uOiB7XG4vLyAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL3Byb2ZpbGVTZXR0aW5nX2dlbmVyYWwuaHRtbCcsXG4vLyAgICAgICAgICAgICBjb250cm9sbGVyOiAncHJvZmlsZVNldHRpbmdDdHJsJ1xuLy8gICAgICAgICB9XG4vLyAgICAgfVxuLy8gfVxuLy8gbGV0IHByb2ZpbGVTZXR0aW5nX3JlcXVlc3QgPSB7XG4vLyAgICAgbmFtZTogJ3Byb2ZpbGVTZXR0aW5nX3JlcXVlc3QnLFxuLy8gICAgIHVybDogJy9yZXF1ZXN0Jyxcbi8vICAgICBwYXJlbnQ6ICdwcm9maWxlU2V0dGluZycsXG4vLyAgICAgdmlld3M6IHtcbi8vICAgICAgICAgcmlnaHRfc2VjdGlvbjoge1xuLy8gICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9wcm9maWxlU2V0dGluZ19yZXF1ZXN0Lmh0bWwnLFxuLy8gICAgICAgICAgICAgY29udHJvbGxlcjogJ3Byb2ZpbGVTZXR0aW5nQ3RybCdcbi8vICAgICAgICAgfVxuLy8gICAgIH1cbi8vIH1cbi8vIGxldCBwcm9maWxlU2V0dGluZ19wcml2YWN5ID0ge1xuLy8gICAgIG5hbWU6ICdwcm9maWxlU2V0dGluZ19wcml2YWN5Jyxcbi8vICAgICB1cmw6ICcvcHJpdmFjeScsXG4vLyAgICAgcGFyZW50OiAncHJvZmlsZVNldHRpbmcnLFxuLy8gICAgIHZpZXdzOiB7XG4vLyAgICAgICAgIHJpZ2h0X3NlY3Rpb246IHtcbi8vICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvcHJvZmlsZVNldHRpbmdfcHJpdmFjeS5odG1sJyxcbi8vICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwcm9maWxlU2V0dGluZ0N0cmwnXG4vLyAgICAgICAgIH1cbi8vICAgICB9XG4vLyB9XG4vLyBsZXQgcHJvZmlsZVNldHRpbmdfZGFuZ2VyID0ge1xuLy8gICAgICAgICBuYW1lOiAncHJvZmlsZVNldHRpbmdfZGFuZ2VyJyxcbi8vICAgICAgICAgdXJsOiAnL2RhbmdlcicsXG4vLyAgICAgICAgIHBhcmVudDogJ3Byb2ZpbGVTZXR0aW5nJyxcbi8vICAgICAgICAgdmlld3M6IHtcbi8vICAgICAgICAgICAgIHJpZ2h0X3NlY3Rpb246IHtcbi8vICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL3Byb2ZpbGVTZXR0aW5nX2Rhbmdlci5odG1sJyxcbi8vICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAncHJvZmlsZVNldHRpbmdDdHJsJ1xuLy8gICAgICAgICAgICAgfVxuLy8gICAgICAgICB9XG4vLyAgICAgfVxuIiwiJ3VzZSBzdHJpY3QnXG5cbiQoZG9jdW1lbnQpLnJlYWR5KGluaXQpO1xuXG5mdW5jdGlvbiBpbml0KCkge1xuICAgIGNvbnNvbGUubG9nKCdqcXVlcnkgbG9hZGVkJyk7XG4gICAgc3RpY2t5KClcbiAgICB3aW5kb3dTY3JvbGxEb3duKClcbn1cblxuZnVuY3Rpb24gc3RpY2t5KCkge1xuICAgICQoXCIuc3RpY2t5XCIpLnN0aWNreSh7XG4gICAgICAgIHRvcFNwYWNpbmc6IDYwXG4gICAgfSlcbn1cblxuZnVuY3Rpb24gd2luZG93U2Nyb2xsRG93bigpIHtcbiAgICB2YXIgbGFzdFNjcm9sbFRvcCA9IDBcbiAgICB2YXIgc3RcbiAgICAkKHdpbmRvdykuc2Nyb2xsKGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBjb25zb2xlLmxvZygkKHdpbmRvdykuc2Nyb2xsVG9wKCkpO1xuICAgICAgICBzdCA9ICQodGhpcykuc2Nyb2xsVG9wKCk7XG4gICAgICAgIGlmIChzdCA8IGxhc3RTY3JvbGxUb3ApIHtcbiAgICAgICAgICAgICQoJy5ob21lLXBhZ2UgbmF2JykucmVtb3ZlQ2xhc3MoJ2ZvbGRlZCcpXG4gICAgICAgICAgICAkKCcuaG9tZS1wYWdlIG5hdicpLmNzcygnYm9yZGVyLWJvdHRvbScsICcwcHggc29saWQnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICQoJy5ob21lLXBhZ2UgbmF2JykuYWRkQ2xhc3MoJ2ZvbGRlZCcpXG4gICAgICAgIH1cbiAgICAgICAgbGFzdFNjcm9sbFRvcCA9IHN0XG5cbiAgICAgICAgaWYgKCQod2luZG93KS5zY3JvbGxUb3AoKSA8IDEpIHtcbiAgICAgICAgICAgICQoJy5ob21lLXBhZ2UgbmF2JykuYWRkQ2xhc3MoJ3RvcCcpXG4gICAgICAgIH1cbiAgICAgICAgaWYgKCQod2luZG93KS5zY3JvbGxUb3AoKSA+IDEpIHtcbiAgICAgICAgICAgICQoJy5ob21lLXBhZ2UgbmF2JykucmVtb3ZlQ2xhc3MoJ3RvcCcpXG4gICAgICAgIH1cbiAgICAgICAgaWYgKCQod2luZG93KS5zY3JvbGxUb3AoKSA+IDMwKSB7XG5cbiAgICAgICAgfVxuICAgICAgICBpZiAoJCh3aW5kb3cpLnNjcm9sbFRvcCgpIDwgNTQwKSB7XG4gICAgICAgICAgICAkKCcuaG9tZS1wYWdlIG5hdicpLmNzcygnYm94LXNoYWRvdycsICdpbnNldCAwIC0xcHggMHB4IDBweCByZ2JhKDAsMCwwLDApJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCQod2luZG93KS5zY3JvbGxUb3AoKSA+IDU0MCkge1xuICAgICAgICAgICAgJCgnLmhvbWUtcGFnZSBuYXYnKS5jc3MoJ2JveC1zaGFkb3cnLCAnaW5zZXQgMCAtMXB4IDBweCAwcHggcmdiYSgwLDAsMCwwLjEpJyk7XG4gICAgICAgIH1cblxuICAgIH0pXG59XG4iLCIndXNlIHN0cmljdCc7XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdwaW5jaEFwcCcpXG4gICAgLnNlcnZpY2UoJ0FjY291bnQnLCBBY2NvdW50KVxuICAgIC5zZXJ2aWNlKCdQYXltZW50JywgUGF5bWVudClcbiAgICAuZmFjdG9yeSgnZm9jdXMnLCBmb2N1cylcbiAgICAvLyAuZGlyZWN0aXZlKCdzdGF0ZUxvYWRpbmdJbmRpY2F0b3InLCBzdGF0ZUxvYWRpbmdJbmRpY2F0b3IpXG5mdW5jdGlvbiBBY2NvdW50KCRodHRwKSB7XG4gICAgdGhpcy5nZXRDdXJyZW50VXNlciA9ICgpID0+IHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICB1cmw6IGAvYXBpL2F1dGgvY3VycmVudFVzZXJgXG4gICAgICAgIH0pXG4gICAgfVxuICAgIHRoaXMuc2VuZFZlcmlmeUNvZGUgPSAodXNlck9iaikgPT4ge1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICB1cmw6IGAvYXBpL3ZlcmlmeS9waG9uZWAsXG4gICAgICAgICAgICBkYXRhOiB1c2VyT2JqXG4gICAgICAgIH0pXG4gICAgfVxuICAgIHRoaXMudmVyaWZ5Q29kZSA9ICh1c2VyT2JqKSA9PiB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdQVVQnLFxuICAgICAgICAgICAgdXJsOiBgL2FwaS92ZXJpZnkvcGhvbmVgLFxuICAgICAgICAgICAgZGF0YTogdXNlck9ialxuICAgICAgICB9KVxuICAgIH1cbiAgICB0aGlzLmdldFVzZXJEYXRhID0gKHVyaVVzZXJJZCkgPT4ge1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgIHVybDogYC9hcGkvdXNlcnMvJHt1cmlVc2VySWR9YFxuICAgICAgICB9KVxuICAgIH1cbiAgICB0aGlzLnVwZGF0ZVVzZXJEYXRhID0gKHVyaVVzZXJJZCwgdXBkYXRlVXNlckRhdGEpID0+IHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BVVCcsXG4gICAgICAgICAgICB1cmw6IGAvYXBpL3VzZXJzLyR7dXJpVXNlcklkfWAsXG4gICAgICAgICAgICBkYXRhOiB1cGRhdGVVc2VyRGF0YVxuICAgICAgICB9KVxuICAgIH1cbn1cblxuZnVuY3Rpb24gUGF5bWVudCgkaHR0cCl7XG4gICAgdGhpcy5jaGFyZ2VOb3cgPSAoZGF0YU9iaikgPT4ge1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICB1cmw6IGAvYXBpL3BheW1lbnQvY2hhcmdlTm93YCxcbiAgICAgICAgICAgIGRhdGE6IGRhdGFPYmpcbiAgICAgICAgfSlcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGZvY3VzKCRyb290U2NvcGUsICR0aW1lb3V0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2ZvY3VzT24nLCBuYW1lKTtcbiAgICAgICAgfSwgMCk7XG4gICAgfVxufVxuXG4vLyBmdW5jdGlvbiBzdGF0ZUxvYWRpbmdJbmRpY2F0b3IoJHJvb3RTY29wZSkge1xuLy8gICAgIHJldHVybiB7XG4vLyAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4vLyAgICAgICAgIHRlbXBsYXRlOiBcIjxkaXYgbmctc2hvdz0naXNTdGF0ZUxvYWRpbmcnIGNsYXNzPSdsb2FkaW5nLWluZGljYXRvcic+XCIgK1xuLy8gICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPSdsb2FkaW5nLWluZGljYXRvci1ib2R5Jz5cIiArXG4vLyAgICAgICAgICAgICBcIjxoMyBjbGFzcz0nbG9hZGluZy10aXRsZSc+TG9hZGluZy4uLjwvaDM+XCIgK1xuLy8gICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPSdzcGlubmVyJz48Y2hhc2luZy1kb3RzLXNwaW5uZXI+PC9jaGFzaW5nLWRvdHMtc3Bpbm5lcj48L2Rpdj5cIiArXG4vLyAgICAgICAgICAgICBcIjwvZGl2PlwiICtcbi8vICAgICAgICAgICAgIFwiPC9kaXY+XCIsXG4vLyAgICAgICAgIHJlcGxhY2U6IHRydWUsXG4vLyAgICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtLCBhdHRycykge1xuLy8gICAgICAgICAgICAgc2NvcGUuaXNTdGF0ZUxvYWRpbmcgPSBmYWxzZTtcbi8vXG4vLyAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3RhcnQnLCBmdW5jdGlvbigpIHtcbi8vICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnc3RhcnQnKVxuLy8gICAgICAgICAgICAgICAgIHNjb3BlLmlzU3RhdGVMb2FkaW5nID0gdHJ1ZTtcbi8vICAgICAgICAgICAgIH0pO1xuLy8gICAgICAgICAgICAgJHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZVN1Y2Nlc3MnLCBmdW5jdGlvbigpIHtcbi8vICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnY29tcGxldGUnKVxuLy8gICAgICAgICAgICAgICAgIHNjb3BlLmlzU3RhdGVMb2FkaW5nID0gZmFsc2U7XG4vLyAgICAgICAgICAgICB9KTtcbi8vICAgICAgICAgfVxuLy8gICAgIH07XG4vLyB9XG4iLCIndXNlIHN0cmljdCc7XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdwaW5jaEFwcCcpXG4gICAgLmNvbnRyb2xsZXIoJ2hvbWVDdHJsJywgaG9tZUN0cmwpXG4gICAgLmNvbnRyb2xsZXIoJ2F1dGhDdHJsJywgYXV0aEN0cmwpXG4gICAgLmNvbnRyb2xsZXIoJ2Rhc2hib2FyZEN0cmwnLCBkYXNoYm9hcmRDdHJsKVxuICAgIC8vIC5jb250cm9sbGVyKCduYXZDdHJsJywgbmF2Q3RybClcbiAgICAvLyAuY29udHJvbGxlcigncHBhZ2VDdHJsJywgcHBhZ2VDdHJsKVxuICAgIC8vIC5jb250cm9sbGVyKCdwcm9maWxlU2V0dGluZ0N0cmwnLCBwcm9maWxlU2V0dGluZ0N0cmwpXG4gICAgLy8gLmNvbnRyb2xsZXIoJ3Byb2plY3RwYWdlQ3RybCcsIHByb2plY3RwYWdlQ3RybClcbiAgICAvLyAuY29udHJvbGxlcigncHJvamVjdFNldHRpbmdDdHJsJywgcHJvamVjdFNldHRpbmdDdHJsKVxuXG5cbmZ1bmN0aW9uIGhvbWVDdHJsKCkge1xuICAgIGNvbnNvbGUubG9nKCdob21lQ3RybCBsb2FkZWQnKTtcbn1cblxuZnVuY3Rpb24gYXV0aEN0cmwoJHNjb3BlLCAkYXV0aCwgJHN0YXRlLCBBY2NvdW50KSB7XG4gICAgY29uc29sZS5sb2coJ2F1dGhDdHJsIGxvYWRlZCcpXG5cbiAgICAkc2NvcGUuZ2V0Q3VycmVudFVzZXIgPSAoKSA9PiB7XG4gICAgICAgIGdldEN1cnJlbnRVc2VyKClcbiAgICB9XG5cbiAgICAkc2NvcGUuYXV0aF9lbnRlciA9IChhdXRoRGF0YSkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygnYXV0aERhdGE6ICcsIGF1dGhEYXRhKTtcbiAgICAgICAgJGF1dGguc2lnbnVwKGF1dGhEYXRhKVxuICAgICAgICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICAgICAgICAkYXV0aC5zZXRUb2tlbihyZXMpXG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdkYXNoYm9hcmQnKVxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXMgQGF1dGhfZW50ZXI6ICcsIHJlcy5kYXRhKVxuICAgICAgICAgICAgICAgIGdldEN1cnJlbnRVc2VyKClcbiAgICAgICAgICAgICAgICAgICAgLy8gdG9hc3RyLmluZm8oJ1lvdSBoYXZlIHN1Y2Nlc3NmdWxseSBjcmVhdGVkIGEgbmV3IGFjY291bnQgYW5kIGhhdmUgYmVlbiBzaWduZWQtaW4nKTtcbiAgICAgICAgICAgIH0sIGVyciA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2VyciBAYXV0aF9lbnRlcjogJywgZXJyKVxuICAgICAgICAgICAgICAgICAgICAvLyB0b2FzdHIuZXJyb3IocmVzcG9uc2UuZGF0YS5tZXNzYWdlKTtcbiAgICAgICAgICAgIH0pXG4gICAgfVxuXG4gICAgJHNjb3BlLmF1dGhlbnRpY2F0ZSA9IChwcm92aWRlcikgPT4ge1xuICAgICAgICAkYXV0aC5hdXRoZW50aWNhdGUocHJvdmlkZXIpO1xuICAgIH1cbiAgICAkc2NvcGUubG9nb3V0ID0gKCkgPT4ge1xuICAgICAgICAkYXV0aC5sb2dvdXQoKVxuICAgICAgICAkc3RhdGUuZ28oJ2F1dGhFbnRyYW5jZScpXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0Q3VycmVudFVzZXIoKSB7XG4gICAgICAgIGlmICgkYXV0aC5nZXRUb2tlbigpKSB7XG4gICAgICAgICAgICBBY2NvdW50LmdldEN1cnJlbnRVc2VyKCRhdXRoLmdldFRva2VuKCkpXG4gICAgICAgICAgICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlcyBAZ2V0Q3VycmVudFVzZXI6ICcsIHJlcy5kYXRhKVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY3VycmVudFVzZXIgPSByZXMuZGF0YVxuICAgICAgICAgICAgICAgIH0sIGVyciA9PiB7XG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnYXV0aEVudHJhbmNlJylcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfVxuXG59XG5cbmZ1bmN0aW9uIGRhc2hib2FyZEN0cmwoJHNjb3BlLCAkYXV0aCwgJHN0YXRlLCBBY2NvdW50LCAkcm9vdFNjb3BlLCBQYXltZW50KSB7XG4gICAgY29uc29sZS5sb2coJ2Rhc2hib2FyZEN0cmwgbG9hZGVkJylcbiAgICBBY2NvdW50LmdldEN1cnJlbnRVc2VyKCRhdXRoLmdldFRva2VuKCkpXG4gICAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICBpZiAoISRyb290U2NvcGUuY3VycmVudFVzZXIpIHtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gcmVzLmRhdGFcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXMgQGdldEN1cnJlbnRVc2VyOiAnLCByZXMuZGF0YSlcbiAgICAgICAgfSwgZXJyID0+IHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnaG9tZScpXG4gICAgICAgIH0pXG5cbiAgICAkc2NvcGUuc2VuZFZlcmlmeUNvZGUgPSAocGhvbmUpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ3Bob25lOiAnLCBwaG9uZSlcbiAgICAgICAgaWYgKHBob25lLmxlbmd0aCA+IDUpIHtcbiAgICAgICAgICAgIHZhciB1c2VyT2JqID0ge1xuICAgICAgICAgICAgICAgIHVzZXJEYXRhOiAkc2NvcGUuY3VycmVudFVzZXIsXG4gICAgICAgICAgICAgICAgcGhvbmU6IHBob25lXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBBY2NvdW50LnNlbmRWZXJpZnlDb2RlKHVzZXJPYmopXG4gICAgICAgICAgICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlcyBAc2VuZFZlcmlmeUNvZGU6ICcsIHJlcy5kYXRhKVxuICAgICAgICAgICAgICAgIH0sIGVyciA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnIgQHNlbmRWZXJpZnlDb2RlOiAnLCBlcnIpO1xuICAgICAgICAgICAgICAgICAgICAvLyAkc3RhdGUuZ28oJ2hvbWUnKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9XG4gICAgJHNjb3BlLnZlcmlmeUNvZGUgPSAoY29kZSkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygnY29kZTogJywgY29kZSlcbiAgICAgICAgaWYgKGNvZGUubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICB2YXIgdXNlck9iaiA9IHtcbiAgICAgICAgICAgICAgICB1c2VyRGF0YTogJHNjb3BlLmN1cnJlbnRVc2VyLFxuICAgICAgICAgICAgICAgIGNvZGU6IGNvZGVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIEFjY291bnQudmVyaWZ5Q29kZSh1c2VyT2JqKVxuICAgICAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXMgQHZlcmlmeUNvZGU6ICcsIHJlcy5kYXRhKVxuICAgICAgICAgICAgICAgIH0sIGVyciA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnIgQHZlcmlmeUNvZGU6ICcsIGVycik7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH1cblxuICAgICRzY29wZS5kb0NoZWNrb3V0ID0gKHRva2VuKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdmZmYnKTtcbiAgICAgICAgY29uc29sZS5sb2coJ3Rva2VuOiAnLCB0b2tlbik7XG4gICAgICAgIHZhciBkYXRhT2JqID0ge1xuICAgICAgICAgICAgc3RyaXBlVG9rZW46IHRva2VuLFxuICAgICAgICAgICAgdXNlckRhdGE6ICRzY29wZS5jdXJyZW50VXNlclxuICAgICAgICB9XG4gICAgICAgIFBheW1lbnQuY2hhcmdlTm93KGRhdGFPYmopLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXM6ICcsIHJlcy5kYXRhKTtcbiAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnZXJyOiAnLCBlcnIpO1xuICAgICAgICB9KVxuICAgIH1cbiAgICAkc2NvcGUuaW5zdGFsbG1lbnRzR3JhcGhEYXRhID0gW107XG4gICAgJHNjb3BlLnVwZGF0ZVRpbWVzID0gKHRpbWVzKSA9PiB7XG4gICAgICAgICRzY29wZS5pbnN0YWxsbWVudHNHcmFwaERhdGEgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aW1lczsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaW5zdGFsbG1lbnQgPSB+figoJHNjb3BlLnBsYW4udG90YWwgLyB0aW1lcykpO1xuICAgICAgICAgICAgdmFyIGhlaWdodCA9IH5+KDE0MCAqICgyIC8gdGltZXMpKVxuICAgICAgICAgICAgdmFyIHdpZHRoID0gfn4oOTAvaW5zdGFsbG1lbnQpXG5cbiAgICAgICAgICAgICRzY29wZS5pbnN0YWxsbWVudHNHcmFwaERhdGEucHVzaCh7XG4gICAgICAgICAgICAgICAgcHJpY2U6IGluc3RhbGxtZW50LFxuICAgICAgICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogYCR7aGVpZ2h0fXB4YCxcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IGA5MCVgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH1cbn1cblxuXG4vLyBmdW5jdGlvbiBwcm9qZWN0U2V0dGluZ0N0cmwoJHNjb3BlLCAkaHR0cCwgJHN0YXRlUGFyYW1zLCBQcm9qZWN0LCAkc3RhdGUsICRsb2NhdGlvbikge1xuLy8gICAgIGNvbnNvbGUubG9nKCdwcm9qZWN0U2V0dGluZ0N0cmwgbG9hZGVkJyk7XG4vLyAgICAgdmFyIGlzQXV0aG9yID0gZmFsc2U7XG4vLyAgICAgdmFyIHByb2plY3RJZCA9ICRzdGF0ZVBhcmFtcy5wcm9qZWN0SWQ7XG4vL1xuLy8gICAgIFByb2plY3QuZ2V0T25lUG9yamVjdChwcm9qZWN0SWQpLnRoZW4ocmVzID0+IHtcbi8vICAgICAgICAgY29uc29sZS5sb2coJ3Byb2plY3RzOiAnLCByZXMuZGF0YSk7XG4vLyAgICAgICAgICRzY29wZS5wcm9qZWN0ID0gcmVzLmRhdGE7XG4vLyAgICAgICAgICRzY29wZS51cGRhdGVQcm9qZWN0RGF0YSA9ICRzY29wZS5wcm9qZWN0O1xuLy8gICAgICAgICAkc2NvcGUucHJvamVjdC5hdXRob3IuZm9yRWFjaChhdXRob3IgPT4ge1xuLy8gICAgICAgICAgICAgLy8gaW4gY2FzZSwgcHJvamVjdCBoYXMgbXV0aXBsZSBhdXRob3JzXG4vLyAgICAgICAgICAgICBpZiAoYXV0aG9yLl9pZCA9PSAkc2NvcGUuY3VycmVudFVzZXIuX2lkKSB7XG4vLyAgICAgICAgICAgICAgICAgaXNBdXRob3IgPSB0cnVlO1xuLy8gICAgICAgICAgICAgfVxuLy8gICAgICAgICB9KVxuLy8gICAgICAgICBpZiAoaXNBdXRob3IpIHtcbi8vICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdpc0F1dGhvcicpO1xuLy8gICAgICAgICB9IGVsc2Uge1xuLy8gICAgICAgICAgICAgY29uc29sZS5sb2coJ2lzIG5vdCBBdXRob3InKTtcbi8vICAgICAgICAgICAgICRzdGF0ZS5nbygnaG9tZScpO1xuLy8gICAgICAgICB9XG4vLyAgICAgfSwgZXJyID0+IHtcbi8vICAgICAgICAgY29uc29sZS5sb2coJ2VyciB3aGVuIGdldCB0aGlzIHByb2plY3Q6ICcsIGVycik7XG4vLyAgICAgfSlcbi8vICAgICAkc2NvcGUucmVxdWVzdCA9IHtcbi8vICAgICAgICAgcGVvcGxlOiBbXSxcbi8vICAgICAgICAgc3VwcGx5OiBbXSxcbi8vICAgICAgICAgbW9uZXk6IFtdXG4vLyAgICAgfTtcbi8vXG4vLyAgICAgJHNjb3BlLmluaXQgPSAoKSA9PiB7XG4vLyAgICAgICAgIHZhciBjaGVja1VybCA9ICRsb2NhdGlvbi4kJHBhdGguaW5jbHVkZXMoJ2RhbmdlcicpIHx8ICRsb2NhdGlvbi4kJHBhdGguaW5jbHVkZXMoJ3JlcXVlc3QnKSB8fCAkbG9jYXRpb24uJCRwYXRoLmluY2x1ZGVzKCdwcml2YWN5Jylcbi8vICAgICAgICAgaWYgKCFjaGVja1VybCkge1xuLy8gICAgICAgICAgICAgJHN0YXRlLmdvKCdwcm9qZWN0U2V0dGluZ19nZW5lcmFsJyk7XG4vLyAgICAgICAgIH1cbi8vICAgICB9O1xuLy9cbi8vICAgICAkc2NvcGUuYWRkQ2hvaWNlVG9QZW9wbGUgPSAocGVvcGxlKSA9PiB7XG4vLyAgICAgICAgIGlmICgkc2NvcGUucmVxdWVzdC5wZW9wbGUuaW5kZXhPZihwZW9wbGUpICE9PSAtMSkge1xuLy8gICAgICAgICAgICAgJHNjb3BlLnJlcXVlc3QucGVvcGxlLnNwbGljZSgkc2NvcGUucmVxdWVzdC5wZW9wbGUuaW5kZXhPZihwZW9wbGUpLCAxKTtcbi8vICAgICAgICAgfSBlbHNlIHtcbi8vICAgICAgICAgICAgICRzY29wZS5yZXF1ZXN0LnBlb3BsZS5wdXNoKHBlb3BsZSk7XG4vLyAgICAgICAgIH1cbi8vICAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLnJlcXVlc3QucGVvcGxlKTtcbi8vICAgICB9O1xuLy9cbi8vICAgICAkc2NvcGUuYWRkQ2hvaWNlVG9TdXBwbHkgPSAoc3VwcGx5KSA9PiB7XG4vLyAgICAgICAgIGlmICgkc2NvcGUucmVxdWVzdC5zdXBwbHkuaW5kZXhPZihzdXBwbHkpICE9PSAtMSkge1xuLy8gICAgICAgICAgICAgJHNjb3BlLnJlcXVlc3Quc3VwcGx5LnNwbGljZSgkc2NvcGUucmVxdWVzdC5zdXBwbHkuaW5kZXhPZihzdXBwbHkpLCAxKTtcbi8vICAgICAgICAgfSBlbHNlIHtcbi8vICAgICAgICAgICAgICRzY29wZS5yZXF1ZXN0LnN1cHBseS5wdXNoKHN1cHBseSk7XG4vLyAgICAgICAgIH1cbi8vICAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLnJlcXVlc3Quc3VwcGx5KTtcbi8vICAgICB9XG4vLyAgICAgJHNjb3BlLmFkZENob2ljZVRvTW9uZXkgPSAobW9uZXkpID0+IHtcbi8vICAgICAgICAgaWYgKCRzY29wZS5yZXF1ZXN0Lm1vbmV5LmluZGV4T2YobW9uZXkpICE9PSAtMSkge1xuLy8gICAgICAgICAgICAgJHNjb3BlLnJlcXVlc3QubW9uZXkuc3BsaWNlKCRzY29wZS5yZXF1ZXN0Lm1vbmV5LmluZGV4T2YobW9uZXkpLCAxKTtcbi8vICAgICAgICAgICAgICRzY29wZS5yZXF1ZXN0Lm1vbmV5ID0gW107XG4vLyAgICAgICAgIH0gZWxzZSB7XG4vLyAgICAgICAgICAgICAkc2NvcGUucmVxdWVzdC5tb25leSA9IFtdO1xuLy8gICAgICAgICAgICAgJHNjb3BlLnJlcXVlc3QubW9uZXkucHVzaChtb25leSk7XG4vLyAgICAgICAgIH1cbi8vICAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLnJlcXVlc3QubW9uZXkpO1xuLy8gICAgIH1cbi8vICAgICAkc2NvcGUuZGVsZXRlUHJvamVjdCA9IChwcm9qZWN0RnVsbE5hbWUpID0+IHtcbi8vICAgICAgICAgaWYgKCRzY29wZS5kZWxldGVQcm9qZWN0SW5wdXQgPT0gcHJvamVjdEZ1bGxOYW1lKSB7XG4vLyAgICAgICAgICAgICBsZXQgcHJvamVjdElkID0gJHN0YXRlUGFyYW1zLnByb2plY3RJZDtcbi8vICAgICAgICAgICAgIFByb2plY3QuZGVsZXRlT25lKHByb2plY3RJZCkudGhlbihyZXMgPT4ge1xuLy8gICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdwcm9qZWN0IGRlbGV0ZWQnKTtcbi8vICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncmVzOiAnLCByZXMuZGF0YSk7XG4vLyAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdwcGFnZScsIHtcbi8vICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiAkc2NvcGUuY3VycmVudFVzZXIuX2lkXG4vLyAgICAgICAgICAgICAgICAgfSk7XG4vLyAgICAgICAgICAgICB9LCBlcnIgPT4ge1xuLy8gICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd1c2VyIGlzIG5vdCBsb2dnZWQgaW4uJyk7XG4vLyAgICAgICAgICAgICB9KVxuLy8gICAgICAgICB9IGVsc2Uge1xuLy8gICAgICAgICAgICAgY29uc29sZS5sb2coJ25vJyk7XG4vLyAgICAgICAgIH1cbi8vICAgICB9XG4vL1xuLy8gICAgICRzY29wZS5kYW5nZXJOb3RpZmllZCA9IGZhbHNlO1xuLy8gICAgICRzY29wZS5kYW5nZXJOb3RpZnR5ID0gKCkgPT4ge1xuLy8gICAgICAgICAkc2NvcGUuZGFuZ2VyTm90aWZpZWQgPSAhJHNjb3BlLmRhbmdlck5vdGlmaWVkO1xuLy8gICAgIH1cbi8vICAgICAkc2NvcGUuc2FtZVRvVGhlUHJvamVjdE5hbWUgPSAocHJvamVjdEZ1bGxOYW1lKSA9PiB7XG4vLyAgICAgICAgIHJldHVybiAkc2NvcGUuZGVsZXRlUHJvamVjdElucHV0ID09IHByb2plY3RGdWxsTmFtZTtcbi8vICAgICB9XG4vLyAgICAgJHNjb3BlLm9rYXlUb0RlbGV0ZSA9IChwcm9qZWN0RnVsbE5hbWUpID0+IHtcbi8vICAgICAgICAgY29uc29sZS5sb2coJyRzY29wZS5kYW5nZXJOb3RpZmllZDogJywgJHNjb3BlLmRhbmdlck5vdGlmaWVkKTtcbi8vICAgICAgICAgcmV0dXJuICRzY29wZS5kZWxldGVQcm9qZWN0SW5wdXQgPT0gcHJvamVjdEZ1bGxOYW1lICYmICRzY29wZS5kYW5nZXJOb3RpZmllZDtcbi8vICAgICB9XG4vLyB9XG4vL1xuLy8gZnVuY3Rpb24gcHJvamVjdHBhZ2VDdHJsKCRzY29wZSwgJGh0dHAsICRzdGF0ZVBhcmFtcywgUHJvamVjdCkge1xuLy8gICAgIGNvbnNvbGUubG9nKCdwcm9qZWN0cGFnZUN0cmwgbG9hZGVkJyk7XG4vLyAgICAgJHNjb3BlLnN0YXRlID0ge31cbi8vICAgICAkc2NvcGUuc3RhdGUuaXNBdXRob3IgPSBmYWxzZVxuLy8gICAgIHZhciBwcm9qZWN0SWQgPSAkc3RhdGVQYXJhbXMucHJvamVjdElkO1xuLy8gICAgIC8vIGNvbnNvbGUubG9nKCdwcm9qZWN0SWQ6ICcsIHByb2plY3RJZCk7XG4vLyAgICAgUHJvamVjdC5nZXRPbmVQb3JqZWN0KHByb2plY3RJZCkudGhlbihyZXMgPT4ge1xuLy8gICAgICAgICBjb25zb2xlLmxvZygncHJvamVjdERhdGE6ICcsIHJlcy5kYXRhKTtcbi8vICAgICAgICAgJHNjb3BlLnByb2plY3QgPSByZXMuZGF0YVxuLy8gICAgICAgICBjb25zb2xlLmxvZygnJHNjb3BlLmN1cnJlbnRVc2VyLl9pZDogJywgJHNjb3BlLmN1cnJlbnRVc2VyLl9pZClcbi8vICAgICAgICAgY29uc29sZS5sb2coJyRzY29wZS5wcm9qZWN0LmF1dGhvcjogJywgJHNjb3BlLnByb2plY3QuYXV0aG9yKVxuLy8gICAgICAgICB2YXIgYXV0aG9ycyA9IHJlcy5kYXRhLmF1dGhvclxuLy8gICAgICAgICBmb3IgKHZhciBhdXRob3IgaW4gYXV0aG9ycykge1xuLy8gICAgICAgICAgICAgaWYgKCRzY29wZS5jdXJyZW50VXNlci5faWQgPT0gYXV0aG9yc1thdXRob3JdLl9pZCkge1xuLy8gICAgICAgICAgICAgICAgIHJldHVybiAkc2NvcGUuc3RhdGUuaXNBdXRob3IgPSB0cnVlO1xuLy8gICAgICAgICAgICAgfVxuLy8gICAgICAgICB9XG4vLyAgICAgfSwgZXJyID0+IHtcbi8vICAgICAgICAgY29uc29sZS5sb2coJ2VyciB3aGVuIGdldCB0aGlzIHByb2plY3Q6ICcsIGVycik7XG4vLyAgICAgfSlcbi8vICAgICAkc2NvcGUubGlrZSA9IChsaWtlcklkLCBwcm9qZWN0SWQpID0+IHtcbi8vICAgICAgICAgY29uc29sZS5sb2cobGlrZXJJZCwgJ2NsaWNrcyBsaWtlQnRuIG9mJywgcHJvamVjdElkKTtcbi8vICAgICAgICAgaWYgKCRzY29wZS5zdGF0ZS5pc0F1dGhvcikge1xuLy8gICAgICAgICAgICAgY29uc29sZS5sb2coJ2xpa2VFdmVudCB0cmlnZ2VyZWQnKVxuLy8gICAgICAgICAgICAgUHJvamVjdC5saWtlKHByb2plY3RJZCwgbGlrZXJJZCkudGhlbihyZXMgPT4ge1xuLy8gICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlczogJywgcmVzKTtcbi8vICAgICAgICAgICAgICAgICAvLyAgICAgICAgIGlmIChyZXMuZGF0YS5ldmVudFR5cGUgPT0gJ2ZvbGxvdycpIHtcbi8vICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBjb25zb2xlLmxvZygnY2hlY2snKTtcbi8vICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBjb25zb2xlLmxvZygnZm9sbHdpbmc6IHJlcywgJywgcmVzLmRhdGEpXG4vLyAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgdmFyIGZvbGxvd2VyID0gcmVzLmRhdGEuZm9sbG93ZXJcbi8vICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB2YXIgZm9sbG93aW5nUmVjZWl2ZXIgPSByZXMuZGF0YS5mb2xsb3dpbmdSZWNlaXZlclxuLy8gICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICRzY29wZS51c2VyLmZvbGxvd2Vyc0xpc3QucHVzaChmb2xsb3dlcilcbi8vICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBjaGVja0ZvbGxvd1N0YXR1cygpXG4vLyAgICAgICAgICAgICAgICAgLy8gICAgICAgICB9IGVsc2UgaWYgKHJlcy5kYXRhLmV2ZW50VHlwZSA9PSAndW5mb2xsb3cnKSB7XG4vLyAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgY29uc29sZS5sb2coJ2NoZWNrJyk7XG4vLyAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgY29uc29sZS5sb2coJ3VuZm9sbHdpbmc6IHJlcywgJywgcmVzLmRhdGEpXG4vLyAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgdmFyIHVuZm9sbG93ZXIgPSByZXMuZGF0YS51bmZvbGxvd2VyXG4vLyAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgdmFyIHVuZm9sbG93aW5nUmVjZWl2ZXIgPSByZXMuZGF0YS51bmZvbGxvd2luZ1JlY2VpdmVyXG4vLyAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgdmFyIGluZGV4ID0gJHNjb3BlLnVzZXIuZm9sbG93ZXJzTGlzdC5pbmRleE9mKGZvbGxvd2VyKVxuLy8gICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICRzY29wZS51c2VyLmZvbGxvd2Vyc0xpc3Quc3BsaWNlKGluZGV4LCAxKVxuLy8gICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGNoZWNrRm9sbG93U3RhdHVzKClcbi8vICAgICAgICAgICAgICAgICAvLyAgICAgICAgIH1cbi8vICAgICAgICAgICAgIH0sIGVyciA9PiB7XG4vLyAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2VyciB3aGVuIGxpa2UvdW5saWtlOiAnLCBlcnIpXG4vLyAgICAgICAgICAgICB9KVxuLy8gICAgICAgICB9XG4vLyAgICAgfVxuLy8gfVxuLy9cbi8vIGZ1bmN0aW9uIHByb2ZpbGVTZXR0aW5nQ3RybCgkc2NvcGUsICRodHRwLCAkc3RhdGVQYXJhbXMsIEFjY291bnQsICRzdGF0ZSwgJHdpbmRvdywgVXBsb2FkLCAkbG9jYXRpb24pIHtcbi8vICAgICBjb25zb2xlLmxvZygncHJvZmlsZVNldHRpbmdDdHJsIGxvYWRlZCcpO1xuLy9cbi8vICAgICBpZiAoJHN0YXRlUGFyYW1zLnVzZXJJZCA9PSAkc2NvcGUuY3VycmVudFVzZXIuX2lkKSB7XG4vLyAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdpc0F1dGhVc2VyJyk7XG4vLyAgICAgICAgICRzY29wZS51cGRhdGVVc2VyRGF0YSA9IGFuZ3VsYXIuY29weSgkc2NvcGUuY3VycmVudFVzZXIpO1xuLy8gICAgIH0gZWxzZSB7XG4vLyAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdpcyBub3QgQXV0aFVzZXInKTtcbi8vICAgICAgICAgJHN0YXRlLmdvKCdob21lJyk7XG4vLyAgICAgfVxuLy8gICAgICRzY29wZS5pbml0ID0gKCkgPT4ge1xuLy8gICAgICAgICB2YXIgY2hlY2tVcmwgPSAkbG9jYXRpb24uJCRwYXRoLmluY2x1ZGVzKCdkYW5nZXInKSB8fCAkbG9jYXRpb24uJCRwYXRoLmluY2x1ZGVzKCdyZXF1ZXN0JykgfHwgJGxvY2F0aW9uLiQkcGF0aC5pbmNsdWRlcygncHJpdmFjeScpXG4vLyAgICAgICAgIGlmICghY2hlY2tVcmwpIHtcbi8vICAgICAgICAgICAgICRzdGF0ZS5nbygncHJvZmlsZVNldHRpbmdfZ2VuZXJhbCcpO1xuLy8gICAgICAgICB9XG4vLyAgICAgfTtcbi8vXG4vLyAgICAgJHNjb3BlLnVwZGF0ZVVzZXJEYXRhU3VibWl0dGVkID0gKCkgPT4ge1xuLy8gICAgICAgICB2YXIgdXJpVXNlcklkID0gJHNjb3BlLnVwZGF0ZVVzZXJEYXRhLl9pZDtcbi8vICAgICAgICAgdmFyIHVwZGF0ZVVzZXJEYXRhID0gJHNjb3BlLnVwZGF0ZVVzZXJEYXRhO1xuLy8gICAgICAgICBBY2NvdW50LnVwZGF0ZVVzZXJEYXRhKHVyaVVzZXJJZCwgdXBkYXRlVXNlckRhdGEpLnRoZW4ocmVzID0+IHtcbi8vICAgICAgICAgICAgICRzY29wZS51cGRhdGVVc2VyRGF0YSA9IHJlcy5kYXRhO1xuLy8gICAgICAgICAgICAgJHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbi8vICAgICAgICAgfSwgZXJyID0+IHtcbi8vICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnIgd2hlbiBnZXQgdXBkYXRlIHVzZXIgZGF0YTogJywgZXJyKTtcbi8vICAgICAgICAgfSlcbi8vICAgICB9XG4vLyAgICAgJHNjb3BlLnBob3RvVXBsb2FkaW5nID0gZmFsc2Vcbi8vICAgICAkc2NvcGUudXBsb2FkRmlsZXMgPSAoZmlsZSkgPT4ge1xuLy8gICAgICAgICAkc2NvcGUucGhvdG9VcGxvYWRpbmcgPSB0cnVlO1xuLy8gICAgICAgICB2YXIgZmlsZSA9IGZpbGVbMF1cbi8vICAgICAgICAgdmFyIHVzZXJJZCA9ICRzY29wZS5jdXJyZW50VXNlci5faWQ7XG4vLyAgICAgICAgIGNvbnNvbGUubG9nKCdwaG90bzogJywgZmlsZSk7XG4vLyAgICAgICAgIGlmIChmaWxlKSB7XG4vLyAgICAgICAgICAgICBVcGxvYWQudXBsb2FkKHtcbi8vICAgICAgICAgICAgICAgICB1cmw6IGAvYXBpL3VwbG9hZC8ke3VzZXJJZH1gLFxuLy8gICAgICAgICAgICAgICAgIGRhdGE6IHtcbi8vICAgICAgICAgICAgICAgICAgICAgbmV3RmlsZTogZmlsZVxuLy8gICAgICAgICAgICAgICAgIH1cbi8vICAgICAgICAgICAgIH0pLnRoZW4ocmVzID0+IHtcbi8vICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncmVzIGFmdGVyIHVwbG9hZDogJywgcmVzLmRhdGEpO1xuLy8gICAgICAgICAgICAgICAgICR3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4vLyAgICAgICAgICAgICB9LCBlcnIgPT4ge1xuLy8gICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnIgd2hlbiB1cGxvYWQgZmlsZTogJywgZXJyKTtcbi8vICAgICAgICAgICAgIH0pXG4vLyAgICAgICAgIH1cbi8vICAgICB9XG4vL1xuLy8gfVxuLy9cbi8vIGZ1bmN0aW9uIHBwYWdlQ3RybCgkc2NvcGUsICRzdGF0ZSwgJHJvb3RTY29wZSwgJHN0YXRlUGFyYW1zLCBQcm9qZWN0LCBBY2NvdW50LCAkdGltZW91dCwgJGxvY2F0aW9uKSB7XG4vLyAgICAgY29uc29sZS5sb2coJ3BwYWdlQ3RybCBsb2FkZWQnKVxuLy8gICAgICRzY29wZS5zdGF0ZSA9IHt9XG4vLyAgICAgJHNjb3BlLnN0YXRlLmlzVGhlVXNlciA9IGZhbHNlXG4vLyAgICAgJHNjb3BlLnN0YXRlLmZvbGxvd1N0YXR1cyA9IGZhbHNlXG4vLyAgICAgdmFyIGRpc3BsYXlVc2VyO1xuLy8gICAgIHZhciB1cmlVc2VySWQgPSAkc3RhdGVQYXJhbXMudXNlcklkO1xuLy8gICAgIGlmICh1cmlVc2VySWQgPT0gJHNjb3BlLmN1cnJlbnRVc2VyLl9pZCkge1xuLy8gICAgICAgICAkc2NvcGUuc3RhdGUuaXNUaGVVc2VyID0gdHJ1ZTtcbi8vICAgICB9XG4vLyAgICAgaWYgKCRzY29wZS5zdGF0ZS5pc1RoZVVzZXIpIHtcbi8vICAgICAgICAgY29uc29sZS5sb2coJ2lzVGhlVXNlcicpXG4vLyAgICAgfSBlbHNlIHtcbi8vICAgICAgICAgY29uc29sZS5sb2coJ2lzIG5vdCBUaGVVc2VyJylcbi8vICAgICB9XG4vLyAgICAgJHNjb3BlLmluaXQgPSAoKSA9PiB7XG4vLyAgICAgICAgIGNoZWNraW5nVXJsKClcbi8vICAgICB9XG4vL1xuLy8gICAgIGZ1bmN0aW9uIGNoZWNraW5nVXJsKCkge1xuLy8gICAgICAgICB2YXIgY2hlY2tVcmwgPSAkbG9jYXRpb24uJCRwYXRoLmluY2x1ZGVzKCdzdGFycmVkJykgfHwgJGxvY2F0aW9uLiQkcGF0aC5pbmNsdWRlcygnZm9sbG93ZXJzJylcbi8vICAgICAgICAgaWYgKCFjaGVja1VybCkge1xuLy8gICAgICAgICAgICAgJHN0YXRlLmdvKCdwcGFnZV9wcm9qZWN0cycpO1xuLy8gICAgICAgICB9XG4vLyAgICAgfVxuLy8gICAgIEFjY291bnQuZ2V0VXNlckRhdGEodXJpVXNlcklkKS50aGVuKHJlcyA9PiB7XG4vLyAgICAgICAgICRzY29wZS51c2VyID0gcmVzLmRhdGFcbi8vICAgICAgICAgZGlzcGxheVVzZXIgPSByZXMuZGF0YVxuLy8gICAgICAgICAkc2NvcGUucHJvamVjdHMgPSByZXMuZGF0YS5wcm9qZWN0cy5yZXZlcnNlKCk7XG4vLyAgICAgICAgIGNvbnNvbGUubG9nKCdjYXJkcyBoZXJlOiAnLCByZXMuZGF0YS5wcm9qZWN0cyk7XG4vLyAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuLy8gICAgICAgICAgICAgY2hlY2tGb2xsb3dTdGF0dXMoKVxuLy8gICAgICAgICB9LCAwKVxuLy8gICAgIH0sIGVyciA9PiB7XG4vLyAgICAgICAgIGNvbnNvbGUubG9nKCdlcnIgd2hlbiBnZXQgdXNlckRhdGE6ICcsIGVycik7XG4vLyAgICAgfSlcbi8vXG4vLyAgICAgJHNjb3BlLmNyZWF0ZVRpbWUgPSAoY3JlYXRlQXRUaW1lKSA9PiB7XG4vLyAgICAgICAgIHJldHVybiBtb21lbnQoY3JlYXRlQXRUaW1lKS5mcm9tTm93KCk7XG4vLyAgICAgfVxuLy9cbi8vICAgICAkc2NvcGUuZm9sbG93ID0gKGN1cnJlbnRVc2VyLCBmb2xsb3dUYXJnZXQpID0+IHtcbi8vICAgICAgICAgY29uc29sZS5sb2coJ2ZmZmZmZicpO1xuLy8gICAgICAgICBjb25zb2xlLmxvZyhjdXJyZW50VXNlciwgZm9sbG93VGFyZ2V0KTtcbi8vICAgICAgICAgaWYgKGN1cnJlbnRVc2VyICE9PSBmb2xsb3dUYXJnZXQgJiYgZm9sbG93VGFyZ2V0ID09IHVyaVVzZXJJZCkge1xuLy8gICAgICAgICAgICAgY29uc29sZS5sb2coJ2ZvbGxvd0V2ZW50IHRyaWdnZXJlZCcpXG4vLyAgICAgICAgICAgICBBY2NvdW50LmZvbGxvdyhjdXJyZW50VXNlciwgZm9sbG93VGFyZ2V0KS50aGVuKHJlcyA9PiB7XG4vLyAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlczogJywgcmVzKTtcbi8vICAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEuZXZlbnRUeXBlID09ICdmb2xsb3cnKSB7XG4vLyAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjaGVjaycpO1xuLy8gICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZm9sbHdpbmc6IHJlcywgJywgcmVzLmRhdGEpXG4vLyAgICAgICAgICAgICAgICAgICAgIHZhciBmb2xsb3dlciA9IHJlcy5kYXRhLmZvbGxvd2VyXG4vLyAgICAgICAgICAgICAgICAgICAgIHZhciBmb2xsb3dpbmdSZWNlaXZlciA9IHJlcy5kYXRhLmZvbGxvd2luZ1JlY2VpdmVyXG4vLyAgICAgICAgICAgICAgICAgICAgICRzY29wZS51c2VyLmZvbGxvd2Vyc0xpc3QucHVzaChmb2xsb3dlcilcbi8vICAgICAgICAgICAgICAgICAgICAgY2hlY2tGb2xsb3dTdGF0dXMoKVxuLy8gICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzLmRhdGEuZXZlbnRUeXBlID09ICd1bmZvbGxvdycpIHtcbi8vICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2NoZWNrJyk7XG4vLyAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd1bmZvbGx3aW5nOiByZXMsICcsIHJlcy5kYXRhKVxuLy8gICAgICAgICAgICAgICAgICAgICB2YXIgdW5mb2xsb3dlciA9IHJlcy5kYXRhLnVuZm9sbG93ZXJcbi8vICAgICAgICAgICAgICAgICAgICAgdmFyIHVuZm9sbG93aW5nUmVjZWl2ZXIgPSByZXMuZGF0YS51bmZvbGxvd2luZ1JlY2VpdmVyXG4vLyAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRleCA9ICRzY29wZS51c2VyLmZvbGxvd2Vyc0xpc3QuaW5kZXhPZihmb2xsb3dlcilcbi8vICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnVzZXIuZm9sbG93ZXJzTGlzdC5zcGxpY2UoaW5kZXgsIDEpXG4vLyAgICAgICAgICAgICAgICAgICAgIGNoZWNrRm9sbG93U3RhdHVzKClcbi8vICAgICAgICAgICAgICAgICB9XG4vLyAgICAgICAgICAgICB9LCBlcnIgPT4ge1xuLy8gICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnIgd2hlbiBmb2xsb3cvdW5mb2xsb3c6ICcsIGVycilcbi8vICAgICAgICAgICAgIH0pXG4vLyAgICAgICAgIH1cbi8vICAgICB9XG4vLyAgICAgdmFyIGNoZWNrRm9sbG93U3RhdHVzID0gKCkgPT4ge1xuLy8gICAgICAgICAgICAgY29uc29sZS5sb2coJ2NoZWNrRm9sbG93U3RhdHVzIHRyaWdlcnJlZCcpO1xuLy8gICAgICAgICAgICAgY29uc29sZS5sb2coJ2Rpc3BsYXlVc2VyOiAnLCBkaXNwbGF5VXNlcik7XG4vLyAgICAgICAgICAgICBpZiAoZGlzcGxheVVzZXIuZm9sbG93ZXJzTGlzdC5sZW5ndGggPiAwKSB7XG4vLyAgICAgICAgICAgICAgICAgdmFyIGZvbGxvd2Vyc0xpc3QgPSBkaXNwbGF5VXNlci5mb2xsb3dlcnNMaXN0XG4vLyAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2NoZWNrZWQnKTtcbi8vICAgICAgICAgICAgICAgICBmb3IgKHZhciBmb2xsb3dlciBpbiBmb2xsb3dlcnNMaXN0KSB7XG4vLyAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjdXJyZW50VXNlcjogJywgJHNjb3BlLmN1cnJlbnRVc2VyLl9pZCk7XG4vLyAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdmb2xsb3dlcnNMaXN0W2ZvbGxvd2VyXS5faWQ6ICcsIGZvbGxvd2Vyc0xpc3RbZm9sbG93ZXJdLl9pZCk7XG4vLyAgICAgICAgICAgICAgICAgICAgIGlmIChmb2xsb3dlcnNMaXN0W2ZvbGxvd2VyXS5faWQgPT0gJHNjb3BlLmN1cnJlbnRVc2VyLl9pZCkge1xuLy8gICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN0YXRlLmZvbGxvd1N0YXR1cyA9IHRydWVcbi8vICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbi8vICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zdGF0ZS5mb2xsb3dTdGF0dXMgPSBmYWxzZVxuLy8gICAgICAgICAgICAgICAgICAgICB9XG4vLyAgICAgICAgICAgICAgICAgfVxuLy8gICAgICAgICAgICAgfSBlbHNlIHtcbi8vICAgICAgICAgICAgICAgICAkc2NvcGUuc3RhdGUuZm9sbG93U3RhdHVzID0gZmFsc2Vcbi8vICAgICAgICAgICAgIH1cbi8vICAgICAgICAgfVxuLy8gICAgICAgICAvLyBjaGVja0ZvbGxvd1N0YXR1cygpXG4vLyB9XG4vL1xuLy8gZnVuY3Rpb24gbmF2Q3RybCgkaHR0cCwgJHNjb3BlLCAkYXV0aCwgQWNjb3VudCwgJHJvb3RTY29wZSwgJHRpbWVvdXQsICR3aW5kb3csICRzdGF0ZSwgZm9jdXMsIFByb2plY3QsICRsb2NhdGlvbikge1xuLy8gICAgIC8vIGNvbnNvbGUubG9nKCduYXZDdHJsIGxvYWRlZCcpO1xuLy8gICAgICRzY29wZS5jdXJyZW50VXNlciA9ICcnO1xuLy8gICAgICRzY29wZS5sb2dpbmxvYWRpbmcgPSBmYWxzZTtcbi8vICAgICAkc2NvcGUubG9nb3V0bG9hZGluZyA9IGZhbHNlO1xuLy8gICAgICRyb290U2NvcGUuaGlkZU5hdiA9IGZhbHNlO1xuLy8gICAgICRyb290U2NvcGUuY3JlYXRlTW9kYWwgPSBmYWxzZTtcbi8vXG4vLyAgICAgJHNjb3BlLmF1dGhlbnRpY2F0ZSA9IChwcm92aWRlcikgPT4ge1xuLy8gICAgICAgICAgICAgJHNjb3BlLmxvZ2lubG9hZGluZyA9IHRydWU7XG4vLyAgICAgICAgICAgICAkYXV0aC5hdXRoZW50aWNhdGUocHJvdmlkZXIpLnRoZW4oZGF0YSA9PiB7XG4vLyAgICAgICAgICAgICAgICAgQWNjb3VudC5nZXRDdXJyZW50VXNlcigpLnRoZW4ocmVzID0+IHtcbi8vICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3VzZXIgbG9nZ2VkIGluOiAnLCByZXMuZGF0YSk7XG4vLyAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jdXJyZW50VXNlciA9IHJlcy5kYXRhO1xuLy8gICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9naW5sb2FkaW5nID0gZmFsc2U7XG4vLyAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCckc2NvcGUuY3VycmVudFVzZXIuX2lkOiAnLCAkc2NvcGUuY3VycmVudFVzZXIuX2lkKTtcbi8vICAgICAgICAgICAgICAgICAgICAgaWYgKCRzdGF0ZS5jdXJyZW50Lm5hbWUgPT0gJ2hvbWUnKSB7XG4vLyAgICAgICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ3BwYWdlJywge1xuLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogJHNjb3BlLmN1cnJlbnRVc2VyLl9pZFxuLy8gICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4vLyAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4vLyAgICAgICAgICAgICAgICAgICAgICAgICAkd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuLy8gICAgICAgICAgICAgICAgICAgICB9XG4vLyAgICAgICAgICAgICAgICAgfSwgZXJyID0+IHtcbi8vICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3VzZXIgaXMgbm90IGxvZ2dlZCBpbi4nKTtcbi8vICAgICAgICAgICAgICAgICB9KVxuLy8gICAgICAgICAgICAgfSwgZXJyID0+IHtcbi8vICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZXJyIHdoZW4gbG9nIHVzZXIgaW46ICcsIGVycik7XG4vLyAgICAgICAgICAgICB9KVxuLy8gICAgICAgICB9XG4vLyAgICAgICAgIC8vIGNvbnNvbGUubG9nKCckYXV0aC5pc0F1dGhlbnRpY2F0ZWQoKSk6ICcsICRhdXRoLmlzQXV0aGVudGljYXRlZCgpKSk7XG4vLyAgICAgaWYgKCRhdXRoLmlzQXV0aGVudGljYXRlZCgpKSB7XG4vLyAgICAgICAgIEFjY291bnQuZ2V0Q3VycmVudFVzZXIoKS50aGVuKHJlcyA9PiB7XG4vLyAgICAgICAgICAgICAkc2NvcGUuY3VycmVudFVzZXIgPSByZXMuZGF0YTtcbi8vICAgICAgICAgICAgIGNvbnNvbGUubG9nKCduYXZDdHJsIHRyaWdnZXJlZCBhbmQgY3VycmVudFVzZXI6ICcsICRzY29wZS5jdXJyZW50VXNlcik7XG4vLyAgICAgICAgIH0sIGVyciA9PiB7XG4vLyAgICAgICAgICAgICBjb25zb2xlLmxvZygndXNlciBpcyBub3QgbG9nZ2VkIGluLicpO1xuLy8gICAgICAgICB9KVxuLy8gICAgIH1cbi8vXG4vLyAgICAgJHNjb3BlLmlzQXV0aGVudGljYXRlZCA9ICgpID0+IHtcbi8vICAgICAgICAgcmV0dXJuICRhdXRoLmlzQXV0aGVudGljYXRlZCgpO1xuLy8gICAgIH1cbi8vXG4vLyAgICAgJHNjb3BlLmxvZ291dCA9ICgpID0+IHtcbi8vICAgICAgICAgJHNjb3BlLmxvZ291dGxvYWRpbmcgPSB0cnVlO1xuLy8gICAgICAgICAkYXV0aC5sb2dvdXQoKTtcbi8vICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4vLyAgICAgICAgICAgICAkc2NvcGUubG9nb3V0bG9hZGluZyA9IGZhbHNlO1xuLy8gICAgICAgICAgICAgLy8gJHN0YXRlLmdvKCdob21lJyk7XG4vLyAgICAgICAgICAgICAkd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuLy8gICAgICAgICB9LCAwKVxuLy8gICAgIH1cbi8vXG4vLyAgICAgJHNjb3BlLmdvcHBhZ2UgPSAoKSA9PiB7XG4vLyAgICAgICAgIGNvbnNvbGUubG9nKCckbG9jYXRpb24uJCRwYXRoOiAnLCAkbG9jYXRpb24uJCRwYXRoKTtcbi8vICAgICAgICAgaWYgKCRsb2NhdGlvbi4kJHBhdGguaW5jbHVkZXMoJ3Byb2plY3RzJykpIHtcbi8vICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdzdGF5IG9uIHRoZSBwYWdlLCBvciByZWZyZXNoIHRoZSBwYWdlJylcbi8vICAgICAgICAgICAgICR3aW5kb3cubG9jYXRpb24ucmVsb2FkKClcbi8vICAgICAgICAgfSBlbHNlIHtcbi8vICAgICAgICAgICAgICRzdGF0ZS5nbygncHBhZ2UnLCB7XG4vLyAgICAgICAgICAgICAgICAgdXNlcklkOiAkc2NvcGUuY3VycmVudFVzZXIuX2lkXG4vLyAgICAgICAgICAgICB9KVxuLy8gICAgICAgICB9XG4vLyAgICAgfVxuLy9cbi8vICAgICAkc2NvcGUuY3JlYXRlID0gKCkgPT4ge1xuLy8gICAgICAgICAkc2NvcGUucHJvamVjdEluaXRhbGl6aW5nID0gZmFsc2U7XG4vLyAgICAgICAgICRzY29wZS5uZXdQcm9qZWN0TmFtZSA9ICcnO1xuLy8gICAgICAgICAkc2NvcGUubmV3UHJvamVjdFBpdGNoID0gJyc7XG4vLyAgICAgICAgICRzY29wZS5jcmVhdGVNb2RhbCA9IHRydWU7XG4vLyAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuLy8gICAgICAgICAgICAgZm9jdXMoJ2ZvY3VzTWUnKTtcbi8vICAgICAgICAgfSwgMTAwKVxuLy8gICAgIH1cbi8vICAgICAkc2NvcGUuY3JlYXRlUHJvamVjdCA9ICgpID0+IHtcbi8vICAgICAgICAgJHNjb3BlLnByb2plY3RJbml0YWxpemluZyA9IHRydWU7XG4vLyAgICAgICAgIGNvbnNvbGUubG9nKCdjcmVhdGUgcHJvamVjdCBjYWxsZWQ6ICcsICRzY29wZS5uZXdQcm9qZWN0TmFtZSk7XG4vLyAgICAgICAgIHZhciBuZXdQb2plY3RPYmogPSB7XG4vLyAgICAgICAgICAgICB0aXRsZTogJHNjb3BlLm5ld1Byb2plY3ROYW1lLFxuLy8gICAgICAgICAgICAgcGl0Y2g6ICRzY29wZS5uZXdQcm9qZWN0UGl0Y2hcbi8vICAgICAgICAgfVxuLy8gICAgICAgICBQcm9qZWN0LmNyZWF0ZU9uZShuZXdQb2plY3RPYmopLnRoZW4ocmVzID0+IHtcbi8vICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdhZGQgbmV3IGJlaGF2aW9yW2NyZWF0ZU5ld1Byb2plY3RdOiAnLCByZXMuZGF0YSk7XG4vLyAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcbi8vICAgICAgICAgICAgICAgICAkc2NvcGUucHJvamVjdEluaXRhbGl6aW5nID0gZmFsc2U7XG4vLyAgICAgICAgICAgICAgICAgJHNjb3BlLmNyZWF0ZU1vZGFsID0gZmFsc2U7XG4vLyAgICAgICAgICAgICAgICAgaWYgKCRzdGF0ZS5jdXJyZW50Lm5hbWUgPT0gJ3BwYWdlJykge1xuLy8gICAgICAgICAgICAgICAgICAgICAkd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuLy8gICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4vLyAgICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygncHBhZ2UnLCB7XG4vLyAgICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6ICRzY29wZS5jdXJyZW50VXNlci5faWRcbi8vICAgICAgICAgICAgICAgICAgICAgfSk7XG4vLyAgICAgICAgICAgICAgICAgfVxuLy8gICAgICAgICAgICAgfSwgTWF0aC5yYW5kb20oKSAqIDE1MDAgKyAzMDApO1xuLy8gICAgICAgICB9LCBlcnIgPT4ge1xuLy8gICAgICAgICAgICAgY29uc29sZS5sb2coJ2VyciB3aGVuIGNyZWF0ZSBwcm9qZWN0OiAnLCBlcnIpO1xuLy8gICAgICAgICB9KVxuLy8gICAgIH1cbi8vIH1cbiIsIid1c2Ugc3RyaWN0JztcblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ3BpbmNoQXBwJylcbiAgICAuZGlyZWN0aXZlKCdmb2N1c09uJywgZm9jdXNPbilcblxuZnVuY3Rpb24gZm9jdXNPbigpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGVsZW0sIGF0dHIpIHtcbiAgICAgICAgc2NvcGUuJG9uKCdmb2N1c09uJywgZnVuY3Rpb24oZSwgbmFtZSkge1xuICAgICAgICAgICAgaWYgKG5hbWUgPT09IGF0dHIuZm9jdXNPbikge1xuICAgICAgICAgICAgICAgIGVsZW1bMF0uZm9jdXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbn1cbiIsIid1c2Ugc3RyaWN0JztcblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ3BpbmNoQXBwJylcbiAgICAuZGlyZWN0aXZlKCd0b29sVGlwJywgdG9vbFRpcClcblxuZnVuY3Rpb24gdG9vbFRpcCgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudCgnLnRvb2wtdGlwJykub24oJ2NsaWNrIG1vdXNlbGVhdmUnLCBoaWRlVG9vbHRpcCk7XG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudCgnLnRvb2wtdGlwJykub24oJ21vdXNlZW50ZXInLCBzaG93VG9vbHRpcCk7XG4gICAgfTtcbn1cblxuZnVuY3Rpb24gaGlkZVRvb2x0aXAoKSB7XG4gICAgJCh0aGlzKS50b29sdGlwKCdoaWRlJyk7XG59XG5cbmZ1bmN0aW9uIHNob3dUb29sdGlwKCkge1xuICAgICQodGhpcykudG9vbHRpcCgnc2hvdycpO1xufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
