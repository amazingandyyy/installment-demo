"use strict";function init(){sticky(),windowScrollDown()}function sticky(){$(".singlePlanPreviewSticky").sticky({topSpacing:80})}function windowScrollDown(){var e,a=0;$(window).scroll(function(){e=$(this).scrollTop(),$(window).scrollTop()>30&&(a>e?($(".home-page nav").removeClass("folded"),$(".home-page nav").css("border-bottom","0px solid")):$(".home-page nav").addClass("folded")),a=e,$(window).scrollTop()<10&&$(".home-page nav").addClass("top"),$(window).scrollTop()>10&&$(".home-page nav").removeClass("top"),$(window).scrollTop()>30,$(window).scrollTop()<540&&$(".home-page nav").css("box-shadow","inset 0 -1px 0px 0px rgba(0,0,0,0)"),$(window).scrollTop()>540&&$(".home-page nav").css("box-shadow","inset 0 -1px 0px 0px rgba(0,0,0,0.1)")})}function Account(e){this.getCurrentUser=function(){return e({method:"GET",url:"/api/auth/currentUser"})},this.sendVerifyCode=function(a){return e({method:"POST",url:"/api/verify/phone",data:a})},this.verifyCode=function(a){return e({method:"PUT",url:"/api/verify/phone",data:a})},this.getUserData=function(a){return e({method:"GET",url:"/api/users/"+a})},this.updateUserData=function(a,n){return e({method:"PUT",url:"/api/users/"+a,data:n})}}function Payment(e){this.chargeNow=function(a){return e({method:"POST",url:"/api/payment/chargeNow",data:a})}}function focus(e,a){return function(n){a(function(){e.$broadcast("focusOn",n)},0)}}function Plan(e,a,n){this.addSinglePreview=function(a){return e(function(e,n){localStorage.planPreviewData=JSON.stringify(a),e(localStorage.planPreviewData)})},this.getSinglePreview=function(){return e(function(e,a){e(JSON.parse(localStorage.planPreviewData))})},this.saveSinglePlan=function(e){return n({method:"POST",url:"/api/plans/saveSinglePlan",data:e})},this.getSinglePlan=function(e){return n({method:"GET",url:"/api/plans/getSinglePlan/"+e})}}function Storage(e){this.get=function(){},this.save=function(e){console.log("obj: ",e)}}function focusOn(){return function(e,a,n){e.$on("focusOn",function(e,t){t===n.focusOn&&a[0].focus()})}}function toolTip(){return function(e,a,n){angular.element(".tool-tip").on("click mouseleave",hideTooltip),angular.element(".tool-tip").on("mouseenter",showTooltip)}}function hideTooltip(){$(this).tooltip("hide")}function showTooltip(){$(this).tooltip("show")}function homeCtrl(e,a,n,t,o,r,l){function s(){a.getToken()?t.getCurrentUser(a.getToken()).then(function(e){console.log("@CurrentUser: ",e.data),r.currentUser=e.data},function(e){return n.go("authEntrance")}):!a.getToken()&&l.$$path.includes("dashboard")&&n.go("authEntrance")}r.$on("$stateChangeSuccess",function(a,t,o,i,d){r.previousState=i.name,r.currentState=t.name,console.log(r.previousState," >>> ",r.currentState),"authEntrance"==r.currentState&&e.currentUser&&n.go("dashboard"),e.currentUrl=l.$$path,s()})}function authCtrl(e,a,n,t,o,r){e.auth_enter=function(e){a.signup(e).then(function(e){a.setToken(e),n.go("dashboard",{},{reload:!0}),console.log("res @auth_enter: ",e.data)},function(e){return console.log("err @auth_enter: ",e)})},e.authenticate=function(e){a.authenticate(e)}}function dashboardCtrl(e,a,n,t,o,r,l){e.logout=function(){console.log("check"),a.logout(),e.currentUser=null,n.go("landing",{},{reload:!0}),l.location.reload()},e.sendVerifyCode=function(a){if(console.log("phone: ",a),a.length>5){var n={userData:o.currentUser,phone:a};console.log("userObj: ",n),t.sendVerifyCode(n).then(function(n){console.log("res @sendVerifyCode: ",n.data),o.currentUser.phone.data=a,e.verifyPhoneSentOut=!0},function(e){console.log("err @sendVerifyCode: ",e)})}},e.verifyCode=function(e){if(console.log("code: ",e),0!==e.length){var a={userData:o.currentUser,code:e};t.verifyCode(a).then(function(e){console.log("res @verifyCode: ",e.data),e.data.msg?"incorrect"==e.data.msg?console.log("err: incorrect"):(e.data.msg="expired")&&console.log("err: expired"):o.currentUser.phone.verified=!0},function(e){console.log("err @verifyCode: ",e)})}},e.doCheckout=function(e){console.log("fff"),console.log("token: ",e);var a={stripeToken:e,userData:o.currentUser};r.chargeNow(a).then(function(e){console.log("res: ",e.data)},function(e){console.log("err: ",e)})}}function dashboardPlanCtrl(e,a,n,t,o,r){console.log("dashboardPlanCtrl loaded"),"dashboard_plan_single"==r.currentState&&(e.updateTimes=function(a){e.installmentsGraphData=[];for(var n=0;a>n;n++){var t=~~(e.plan.total/a),o=~~(200*(2/a));e.installmentsGraphData.push({price:t,style:{height:o+"px",width:"90%"}})}},e.defaultPlanTimes=function(a){return a?e.plan:e.plan.times=3},e.previewSinglePlan=function(e){console.log("plan: ",e),o.addSinglePreview(e).then(function(e){t.go("dashboard_plan_single_preview")},function(e){return console.log("err @addSinglePreview: ",e)})},e.plan={},e.singlePayment=function(){return(e.plan.total-e.plan.downpay)/e.plan.times},e.intervalSelected=function(a){e.plan.interval==a?e.plan.interval=null:e.plan.interval=a},"dashboard_plan_single_preview"==r.previousState&&o.getSinglePreview().then(function(a){console.log("res @getSinglePreview data back: ",a),e.plan=a,e.plan.times=a.times},function(e){return console.log("err @getSinglePreview: ",e)})),"dashboard_plan_single_preview"==r.currentState&&(o.getSinglePreview().then(function(a){console.log("res @getSinglePreview: ",a),e.planPreview=a,e.planPreview.installment=(a.total-a.downpay)/a.times},function(e){return console.log("err @getSinglePreview: ",e)}),e.saveSinglePlan=function(e){var a={planDetails:e,creator:r.currentUser};console.log("saveSinglePlanInfo: ",a),o.saveSinglePlan(a).then(function(e){console.log("res @saveSinglePlan: ",e.data),t.go("dashboard_plan_start",{},{reload:!0})},function(e){return console.log("err @saveSinglePlan: ",e)})}),e.getAllPlans=function(){var e=r.currentUser._id;console.log("currentUserId: ",e)},"dashboard_plan_details"==r.currentState&&o.getSinglePlan(t.params.planId).then(function(a){console.log("res @getSinglePlan: ",a.data.data),e.plan=a.data.data},function(e){return console.log("err @saveSinglePlan: ",e)})}angular.module("pinchApp",["ui.router","satellizer","ngAnimate","ngFileUpload","ngImgCrop","stripe.checkout","angular-loading-bar","anim-in-out"]).config(["$stateProvider","$urlRouterProvider","$authProvider",function(e,a,n){Stripe.setPublishableKey("pk_test_t1eThhOKl6esrp6f4jyWqU4J"),e.state(landing).state(authEntrance).state(dashboard).state(dashboard_payment).state(dashboard_plan).state(dashboard_plan_start).state(dashboard_plan_details).state(dashboard_plan_choose).state(dashboard_plan_single).state(dashboard_plan_single_preview).state(dashboard_plan_multiple).state(dashboard_account),a.otherwise("/")}]);var landing={name:"landing",url:"/",views:{main:{templateUrl:"/html/landing.html",controller:"authCtrl"}}},authEntrance={name:"authEntrance",url:"/entrance",views:{main:{templateUrl:"/html/entrance.html",controller:"authCtrl"}}},dashboard={name:"dashboard",url:"/dashboard",views:{main:{templateUrl:"/html/dashboard.html",controller:"dashboardCtrl"}}},dashboard_payment={name:"dashboard_payment",url:"/payment",parent:"dashboard",views:{dashboard_section:{templateUrl:"/html/dashboard_payment.html",controller:"dashboardCtrl"}}},dashboard_plan={name:"dashboard_plan",url:"/plan",parent:"dashboard",views:{dashboard_section:{templateUrl:"/html/dashboard_plan.html",controller:"dashboardCtrl"}}},dashboard_plan_start={name:"dashboard_plan_start",url:"/start",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_start.html",controller:"dashboardCtrl"}}},dashboard_plan_details={name:"dashboard_plan_details",url:"/:planId",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_details.html",controller:"dashboardPlanCtrl"}}},dashboard_plan_choose={name:"dashboard_plan_choose",url:"/choose",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_choose.html",controller:"dashboardCtrl"}}},dashboard_plan_single={name:"dashboard_plan_single",url:"/choose/single",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_single.html",controller:"dashboardPlanCtrl"}}},dashboard_plan_single_preview={name:"dashboard_plan_single_preview",url:"/choose/single/preview",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_single_preview.html",controller:"dashboardPlanCtrl"}}},dashboard_plan_multiple={name:"dashboard_plan_multiple",url:"/choose/mutiple",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_multiple.html",controller:"dashboardCtrl"}}},dashboard_account={name:"dashboard_account",url:"/account",parent:"dashboard",views:{dashboard_section:{templateUrl:"/html/dashboard_account.html",controller:"dashboardCtrl"}}};$(document).ready(init),Account.$inject=["$http"],Payment.$inject=["$http"],focus.$inject=["$rootScope","$timeout"],Plan.$inject=["$q","Storage","$http"],Storage.$inject=["$q"],angular.module("pinchApp").service("Account",Account).service("Payment",Payment).factory("focus",focus).service("Plan",Plan).service("Storage",Storage),angular.module("pinchApp").directive("focusOn",focusOn),angular.module("pinchApp").directive("toolTip",toolTip),homeCtrl.$inject=["$scope","$auth","$state","Account","$window","$rootScope","$location"],authCtrl.$inject=["$scope","$auth","$state","Account","$window","$rootScope"],dashboardCtrl.$inject=["$scope","$auth","$state","Account","$rootScope","Payment","$window"],dashboardPlanCtrl.$inject=["$scope","Account","$stateParams","$state","Plan","$rootScope"],angular.module("pinchApp").controller("homeCtrl",homeCtrl).controller("authCtrl",authCtrl).controller("dashboardCtrl",dashboardCtrl).controller("dashboardPlanCtrl",dashboardPlanCtrl);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFtb2R1bGUuanMiLCJtYWluLmpzIiwic2VydmljZXMuanMiLCJkaXJlY3RpdmVzL2ZvY3VzT24uZGlyZWN0aXZlLmpzIiwiZGlyZWN0aXZlcy90b29sVGlwLmRpcmVjdGl2ZS5qcyIsImNvbnRyb2xsZXJzL2NvbnRyb2xsZXJzLmpzIl0sIm5hbWVzIjpbImluaXQiLCJzdGlja3kiLCJ3aW5kb3dTY3JvbGxEb3duIiwiJCIsInRvcFNwYWNpbmciLCJzdCIsImxhc3RTY3JvbGxUb3AiLCJ3aW5kb3ciLCJzY3JvbGwiLCJ0aGlzIiwic2Nyb2xsVG9wIiwicmVtb3ZlQ2xhc3MiLCJjc3MiLCJhZGRDbGFzcyIsIkFjY291bnQiLCIkaHR0cCIsImdldEN1cnJlbnRVc2VyIiwibWV0aG9kIiwidXJsIiwic2VuZFZlcmlmeUNvZGUiLCJ1c2VyT2JqIiwiZGF0YSIsInZlcmlmeUNvZGUiLCJnZXRVc2VyRGF0YSIsInVyaVVzZXJJZCIsInVwZGF0ZVVzZXJEYXRhIiwiUGF5bWVudCIsImNoYXJnZU5vdyIsImRhdGFPYmoiLCJmb2N1cyIsIiRyb290U2NvcGUiLCIkdGltZW91dCIsIm5hbWUiLCIkYnJvYWRjYXN0IiwiUGxhbiIsIiRxIiwiU3RvcmFnZSIsImFkZFNpbmdsZVByZXZpZXciLCJwbGFuIiwicmVzIiwicmVxIiwibG9jYWxTdG9yYWdlIiwicGxhblByZXZpZXdEYXRhIiwiSlNPTiIsInN0cmluZ2lmeSIsImdldFNpbmdsZVByZXZpZXciLCJyZWoiLCJwYXJzZSIsInNhdmVTaW5nbGVQbGFuIiwiZ2V0U2luZ2xlUGxhbiIsInBsYW5JZCIsImdldCIsInNhdmUiLCJvYmoiLCJjb25zb2xlIiwibG9nIiwiZm9jdXNPbiIsInNjb3BlIiwiZWxlbSIsImF0dHIiLCIkb24iLCJlIiwidG9vbFRpcCIsImVsZW1lbnQiLCJhdHRycyIsImFuZ3VsYXIiLCJvbiIsImhpZGVUb29sdGlwIiwic2hvd1Rvb2x0aXAiLCJ0b29sdGlwIiwiaG9tZUN0cmwiLCIkc2NvcGUiLCIkYXV0aCIsIiRzdGF0ZSIsIiR3aW5kb3ciLCIkbG9jYXRpb24iLCJnZXRUb2tlbiIsInRoZW4iLCJjdXJyZW50VXNlciIsImVyciIsImdvIiwiJCRwYXRoIiwiaW5jbHVkZXMiLCJldiIsInRvIiwidG9QYXJhbXMiLCJmcm9tIiwiZnJvbVBhcmFtcyIsInByZXZpb3VzU3RhdGUiLCJjdXJyZW50U3RhdGUiLCJjdXJyZW50VXJsIiwiYXV0aEN0cmwiLCJhdXRoX2VudGVyIiwiYXV0aERhdGEiLCJzaWdudXAiLCJzZXRUb2tlbiIsInJlbG9hZCIsImF1dGhlbnRpY2F0ZSIsInByb3ZpZGVyIiwiZGFzaGJvYXJkQ3RybCIsImxvZ291dCIsImxvY2F0aW9uIiwicGhvbmUiLCJsZW5ndGgiLCJ1c2VyRGF0YSIsInZlcmlmeVBob25lU2VudE91dCIsImNvZGUiLCJtc2ciLCJ2ZXJpZmllZCIsImRvQ2hlY2tvdXQiLCJ0b2tlbiIsInN0cmlwZVRva2VuIiwiZGFzaGJvYXJkUGxhbkN0cmwiLCIkc3RhdGVQYXJhbXMiLCJ1cGRhdGVUaW1lcyIsInRpbWVzIiwiaW5zdGFsbG1lbnRzR3JhcGhEYXRhIiwiaSIsImluc3RhbGxtZW50IiwidG90YWwiLCJoZWlnaHQiLCJwdXNoIiwicHJpY2UiLCJzdHlsZSIsIndpZHRoIiwiZGVmYXVsdFBsYW5UaW1lcyIsInByZXZpZXdTaW5nbGVQbGFuIiwic2luZ2xlUGF5bWVudCIsImRvd25wYXkiLCJpbnRlcnZhbFNlbGVjdGVkIiwiY2hvaWNlIiwiaW50ZXJ2YWwiLCJwbGFuUHJldmlldyIsInNhdmVTaW5nbGVQbGFuSW5mbyIsInBsYW5EZXRhaWxzIiwiY3JlYXRvciIsImdldEFsbFBsYW5zIiwiY3VycmVudFVzZXJJZCIsIl9pZCIsInBhcmFtcyIsIm1vZHVsZSIsImNvbmZpZyIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwiJGF1dGhQcm92aWRlciIsIlN0cmlwZSIsInNldFB1Ymxpc2hhYmxlS2V5Iiwic3RhdGUiLCJsYW5kaW5nIiwiYXV0aEVudHJhbmNlIiwiZGFzaGJvYXJkIiwiZGFzaGJvYXJkX3BheW1lbnQiLCJkYXNoYm9hcmRfcGxhbiIsImRhc2hib2FyZF9wbGFuX3N0YXJ0IiwiZGFzaGJvYXJkX3BsYW5fZGV0YWlscyIsImRhc2hib2FyZF9wbGFuX2Nob29zZSIsImRhc2hib2FyZF9wbGFuX3NpbmdsZSIsImRhc2hib2FyZF9wbGFuX3NpbmdsZV9wcmV2aWV3IiwiZGFzaGJvYXJkX3BsYW5fbXVsdGlwbGUiLCJkYXNoYm9hcmRfYWNjb3VudCIsIm90aGVyd2lzZSIsInZpZXdzIiwibWFpbiIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsInBhcmVudCIsImRhc2hib2FyZF9zZWN0aW9uIiwiZGFzaGJvYXJkX2NoaWxkX3NlY3Rpb24iLCJkb2N1bWVudCIsInJlYWR5IiwiJGluamVjdCIsInNlcnZpY2UiLCJmYWN0b3J5IiwiZGlyZWN0aXZlIl0sIm1hcHBpbmdzIjoiQUFBQSxZQ0lBLFNBQVNBLFFBQ0xDLFNBQ0FDLG1CQUdKLFFBQVNELFVBQ0xFLEVBQUUsNEJBQTRCRixRQUMxQkcsV0FBWSxLQUlwQixRQUFTRixvQkFDTCxHQUNJRyxHQURBQyxFQUFnQixDQUVwQkgsR0FBRUksUUFBUUMsT0FBTyxXQUViSCxFQUFLRixFQUFFTSxNQUFNQyxZQUNWUCxFQUFFSSxRQUFRRyxZQUFjLEtBQ2RKLEVBQUxELEdBQ0FGLEVBQUUsa0JBQWtCUSxZQUFZLFVBQ2hDUixFQUFFLGtCQUFrQlMsSUFBSSxnQkFBaUIsY0FFekNULEVBQUUsa0JBQWtCVSxTQUFTLFdBR3JDUCxFQUFnQkQsRUFFWkYsRUFBRUksUUFBUUcsWUFBYyxJQUN4QlAsRUFBRSxrQkFBa0JVLFNBQVMsT0FFN0JWLEVBQUVJLFFBQVFHLFlBQWMsSUFDeEJQLEVBQUUsa0JBQWtCUSxZQUFZLE9BRWhDUixFQUFFSSxRQUFRRyxZQUFjLEdBR3hCUCxFQUFFSSxRQUFRRyxZQUFjLEtBQ3hCUCxFQUFFLGtCQUFrQlMsSUFBSSxhQUFjLHNDQUV0Q1QsRUFBRUksUUFBUUcsWUFBYyxL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S0FBTSxVQUFXLFNBQ2pDdEksUUFBUXNJLFNBQVcsTUFKbkJ6RyxRQUNLMkUsT0FBTyxZQUNQK0IsUUFBUSxVQUFXN0osU0FDbkI2SixRQUFRLFVBQVdqSixTQUNuQmtKLFFBQVEsUUFBUy9JLE9BQ2pCOEksUUFBUSxPQUFRekksTUFDaEJ5SSxRQUFRLFVBQVd2SSxTQ054QjZCLFFBQ0syRSxPQUFPLFlBQ1BpQyxVQUFVLFVBQVdySCxTQ0YxQlMsUUFDSzJFLE9BQU8sWUFDUGlDLFVBQVUsVUFBVy9HLFNDRjFCUSxTQUFTb0csU0FBVyxTQUFVLFFBQVMsU0FBVSxVQUFXLFVBQVcsYUFBYyxhQUNyRi9FLFNBQVMrRSxTQUFXLFNBQVUsUUFBUyxTQUFVLFVBQVcsVUFBVyxjQUN2RXZFLGNBQWN1RSxTQUFXLFNBQVUsUUFBUyxTQUFVLFVBQVcsYUFBYyxVQUFXLFdBQzFGMUQsa0JBQWtCMEQsU0FBVyxTQUFVLFVBQVcsZUFBZ0IsU0FBVSxPQUFRLGNBSHBGekcsUUFDSzJFLE9BQU8sWUFDUHdCLFdBQVcsV0FBWTlGLFVBQ3ZCOEYsV0FBVyxXQUFZekUsVUFDdkJ5RSxXQUFXLGdCQUFpQmpFLGVBQzVCaUUsV0FBVyxvQkFBcUJwRCIsImZpbGUiOiJidW5kbGUubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5hbmd1bGFyXG4gICAgLm1vZHVsZSgncGluY2hBcHAnLCBbXG4gICAgICAgICd1aS5yb3V0ZXInLFxuICAgICAgICAnc2F0ZWxsaXplcicsXG4gICAgICAgICduZ0FuaW1hdGUnLFxuICAgICAgICAvLyAndWkuYm9vdHN0cmFwJyxcbiAgICAgICAgJ25nRmlsZVVwbG9hZCcsXG4gICAgICAgICduZ0ltZ0Nyb3AnLFxuICAgICAgICAnc3RyaXBlLmNoZWNrb3V0JyxcbiAgICAgICAgJ2FuZ3VsYXItbG9hZGluZy1iYXInLFxuICAgICAgICAnYW5pbS1pbi1vdXQnXG4gICAgXSlcbiAgICAuY29uZmlnKGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIsICRhdXRoUHJvdmlkZXIpIHtcbiAgICAgICAgU3RyaXBlLnNldFB1Ymxpc2hhYmxlS2V5KCdwa190ZXN0X3QxZVRoaE9LbDZlc3JwNmY0anlXcVU0SicpXG5cbiAgICAgICAgLy8gJGF1dGhQcm92aWRlclxuICAgICAgICAvLyAgICAgLmZhY2Vib29rKHtcbiAgICAgICAgLy8gICAgICAgICBjbGllbnRJZDogJzI5ODE2NTExMzg0OTM2NidcbiAgICAgICAgLy8gICAgIH0pO1xuXG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUobGFuZGluZylcbiAgICAgICAgICAgIC5zdGF0ZShhdXRoRW50cmFuY2UpXG4gICAgICAgICAgICAuc3RhdGUoZGFzaGJvYXJkKVxuICAgICAgICAgICAgLnN0YXRlKGRhc2hib2FyZF9wYXltZW50KVxuICAgICAgICAgICAgLnN0YXRlKGRhc2hib2FyZF9wbGFuKVxuICAgICAgICAgICAgLnN0YXRlKGRhc2hib2FyZF9wbGFuX3N0YXJ0KVxuICAgICAgICAgICAgLnN0YXRlKGRhc2hib2FyZF9wbGFuX2RldGFpbHMpXG4gICAgICAgICAgICAuc3RhdGUoZGFzaGJvYXJkX3BsYW5fY2hvb3NlKVxuICAgICAgICAgICAgLnN0YXRlKGRhc2hib2FyZF9wbGFuX3NpbmdsZSlcbiAgICAgICAgICAgIC5zdGF0ZShkYXNoYm9hcmRfcGxhbl9zaW5nbGVfcHJldmlldylcbiAgICAgICAgICAgIC5zdGF0ZShkYXNoYm9hcmRfcGxhbl9tdWx0aXBsZSlcbiAgICAgICAgICAgIC5zdGF0ZShkYXNoYm9hcmRfYWNjb3VudClcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcGFnZSlcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcGFnZV9wcm9qZWN0cylcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcGFnZV9saWtlZClcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcGFnZV9mb2xsb3dlcnMpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHJvamVjdHBhZ2UpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHJvamVjdFNldHRpbmcpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHJvamVjdFNldHRpbmdfZ2VuZXJhbClcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcm9qZWN0U2V0dGluZ19yZXF1ZXN0KVxuICAgICAgICAgICAgLy8gLnN0YXRlKHByb2plY3RTZXR0aW5nX3ByaXZhY3kpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHJvamVjdFNldHRpbmdfZGFuZ2VyKVxuICAgICAgICAgICAgLy8gLnN0YXRlKHByb2ZpbGVTZXR0aW5nKVxuICAgICAgICAgICAgLy8gLnN0YXRlKHByb2ZpbGVTZXR0aW5nX2dlbmVyYWwpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHJvZmlsZVNldHRpbmdfcmVxdWVzdClcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcm9maWxlU2V0dGluZ19wcml2YWN5KVxuICAgICAgICAgICAgLy8gLnN0YXRlKHByb2ZpbGVTZXR0aW5nX2RhbmdlcilcblxuXG4gICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcbiAgICB9KTtcblxuXG5sZXQgbGFuZGluZyA9IHtcbiAgICBuYW1lOiAnbGFuZGluZycsXG4gICAgdXJsOiAnLycsXG4gICAgdmlld3M6IHtcbiAgICAgICAgbWFpbjoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9sYW5kaW5nLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2F1dGhDdHJsJ1xuICAgICAgICB9XG4gICAgfVxufVxubGV0IGF1dGhFbnRyYW5jZSA9IHtcbiAgICBuYW1lOiAnYXV0aEVudHJhbmNlJyxcbiAgICB1cmw6ICcvZW50cmFuY2UnLFxuICAgIHZpZXdzOiB7XG4gICAgICAgIG1haW46IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvZW50cmFuY2UuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnYXV0aEN0cmwnXG4gICAgICAgIH1cbiAgICB9XG59XG5sZXQgZGFzaGJvYXJkID0ge1xuICAgIG5hbWU6ICdkYXNoYm9hcmQnLFxuICAgIHVybDogJy9kYXNoYm9hcmQnLFxuICAgIHZpZXdzOiB7XG4gICAgICAgIG1haW46IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvZGFzaGJvYXJkLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2Rhc2hib2FyZEN0cmwnXG4gICAgICAgIH1cbiAgICB9XG59XG5cbmxldCBkYXNoYm9hcmRfcGF5bWVudCA9IHtcbiAgICBuYW1lOiAnZGFzaGJvYXJkX3BheW1lbnQnLFxuICAgIHVybDogJy9wYXltZW50JyxcbiAgICBwYXJlbnQ6ICdkYXNoYm9hcmQnLFxuICAgIHZpZXdzOiB7XG4gICAgICAgIGRhc2hib2FyZF9zZWN0aW9uOiB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL2Rhc2hib2FyZF9wYXltZW50Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2Rhc2hib2FyZEN0cmwnXG4gICAgICAgIH1cbiAgICB9XG59XG5sZXQgZGFzaGJvYXJkX3BsYW4gPSB7XG4gICAgbmFtZTogJ2Rhc2hib2FyZF9wbGFuJyxcbiAgICB1cmw6ICcvcGxhbicsXG4gICAgcGFyZW50OiAnZGFzaGJvYXJkJyxcbiAgICB2aWV3czoge1xuICAgICAgICBkYXNoYm9hcmRfc2VjdGlvbjoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9kYXNoYm9hcmRfcGxhbi5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdkYXNoYm9hcmRDdHJsJ1xuICAgICAgICB9XG4gICAgfVxufVxubGV0IGRhc2hib2FyZF9wbGFuX3N0YXJ0ID0ge1xuICAgIG5hbWU6ICdkYXNoYm9hcmRfcGxhbl9zdGFydCcsXG4gICAgdXJsOiAnL3N0YXJ0JyxcbiAgICBwYXJlbnQ6ICdkYXNoYm9hcmRfcGxhbicsXG4gICAgdmlld3M6IHtcbiAgICAgICAgZGFzaGJvYXJkX2NoaWxkX3NlY3Rpb246IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvZGFzaGJvYXJkL2Rhc2hib2FyZF9wbGFuX3N0YXJ0Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2Rhc2hib2FyZEN0cmwnXG4gICAgICAgIH1cbiAgICB9XG59XG5sZXQgZGFzaGJvYXJkX3BsYW5fZGV0YWlscyA9IHtcbiAgICBuYW1lOiAnZGFzaGJvYXJkX3BsYW5fZGV0YWlscycsXG4gICAgdXJsOiAnLzpwbGFuSWQnLFxuICAgIHBhcmVudDogJ2Rhc2hib2FyZF9wbGFuJyxcbiAgICB2aWV3czoge1xuICAgICAgICBkYXNoYm9hcmRfY2hpbGRfc2VjdGlvbjoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9kYXNoYm9hcmQvZGFzaGJvYXJkX3BsYW5fZGV0YWlscy5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdkYXNoYm9hcmRQbGFuQ3RybCdcbiAgICAgICAgfVxuICAgIH1cbn1cbmxldCBkYXNoYm9hcmRfcGxhbl9jaG9vc2UgPSB7XG4gICAgbmFtZTogJ2Rhc2hib2FyZF9wbGFuX2Nob29zZScsXG4gICAgdXJsOiAnL2Nob29zZScsXG4gICAgcGFyZW50OiAnZGFzaGJvYXJkX3BsYW4nLFxuICAgIHZpZXdzOiB7XG4gICAgICAgIGRhc2hib2FyZF9jaGlsZF9zZWN0aW9uOiB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL2Rhc2hib2FyZC9kYXNoYm9hcmRfcGxhbl9jaG9vc2UuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnZGFzaGJvYXJkQ3RybCdcbiAgICAgICAgfVxuICAgIH1cbn1cbmxldCBkYXNoYm9hcmRfcGxhbl9zaW5nbGUgPSB7XG4gICAgbmFtZTogJ2Rhc2hib2FyZF9wbGFuX3NpbmdsZScsXG4gICAgdXJsOiAnL2Nob29zZS9zaW5nbGUnLFxuICAgIHBhcmVudDogJ2Rhc2hib2FyZF9wbGFuJyxcbiAgICB2aWV3czoge1xuICAgICAgICBkYXNoYm9hcmRfY2hpbGRfc2VjdGlvbjoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9kYXNoYm9hcmQvZGFzaGJvYXJkX3BsYW5fc2luZ2xlLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2Rhc2hib2FyZFBsYW5DdHJsJ1xuICAgICAgICB9XG4gICAgfVxufVxubGV0IGRhc2hib2FyZF9wbGFuX3NpbmdsZV9wcmV2aWV3ID0ge1xuICAgIG5hbWU6ICdkYXNoYm9hcmRfcGxhbl9zaW5nbGVfcHJldmlldycsXG4gICAgdXJsOiAnL2Nob29zZS9zaW5nbGUvcHJldmlldycsXG4gICAgcGFyZW50OiAnZGFzaGJvYXJkX3BsYW4nLFxuICAgIHZpZXdzOiB7XG4gICAgICAgIGRhc2hib2FyZF9jaGlsZF9zZWN0aW9uOiB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL2Rhc2hib2FyZC9kYXNoYm9hcmRfcGxhbl9zaW5nbGVfcHJldmlldy5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdkYXNoYm9hcmRQbGFuQ3RybCdcbiAgICAgICAgfVxuICAgIH1cbn1cbmxldCBkYXNoYm9hcmRfcGxhbl9tdWx0aXBsZSA9IHtcbiAgICBuYW1lOiAnZGFzaGJvYXJkX3BsYW5fbXVsdGlwbGUnLFxuICAgIHVybDogJy9jaG9vc2UvbXV0aXBsZScsXG4gICAgcGFyZW50OiAnZGFzaGJvYXJkX3BsYW4nLFxuICAgIHZpZXdzOiB7XG4gICAgICAgIGRhc2hib2FyZF9jaGlsZF9zZWN0aW9uOiB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL2Rhc2hib2FyZC9kYXNoYm9hcmRfcGxhbl9tdWx0aXBsZS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdkYXNoYm9hcmRDdHJsJ1xuICAgICAgICB9XG4gICAgfVxufVxubGV0IGRhc2hib2FyZF9hY2NvdW50ID0ge1xuICAgIG5hbWU6ICdkYXNoYm9hcmRfYWNjb3VudCcsXG4gICAgdXJsOiAnL2FjY291bnQnLFxuICAgIHBhcmVudDogJ2Rhc2hib2FyZCcsXG4gICAgdmlld3M6IHtcbiAgICAgICAgZGFzaGJvYXJkX3NlY3Rpb246IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvZGFzaGJvYXJkX2FjY291bnQuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnZGFzaGJvYXJkQ3RybCdcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsIid1c2Ugc3RyaWN0J1xuXG4kKGRvY3VtZW50KS5yZWFkeShpbml0KTtcblxuZnVuY3Rpb24gaW5pdCgpIHtcbiAgICBzdGlja3koKVxuICAgIHdpbmRvd1Njcm9sbERvd24oKVxufVxuXG5mdW5jdGlvbiBzdGlja3koKSB7XG4gICAgJChcIi5zaW5nbGVQbGFuUHJldmlld1N0aWNreVwiKS5zdGlja3koe1xuICAgICAgICB0b3BTcGFjaW5nOiA4MFxuICAgIH0pXG59XG5cbmZ1bmN0aW9uIHdpbmRvd1Njcm9sbERvd24oKSB7XG4gICAgdmFyIGxhc3RTY3JvbGxUb3AgPSAwXG4gICAgdmFyIHN0XG4gICAgJCh3aW5kb3cpLnNjcm9sbChmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJCh3aW5kb3cpLnNjcm9sbFRvcCgpKTtcbiAgICAgICAgc3QgPSAkKHRoaXMpLnNjcm9sbFRvcCgpO1xuICAgICAgICBpZigkKHdpbmRvdykuc2Nyb2xsVG9wKCkgPiAzMCl7XG4gICAgICAgICAgICBpZiAoc3QgPCBsYXN0U2Nyb2xsVG9wKSB7XG4gICAgICAgICAgICAgICAgJCgnLmhvbWUtcGFnZSBuYXYnKS5yZW1vdmVDbGFzcygnZm9sZGVkJylcbiAgICAgICAgICAgICAgICAkKCcuaG9tZS1wYWdlIG5hdicpLmNzcygnYm9yZGVyLWJvdHRvbScsICcwcHggc29saWQnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJCgnLmhvbWUtcGFnZSBuYXYnKS5hZGRDbGFzcygnZm9sZGVkJylcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBsYXN0U2Nyb2xsVG9wID0gc3RcblxuICAgICAgICBpZiAoJCh3aW5kb3cpLnNjcm9sbFRvcCgpIDwgMTApIHtcbiAgICAgICAgICAgICQoJy5ob21lLXBhZ2UgbmF2JykuYWRkQ2xhc3MoJ3RvcCcpXG4gICAgICAgIH1cbiAgICAgICAgaWYgKCQod2luZG93KS5zY3JvbGxUb3AoKSA+IDEwKSB7XG4gICAgICAgICAgICAkKCcuaG9tZS1wYWdlIG5hdicpLnJlbW92ZUNsYXNzKCd0b3AnKVxuICAgICAgICB9XG4gICAgICAgIGlmICgkKHdpbmRvdykuc2Nyb2xsVG9wKCkgPiAzMCkge1xuXG4gICAgICAgIH1cbiAgICAgICAgaWYgKCQod2luZG93KS5zY3JvbGxUb3AoKSA8IDU0MCkge1xuICAgICAgICAgICAgJCgnLmhvbWUtcGFnZSBuYXYnKS5jc3MoJ2JveC1zaGFkb3cnLCAnaW5zZXQgMCAtMXB4IDBweCAwcHggcmdiYSgwLDAsMCwwKScpO1xuICAgICAgICB9XG4gICAgICAgIGlmICgkKHdpbmRvdykuc2Nyb2xsVG9wKCkgPiA1NDApIHtcbiAgICAgICAgICAgICQoJy5ob21lLXBhZ2UgbmF2JykuY3NzKCdib3gtc2hhZG93JywgJ2luc2V0IDAgLTFweCAwcHggMHB4IHJnYmEoMCwwLDAsMC4xKScpO1xuICAgICAgICB9XG5cbiAgICB9KVxufVxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5hbmd1bGFyXG4gICAgLm1vZHVsZSgncGluY2hBcHAnKVxuICAgIC5zZXJ2aWNlKCdBY2NvdW50JywgQWNjb3VudClcbiAgICAuc2VydmljZSgnUGF5bWVudCcsIFBheW1lbnQpXG4gICAgLmZhY3RvcnkoJ2ZvY3VzJywgZm9jdXMpXG4gICAgLnNlcnZpY2UoJ1BsYW4nLCBQbGFuKVxuICAgIC5zZXJ2aWNlKCdTdG9yYWdlJywgU3RvcmFnZSlcblxuZnVuY3Rpb24gQWNjb3VudCgkaHR0cCkge1xuICAgIHRoaXMuZ2V0Q3VycmVudFVzZXIgPSAoKSA9PiB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgdXJsOiBgL2FwaS9hdXRoL2N1cnJlbnRVc2VyYFxuICAgICAgICB9KVxuICAgIH1cbiAgICB0aGlzLnNlbmRWZXJpZnlDb2RlID0gKHVzZXJPYmopID0+IHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgdXJsOiBgL2FwaS92ZXJpZnkvcGhvbmVgLFxuICAgICAgICAgICAgZGF0YTogdXNlck9ialxuICAgICAgICB9KVxuICAgIH1cbiAgICB0aGlzLnZlcmlmeUNvZGUgPSAodXNlck9iaikgPT4ge1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUFVUJyxcbiAgICAgICAgICAgIHVybDogYC9hcGkvdmVyaWZ5L3Bob25lYCxcbiAgICAgICAgICAgIGRhdGE6IHVzZXJPYmpcbiAgICAgICAgfSlcbiAgICB9XG4gICAgdGhpcy5nZXRVc2VyRGF0YSA9ICh1cmlVc2VySWQpID0+IHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICB1cmw6IGAvYXBpL3VzZXJzLyR7dXJpVXNlcklkfWBcbiAgICAgICAgfSlcbiAgICB9XG4gICAgdGhpcy51cGRhdGVVc2VyRGF0YSA9ICh1cmlVc2VySWQsIHVwZGF0ZVVzZXJEYXRhKSA9PiB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdQVVQnLFxuICAgICAgICAgICAgdXJsOiBgL2FwaS91c2Vycy8ke3VyaVVzZXJJZH1gLFxuICAgICAgICAgICAgZGF0YTogdXBkYXRlVXNlckRhdGFcbiAgICAgICAgfSlcbiAgICB9XG59XG5cbmZ1bmN0aW9uIFBheW1lbnQoJGh0dHApIHtcbiAgICB0aGlzLmNoYXJnZU5vdyA9IChkYXRhT2JqKSA9PiB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIHVybDogYC9hcGkvcGF5bWVudC9jaGFyZ2VOb3dgLFxuICAgICAgICAgICAgZGF0YTogZGF0YU9ialxuICAgICAgICB9KVxuICAgIH1cbn1cblxuZnVuY3Rpb24gZm9jdXMoJHJvb3RTY29wZSwgJHRpbWVvdXQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24obmFtZSkge1xuICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnZm9jdXNPbicsIG5hbWUpO1xuICAgICAgICB9LCAwKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIFBsYW4oJHEsIFN0b3JhZ2UsICRodHRwKSB7XG4gICAgdGhpcy5hZGRTaW5nbGVQcmV2aWV3ID0gKHBsYW4pID0+IHtcbiAgICAgICAgcmV0dXJuICRxKChyZXMsIHJlcSkgPT4ge1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnBsYW5QcmV2aWV3RGF0YSA9IEpTT04uc3RyaW5naWZ5KHBsYW4pXG4gICAgICAgICAgICByZXMobG9jYWxTdG9yYWdlLnBsYW5QcmV2aWV3RGF0YSlcbiAgICAgICAgfSlcbiAgICB9XG4gICAgdGhpcy5nZXRTaW5nbGVQcmV2aWV3ID0gKCkgPT4ge1xuICAgICAgICByZXR1cm4gJHEoKHJlcywgcmVqKSA9PiB7XG4gICAgICAgICAgICByZXMoSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UucGxhblByZXZpZXdEYXRhKSlcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICB0aGlzLnNhdmVTaW5nbGVQbGFuID0gKGRhdGEpID0+IHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgdXJsOiBgL2FwaS9wbGFucy9zYXZlU2luZ2xlUGxhbmAsXG4gICAgICAgICAgICBkYXRhOiBkYXRhXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgdGhpcy5nZXRTaW5nbGVQbGFuID0gKHBsYW5JZCkgPT4ge1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgIHVybDogYC9hcGkvcGxhbnMvZ2V0U2luZ2xlUGxhbi8ke3BsYW5JZH1gXG4gICAgICAgIH0pXG4gICAgfVxuXG59XG5cbmZ1bmN0aW9uIFN0b3JhZ2UoJHEpIHtcbiAgICB0aGlzLmdldCA9ICgpID0+IHtcbiAgICAgICAgLy8gcmV0dXJuICRxKChyZXMsIHJlaikgPT4ge1xuICAgICAgICAvLyAgICAgaWYgKCFsb2NhbFN0b3JhZ2Uuc2VwZXJwYXkpIHtcbiAgICAgICAgLy8gICAgICAgICBsb2NhbFN0b3JhZ2Uuc2VwZXJwYXkgPSB7fVxuICAgICAgICAvLyAgICAgICAgIHJlcyhKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5zZXBlcnBheSkpXG4gICAgICAgIC8vICAgICB9IGVsc2UgaWYgKGxvY2FsU3RvcmFnZS5zZXBlcnBheSkge1xuICAgICAgICAvLyAgICAgICAgIHJlcyhKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5zZXBlcnBheSkpXG4gICAgICAgIC8vICAgICB9XG4gICAgICAgIC8vIH0pXG4gICAgfVxuXG4gICAgdGhpcy5zYXZlID0gKG9iaikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygnb2JqOiAnLCBvYmopO1xuICAgICAgICAvLyB2YXIga2V5ID0gb2JqXG4gICAgICAgIC8vIHZhciBvYmogPSBKU09OLnN0cmluZ2lmeShvYmopXG4gICAgICAgIC8vIGxvY2FsU3RvcmFnZVxuICAgIH1cbn1cbiIsIid1c2Ugc3RyaWN0JztcblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ3BpbmNoQXBwJylcbiAgICAuZGlyZWN0aXZlKCdmb2N1c09uJywgZm9jdXNPbilcblxuZnVuY3Rpb24gZm9jdXNPbigpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGVsZW0sIGF0dHIpIHtcbiAgICAgICAgc2NvcGUuJG9uKCdmb2N1c09uJywgZnVuY3Rpb24oZSwgbmFtZSkge1xuICAgICAgICAgICAgaWYgKG5hbWUgPT09IGF0dHIuZm9jdXNPbikge1xuICAgICAgICAgICAgICAgIGVsZW1bMF0uZm9jdXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbn1cbiIsIid1c2Ugc3RyaWN0JztcblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ3BpbmNoQXBwJylcbiAgICAuZGlyZWN0aXZlKCd0b29sVGlwJywgdG9vbFRpcClcblxuZnVuY3Rpb24gdG9vbFRpcCgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudCgnLnRvb2wtdGlwJykub24oJ2NsaWNrIG1vdXNlbGVhdmUnLCBoaWRlVG9vbHRpcCk7XG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudCgnLnRvb2wtdGlwJykub24oJ21vdXNlZW50ZXInLCBzaG93VG9vbHRpcCk7XG4gICAgfTtcbn1cblxuZnVuY3Rpb24gaGlkZVRvb2x0aXAoKSB7XG4gICAgJCh0aGlzKS50b29sdGlwKCdoaWRlJyk7XG59XG5cbmZ1bmN0aW9uIHNob3dUb29sdGlwKCkge1xuICAgICQodGhpcykudG9vbHRpcCgnc2hvdycpO1xufVxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5hbmd1bGFyXG4gICAgLm1vZHVsZSgncGluY2hBcHAnKVxuICAgIC5jb250cm9sbGVyKCdob21lQ3RybCcsIGhvbWVDdHJsKVxuICAgIC5jb250cm9sbGVyKCdhdXRoQ3RybCcsIGF1dGhDdHJsKVxuICAgIC5jb250cm9sbGVyKCdkYXNoYm9hcmRDdHJsJywgZGFzaGJvYXJkQ3RybClcbiAgICAuY29udHJvbGxlcignZGFzaGJvYXJkUGxhbkN0cmwnLCBkYXNoYm9hcmRQbGFuQ3RybClcblxuZnVuY3Rpb24gaG9tZUN0cmwoJHNjb3BlLCAkYXV0aCwgJHN0YXRlLCBBY2NvdW50LCAkd2luZG93LCAkcm9vdFNjb3BlLCAkbG9jYXRpb24pIHtcbiAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3VjY2VzcycsIGZ1bmN0aW9uKGV2LCB0bywgdG9QYXJhbXMsIGZyb20sIGZyb21QYXJhbXMpIHtcbiAgICAgICAgJHJvb3RTY29wZS5wcmV2aW91c1N0YXRlID0gZnJvbS5uYW1lO1xuICAgICAgICAkcm9vdFNjb3BlLmN1cnJlbnRTdGF0ZSA9IHRvLm5hbWU7XG4gICAgICAgIGNvbnNvbGUubG9nKCRyb290U2NvcGUucHJldmlvdXNTdGF0ZSwgJyA+Pj4gJywgJHJvb3RTY29wZS5jdXJyZW50U3RhdGUpXG4gICAgICAgIGlmICgkcm9vdFNjb3BlLmN1cnJlbnRTdGF0ZSA9PSAnYXV0aEVudHJhbmNlJyAmJiAkc2NvcGUuY3VycmVudFVzZXIpICRzdGF0ZS5nbygnZGFzaGJvYXJkJylcbiAgICAgICAgJHNjb3BlLmN1cnJlbnRVcmwgPSAkbG9jYXRpb24uJCRwYXRoO1xuICAgICAgICBnZXRDdXJyZW50VXNlcigpXG4gICAgfSlcblxuICAgIGZ1bmN0aW9uIGdldEN1cnJlbnRVc2VyKCkge1xuICAgICAgICBpZiAoJGF1dGguZ2V0VG9rZW4oKSkge1xuICAgICAgICAgICAgQWNjb3VudC5nZXRDdXJyZW50VXNlcigkYXV0aC5nZXRUb2tlbigpKVxuICAgICAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdAQ3VycmVudFVzZXI6ICcsIHJlcy5kYXRhKVxuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gcmVzLmRhdGFcbiAgICAgICAgICAgICAgICB9LCAoZXJyKSA9PiAkc3RhdGUuZ28oJ2F1dGhFbnRyYW5jZScpKVxuICAgICAgICB9IGVsc2UgaWYgKCEkYXV0aC5nZXRUb2tlbigpICYmICRsb2NhdGlvbi4kJHBhdGguaW5jbHVkZXMoJ2Rhc2hib2FyZCcpKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2F1dGhFbnRyYW5jZScpXG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIGF1dGhDdHJsKCRzY29wZSwgJGF1dGgsICRzdGF0ZSwgQWNjb3VudCwgJHdpbmRvdywgJHJvb3RTY29wZSkge1xuICAgICRzY29wZS5hdXRoX2VudGVyID0gKGF1dGhEYXRhKSA9PiB7XG4gICAgICAgICRhdXRoLnNpZ251cChhdXRoRGF0YSlcbiAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgJGF1dGguc2V0VG9rZW4ocmVzKTtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2Rhc2hib2FyZCcsIHt9LCB7XG4gICAgICAgICAgICAgICAgICAgIHJlbG9hZDogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlcyBAYXV0aF9lbnRlcjogJywgcmVzLmRhdGEpXG4gICAgICAgICAgICB9LCAoZXJyKSA9PiBjb25zb2xlLmxvZygnZXJyIEBhdXRoX2VudGVyOiAnLCBlcnIpKVxuICAgIH1cblxuICAgICRzY29wZS5hdXRoZW50aWNhdGUgPSAocHJvdmlkZXIpID0+IHtcbiAgICAgICAgJGF1dGguYXV0aGVudGljYXRlKHByb3ZpZGVyKTtcbiAgICB9XG5cbn1cblxuZnVuY3Rpb24gZGFzaGJvYXJkQ3RybCgkc2NvcGUsICRhdXRoLCAkc3RhdGUsIEFjY291bnQsICRyb290U2NvcGUsIFBheW1lbnQsICR3aW5kb3cpIHtcbiAgICAvLyBjb25zb2xlLmxvZygnZGFzaGJvYXJkQ3RybCBsb2FkZWQnKVxuICAgIC8vIGNoZWNrVmVyaWZ5UGhvbmVTZW50U3RhdHVzKCRyb290U2NvcGUuY3VycmVudFVzZXIpXG5cbiAgICAkc2NvcGUubG9nb3V0ID0gKCkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygnY2hlY2snKTtcbiAgICAgICAgJGF1dGgubG9nb3V0KClcbiAgICAgICAgJHNjb3BlLmN1cnJlbnRVc2VyID0gbnVsbDtcbiAgICAgICAgJHN0YXRlLmdvKCdsYW5kaW5nJywge30sIHtcbiAgICAgICAgICAgIHJlbG9hZDogdHJ1ZVxuICAgICAgICB9KVxuICAgICAgICAkd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNoZWNrVmVyaWZ5UGhvbmVTZW50U3RhdHVzKGN1cnJlbnRVc2VyRGF0YSkge1xuICAgICAgICAkc2NvcGUudmVyaWZ5UGhvbmVTZW50T3V0ID0gZmFsc2VcblxuICAgICAgICBsZXQgZXhwaXJlZFRpbWUgPSBOdW1iZXIoY3VycmVudFVzZXJEYXRhLnBob25lLnZlcmlmeUNvZGUuZXhwaXJlZEF0KVxuICAgICAgICBsZXQgbm93VGltZSA9IERhdGUubm93KClcbiAgICAgICAgaWYgKGV4cGlyZWRUaW1lID4gbm93VGltZSkge1xuICAgICAgICAgICAgJHNjb3BlLnZlcmlmeVBob25lU2VudE91dCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgJHNjb3BlLnZlcmlmeVBob25lQ291bnREb3duID0gKCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGAke2V4cGlyZWRUaW1lfWBcbiAgICAgICAgfVxuICAgIH1cblxuICAgICRzY29wZS5zZW5kVmVyaWZ5Q29kZSA9IChwaG9uZSkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygncGhvbmU6ICcsIHBob25lKVxuICAgICAgICBpZiAocGhvbmUubGVuZ3RoID4gNSkge1xuICAgICAgICAgICAgdmFyIHVzZXJPYmogPSB7XG4gICAgICAgICAgICAgICAgdXNlckRhdGE6ICRyb290U2NvcGUuY3VycmVudFVzZXIsXG4gICAgICAgICAgICAgICAgcGhvbmU6IHBob25lXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zb2xlLmxvZygndXNlck9iajogJywgdXNlck9iaik7XG4gICAgICAgICAgICBBY2NvdW50LnNlbmRWZXJpZnlDb2RlKHVzZXJPYmopXG4gICAgICAgICAgICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlcyBAc2VuZFZlcmlmeUNvZGU6ICcsIHJlcy5kYXRhKVxuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyLnBob25lLmRhdGEgPSBwaG9uZTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnZlcmlmeVBob25lU2VudE91dCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfSwgZXJyID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2VyciBAc2VuZFZlcmlmeUNvZGU6ICcsIGVycik7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH1cbiAgICAkc2NvcGUudmVyaWZ5Q29kZSA9IChjb2RlKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdjb2RlOiAnLCBjb2RlKVxuICAgICAgICBpZiAoY29kZS5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgIHZhciB1c2VyT2JqID0ge1xuICAgICAgICAgICAgICAgIHVzZXJEYXRhOiAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyLFxuICAgICAgICAgICAgICAgIGNvZGU6IGNvZGVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIEFjY291bnQudmVyaWZ5Q29kZSh1c2VyT2JqKVxuICAgICAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXMgQHZlcmlmeUNvZGU6ICcsIHJlcy5kYXRhKVxuICAgICAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEubXNnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEubXNnID09ICdpbmNvcnJlY3QnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2VycjogaW5jb3JyZWN0Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlcy5kYXRhLm1zZyA9ICdleHBpcmVkJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZXJyOiBleHBpcmVkJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuY3VycmVudFVzZXIucGhvbmUudmVyaWZpZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgZXJyID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2VyciBAdmVyaWZ5Q29kZTogJywgZXJyKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgJHNjb3BlLmRvQ2hlY2tvdXQgPSAodG9rZW4pID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ2ZmZicpO1xuICAgICAgICBjb25zb2xlLmxvZygndG9rZW46ICcsIHRva2VuKTtcbiAgICAgICAgdmFyIGRhdGFPYmogPSB7XG4gICAgICAgICAgICBzdHJpcGVUb2tlbjogdG9rZW4sXG4gICAgICAgICAgICB1c2VyRGF0YTogJHJvb3RTY29wZS5jdXJyZW50VXNlclxuICAgICAgICB9XG4gICAgICAgIFBheW1lbnQuY2hhcmdlTm93KGRhdGFPYmopLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXM6ICcsIHJlcy5kYXRhKTtcbiAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnZXJyOiAnLCBlcnIpO1xuICAgICAgICB9KVxuICAgIH1cbn1cblxuZnVuY3Rpb24gZGFzaGJvYXJkUGxhbkN0cmwoJHNjb3BlLCBBY2NvdW50LCAkc3RhdGVQYXJhbXMsICRzdGF0ZSwgUGxhbiwgJHJvb3RTY29wZSkge1xuICAgIGNvbnNvbGUubG9nKCdkYXNoYm9hcmRQbGFuQ3RybCBsb2FkZWQnKTtcblxuICAgIGlmICgkcm9vdFNjb3BlLmN1cnJlbnRTdGF0ZSA9PSAnZGFzaGJvYXJkX3BsYW5fc2luZ2xlJykge1xuICAgICAgICAkc2NvcGUudXBkYXRlVGltZXMgPSAodGltZXMpID0+IHtcbiAgICAgICAgICAgICRzY29wZS5pbnN0YWxsbWVudHNHcmFwaERhdGEgPSBbXVxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aW1lczsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGluc3RhbGxtZW50ID0gfn4oKCRzY29wZS5wbGFuLnRvdGFsIC8gdGltZXMpKTtcbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gfn4oMjAwICogKDIgLyB0aW1lcykpXG4gICAgICAgICAgICAgICAgJHNjb3BlLmluc3RhbGxtZW50c0dyYXBoRGF0YS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgcHJpY2U6IGluc3RhbGxtZW50LFxuICAgICAgICAgICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBgJHtoZWlnaHR9cHhgLFxuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IGA5MCVgXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgJHNjb3BlLmRlZmF1bHRQbGFuVGltZXMgPSAodGltZXMpID0+IHtcbiAgICAgICAgICAgIGlmICghdGltZXMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJHNjb3BlLnBsYW4udGltZXMgPSAzXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJHNjb3BlLnBsYW5cbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS5wcmV2aWV3U2luZ2xlUGxhbiA9IChwbGFuKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygncGxhbjogJywgcGxhbik7XG4gICAgICAgICAgICBQbGFuLmFkZFNpbmdsZVByZXZpZXcocGxhbikudGhlbihyZXMgPT4ge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnZGFzaGJvYXJkX3BsYW5fc2luZ2xlX3ByZXZpZXcnKVxuICAgICAgICAgICAgfSwgKGVycikgPT4gY29uc29sZS5sb2coJ2VyciBAYWRkU2luZ2xlUHJldmlldzogJywgZXJyKSlcbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS5wbGFuID0ge31cblxuICAgICAgICAkc2NvcGUuc2luZ2xlUGF5bWVudCA9ICgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiAoKCRzY29wZS5wbGFuLnRvdGFsIC0gJHNjb3BlLnBsYW4uZG93bnBheSkgLyAkc2NvcGUucGxhbi50aW1lcylcbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS5pbnRlcnZhbFNlbGVjdGVkID0gKGNob2ljZSkgPT4ge1xuICAgICAgICAgICAgaWYgKCRzY29wZS5wbGFuLmludGVydmFsID09IGNob2ljZSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5wbGFuLmludGVydmFsID0gbnVsbFxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUucGxhbi5pbnRlcnZhbCA9IGNob2ljZVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCRyb290U2NvcGUucHJldmlvdXNTdGF0ZSA9PSAnZGFzaGJvYXJkX3BsYW5fc2luZ2xlX3ByZXZpZXcnKSB7XG4gICAgICAgICAgICBQbGFuLmdldFNpbmdsZVByZXZpZXcoKS50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlcyBAZ2V0U2luZ2xlUHJldmlldyBkYXRhIGJhY2s6ICcsIHJlcylcbiAgICAgICAgICAgICAgICAkc2NvcGUucGxhbiA9IHJlcztcbiAgICAgICAgICAgICAgICAkc2NvcGUucGxhbi50aW1lcyA9IHJlcy50aW1lc1xuICAgICAgICAgICAgfSwgKGVycikgPT4gY29uc29sZS5sb2coJ2VyciBAZ2V0U2luZ2xlUHJldmlldzogJywgZXJyKSlcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmICgkcm9vdFNjb3BlLmN1cnJlbnRTdGF0ZSA9PSAnZGFzaGJvYXJkX3BsYW5fc2luZ2xlX3ByZXZpZXcnKSB7XG4gICAgICAgIFBsYW4uZ2V0U2luZ2xlUHJldmlldygpLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXMgQGdldFNpbmdsZVByZXZpZXc6ICcsIHJlcylcbiAgICAgICAgICAgICRzY29wZS5wbGFuUHJldmlldyA9IHJlcztcbiAgICAgICAgICAgICRzY29wZS5wbGFuUHJldmlldy5pbnN0YWxsbWVudCA9IChyZXMudG90YWwgLSByZXMuZG93bnBheSkgLyByZXMudGltZXNcbiAgICAgICAgfSwgKGVycikgPT4gY29uc29sZS5sb2coJ2VyciBAZ2V0U2luZ2xlUHJldmlldzogJywgZXJyKSlcblxuICAgICAgICAkc2NvcGUuc2F2ZVNpbmdsZVBsYW4gPSAocGxhbikgPT4ge1xuICAgICAgICAgICAgbGV0IHNhdmVTaW5nbGVQbGFuSW5mbyA9IHtcbiAgICAgICAgICAgICAgICBwbGFuRGV0YWlsczogcGxhbixcbiAgICAgICAgICAgICAgICBjcmVhdG9yOiAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnc2F2ZVNpbmdsZVBsYW5JbmZvOiAnLCBzYXZlU2luZ2xlUGxhbkluZm8pO1xuICAgICAgICAgICAgUGxhbi5zYXZlU2luZ2xlUGxhbihzYXZlU2luZ2xlUGxhbkluZm8pXG4gICAgICAgICAgICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlcyBAc2F2ZVNpbmdsZVBsYW46ICcsIHJlcy5kYXRhKVxuICAgICAgICAgICAgICAgICAgICAvLyAkc3RhdGUuZ28oJ2Rhc2hib2FyZF9wbGFuX3N0YXJ0JylcbiAgICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdkYXNoYm9hcmRfcGxhbl9zdGFydCcsIHt9LCB7IHJlbG9hZDogdHJ1ZSB9KTtcbiAgICAgICAgICAgICAgICB9LCAoZXJyKSA9PiBjb25zb2xlLmxvZygnZXJyIEBzYXZlU2luZ2xlUGxhbjogJywgZXJyKSlcbiAgICAgICAgfVxuICAgIH1cblxuICAgICRzY29wZS5nZXRBbGxQbGFucyA9ICgpID0+IHtcbiAgICAgICAgbGV0IGN1cnJlbnRVc2VySWQgPSAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyLl9pZFxuICAgICAgICBjb25zb2xlLmxvZygnY3VycmVudFVzZXJJZDogJywgY3VycmVudFVzZXJJZCk7XG4gICAgfVxuXG4gICAgaWYgKCRyb290U2NvcGUuY3VycmVudFN0YXRlID09ICdkYXNoYm9hcmRfcGxhbl9kZXRhaWxzJykge1xuICAgICAgICBQbGFuLmdldFNpbmdsZVBsYW4oJHN0YXRlLnBhcmFtcy5wbGFuSWQpXG4gICAgICAgICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXMgQGdldFNpbmdsZVBsYW46ICcsIHJlcy5kYXRhLmRhdGEpXG4gICAgICAgICAgICAgICAgJHNjb3BlLnBsYW4gPSByZXMuZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgIC8vIGlmKHJlcy5kYXRhLmRhdGEuY3JlYXRvcil7XG4gICAgICAgICAgICAgICAgLy8gICAgIHJldHVyblxuICAgICAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgIH0sIChlcnIpID0+IGNvbnNvbGUubG9nKCdlcnIgQHNhdmVTaW5nbGVQbGFuOiAnLCBlcnIpKVxuICAgIH1cblxufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
