"use strict";function init(){console.log("jquery loaded"),sticky(),windowScrollDown()}function sticky(){$(".sticky").sticky({topSpacing:60})}function windowScrollDown(){var e,o=0;$(window).scroll(function(){e=$(this).scrollTop(),o>e?($(".home-page nav").removeClass("folded"),$(".home-page nav").css("border-bottom","0px solid")):$(".home-page nav").addClass("folded"),o=e,$(window).scrollTop()<1&&$(".home-page nav").addClass("top"),$(window).scrollTop()>1&&$(".home-page nav").removeClass("top"),$(window).scrollTop()>30,$(window).scrollTop()<540&&$(".home-page nav").css("box-shadow","inset 0 -1px 0px 0px rgba(0,0,0,0)"),$(window).scrollTop()>540&&$(".home-page nav").css("box-shadow","inset 0 -1px 0px 0px rgba(0,0,0,0.1)")})}function Account(e){this.getCurrentUser=function(){return e({method:"GET",url:"/api/users/own"})},this.getUserData=function(o){return e({method:"GET",url:"/api/users/"+o})},this.updateUserData=function(o,t){return e({method:"PUT",url:"/api/users/"+o,data:t})},this.follow=function(o,t){return e({method:"PUT",url:"/api/users/event/follow",data:{currentUser:o,followTarget:t}})}}function Project(e){this.createOne=function(o){return e({method:"POST",url:"/api/projects/",data:o})},this.getAll=function(){return e({method:"GET",url:"/api/projects/all"})},this.getOnePorject=function(o){return e({method:"GET",url:"/api/projects/"+o})},this.deleteOne=function(o){return e({method:"DELETE",url:"/api/projects/"+o})},this.deleteOne=function(o){return e({method:"DELETE",url:"/api/projects/"+o})},this.like=function(o,t){return e({method:"PUT",url:"/api/projects/event/like",data:{projectId:o,likerId:t}})}}function focus(e,o){return function(t){o(function(){e.$broadcast("focusOn",t)},0)}}function homeCtrl(){console.log("homeCtrl loaded")}function projectSettingCtrl(e,o,t,n,r,l){console.log("projectSettingCtrl loaded");var c=!1,i=t.projectId;n.getOnePorject(i).then(function(o){console.log("projects: ",o.data),e.project=o.data,e.updateProjectData=e.project,e.project.author.forEach(function(o){o._id==e.currentUser._id&&(c=!0)}),c?console.log("isAuthor"):(console.log("is not Author"),r.go("home"))},function(e){console.log("err when get this project: ",e)}),e.request={people:[],supply:[],money:[]},e.init=function(){var e=l.$$path.includes("danger")||l.$$path.includes("request")||l.$$path.includes("privacy");e||r.go("projectSetting_general")},e.addChoiceToPeople=function(o){-1!==e.request.people.indexOf(o)?e.request.people.splice(e.request.people.indexOf(o),1):e.request.people.push(o),console.log(e.request.people)},e.addChoiceToSupply=function(o){-1!==e.request.supply.indexOf(o)?e.request.supply.splice(e.request.supply.indexOf(o),1):e.request.supply.push(o),console.log(e.request.supply)},e.addChoiceToMoney=function(o){-1!==e.request.money.indexOf(o)?(e.request.money.splice(e.request.money.indexOf(o),1),e.request.money=[]):(e.request.money=[],e.request.money.push(o)),console.log(e.request.money)},e.deleteProject=function(o){if(e.deleteProjectInput==o){var l=t.projectId;n.deleteOne(l).then(function(o){console.log("project deleted"),console.log("res: ",o.data),r.go("ppage",{userId:e.currentUser._id})},function(e){console.log("user is not logged in.")})}else console.log("no")},e.dangerNotified=!1,e.dangerNotifty=function(){e.dangerNotified=!e.dangerNotified},e.sameToTheProjectName=function(o){return e.deleteProjectInput==o},e.okayToDelete=function(o){return console.log("$scope.dangerNotified: ",e.dangerNotified),e.deleteProjectInput==o&&e.dangerNotified}}function projectpageCtrl(e,o,t,n){console.log("projectpageCtrl loaded"),e.state={},e.state.isAuthor=!1;var r=t.projectId;n.getOnePorject(r).then(function(o){console.log("projectData: ",o.data),e.project=o.data,console.log("$scope.currentUser._id: ",e.currentUser._id),console.log("$scope.project.author: ",e.project.author);var t=o.data.author;for(var n in t)if(e.currentUser._id==t[n]._id)return e.state.isAuthor=!0},function(e){console.log("err when get this project: ",e)}),e.like=function(o,t){console.log(o,"clicks likeBtn of",t),e.state.isAuthor&&(console.log("likeEvent triggered"),n.like(t,o).then(function(e){console.log("res: ",e)},function(e){console.log("err when like/unlike: ",e)}))}}function profileSettingCtrl(e,o,t,n,r,l,c,i){console.log("profileSettingCtrl loaded"),t.userId==e.currentUser._id?e.updateUserData=angular.copy(e.currentUser):r.go("home"),e.init=function(){var e=i.$$path.includes("danger")||i.$$path.includes("request")||i.$$path.includes("privacy");e||r.go("profileSetting_general")},e.updateUserDataSubmitted=function(){var o=e.updateUserData._id,t=e.updateUserData;n.updateUserData(o,t).then(function(o){e.updateUserData=o.data,l.location.reload()},function(e){console.log("err when get update user data: ",e)})},e.photoUploading=!1,e.uploadFiles=function(o){e.photoUploading=!0;var o=o[0],t=e.currentUser._id;console.log("photo: ",o),o&&c.upload({url:"/api/upload/"+t,data:{newFile:o}}).then(function(e){console.log("res after upload: ",e.data),l.location.reload()},function(e){console.log("err when upload file: ",e)})}}function ppageCtrl(e,o,t,n,r,l,c,i){function a(){var e=i.$$path.includes("starred")||i.$$path.includes("followers");e||o.go("ppage_projects")}console.log("ppageCtrl loaded"),e.state={},e.state.isTheUser=!1,e.state.followStatus=!1;var s,u=n.userId;u==e.currentUser._id&&(e.state.isTheUser=!0),e.state.isTheUser?console.log("isTheUser"):console.log("is not TheUser"),e.init=function(){a()},l.getUserData(u).then(function(o){e.user=o.data,s=o.data,e.projects=o.data.projects.reverse(),console.log("cards here: ",o.data.projects),c(function(){p()},0)},function(e){console.log("err when get userData: ",e)}),e.createTime=function(e){return moment(e).fromNow()},e.follow=function(o,t){console.log("ffffff"),console.log(o,t),o!==t&&t==u&&(console.log("followEvent triggered"),l.follow(o,t).then(function(o){if(console.log("res: ",o),"follow"==o.data.eventType){console.log("check"),console.log("follwing: res, ",o.data);var t=o.data.follower;o.data.followingReceiver;e.user.followersList.push(t),p()}else if("unfollow"==o.data.eventType){console.log("check"),console.log("unfollwing: res, ",o.data);var n=(o.data.unfollower,o.data.unfollowingReceiver,e.user.followersList.indexOf(t));e.user.followersList.splice(n,1),p()}},function(e){console.log("err when follow/unfollow: ",e)}))};var p=function(){if(console.log("checkFollowStatus trigerred"),console.log("displayUser: ",s),s.followersList.length>0){var o=s.followersList;console.log("checked");for(var t in o)console.log("currentUser: ",e.currentUser._id),console.log("followersList[follower]._id: ",o[t]._id),o[t]._id==e.currentUser._id?e.state.followStatus=!0:e.state.followStatus=!1}else e.state.followStatus=!1}}function navCtrl(e,o,t,n,r,l,c,i,a,s,u){o.currentUser="",o.loginloading=!1,o.logoutloading=!1,r.hideNav=!1,r.createModal=!1,o.authenticate=function(e){o.loginloading=!0,t.authenticate(e).then(function(e){n.getCurrentUser().then(function(e){console.log("user logged in: ",e.data),o.currentUser=e.data,o.loginloading=!1,console.log("$scope.currentUser._id: ",o.currentUser._id),"home"==i.current.name?i.go("ppage",{userId:o.currentUser._id}):c.location.reload()},function(e){console.log("user is not logged in.")})},function(e){console.log("err when log user in: ",e)})},t.isAuthenticated()&&n.getCurrentUser().then(function(e){o.currentUser=e.data,console.log("navCtrl triggered and currentUser: ",o.currentUser)},function(e){console.log("user is not logged in.")}),o.isAuthenticated=function(){return t.isAuthenticated()},o.logout=function(){o.logoutloading=!0,t.logout(),l(function(){o.logoutloading=!1,c.location.reload()},0)},o.goppage=function(){console.log("$location.$$path: ",u.$$path),u.$$path.includes("projects")?c.location.reload():i.go("ppage",{userId:o.currentUser._id})},o.create=function(){o.projectInitalizing=!1,o.newProjectName="",o.newProjectPitch="",o.createModal=!0,l(function(){a("focusMe")},100)},o.createProject=function(){o.projectInitalizing=!0,console.log("create project called: ",o.newProjectName);var e={title:o.newProjectName,pitch:o.newProjectPitch};s.createOne(e).then(function(e){console.log("add new behavior[createNewProject]: ",e.data),l(function(){o.projectInitalizing=!1,o.createModal=!1,"ppage"==i.current.name?c.location.reload():i.go("ppage",{userId:o.currentUser._id})},1500*Math.random()+300)},function(e){console.log("err when create project: ",e)})}}function focusOn(){return function(e,o,t){e.$on("focusOn",function(e,n){n===t.focusOn&&o[0].focus()})}}function toolTip(){return function(e,o,t){angular.element(".tool-tip").on("click mouseleave",hideTooltip),angular.element(".tool-tip").on("mouseenter",showTooltip)}}function hideTooltip(){$(this).tooltip("hide")}function showTooltip(){$(this).tooltip("show")}angular.module("pinchApp",["ui.router","satellizer","ngFileUpload","ngImgCrop"]).config(["$stateProvider","$urlRouterProvider","$authProvider",function(e,o,t){t.facebook({clientId:"298165113849366"}),e.state(home),o.otherwise("/")}]);var home={name:"home",url:"/",views:{main:{templateUrl:"/html/home.html",controller:"homeCtrl"}}};$(document).ready(init),Account.$inject=["$http"],Project.$inject=["$http"],focus.$inject=["$rootScope","$timeout"],angular.module("pinchApp").service("Account",Account).service("Project",Project).factory("focus",focus),navCtrl.$inject=["$http","$scope","$auth","Account","$rootScope","$timeout","$window","$state","focus","Project","$location"],ppageCtrl.$inject=["$scope","$state","$rootScope","$stateParams","Project","Account","$timeout","$location"],profileSettingCtrl.$inject=["$scope","$http","$stateParams","Account","$state","$window","Upload","$location"],projectpageCtrl.$inject=["$scope","$http","$stateParams","Project"],projectSettingCtrl.$inject=["$scope","$http","$stateParams","Project","$state","$location"],angular.module("pinchApp").controller("navCtrl",navCtrl).controller("homeCtrl",homeCtrl).controller("ppageCtrl",ppageCtrl).controller("profileSettingCtrl",profileSettingCtrl).controller("projectpageCtrl",projectpageCtrl).controller("projectSettingCtrl",projectSettingCtrl),angular.module("pinchApp").directive("focusOn",focusOn),angular.module("pinchApp").directive("toolTip",toolTip);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFtb2R1bGUuanMiLCJtYWluLmpzIiwic2VydmljZXMuanMiLCJjb250cm9sbGVycy9jb250cm9sbGVycy5qcyIsImRpcmVjdGl2ZXMvZm9jdXNPbi5kaXJlY3RpdmUuanMiLCJkaXJlY3RpdmVzL3Rvb2xUaXAuZGlyZWN0aXZlLmpzIl0sIm5hbWVzIjpbImluaXQiLCJjb25zb2xlIiwibG9nIiwic3RpY2t5Iiwid2luZG93U2Nyb2xsRG93biIsIiQiLCJ0b3BTcGFjaW5nIiwic3QiLCJsYXN0U2Nyb2xsVG9wIiwid2luZG93Iiwic2Nyb2xsIiwidGhpcyIsInNjcm9sbFRvcCIsInJlbW92ZUNsYXNzIiwiY3NzIiwiYWRkQ2xhc3MiLCJBY2NvdW50IiwiJGh0dHAiLCJnZXRDdXJyZW50VXNlciIsIm1ldGhvZCIsInVybCIsImdldFVzZXJEYXRhIiwidXJpVXNlcklkIiwidXBkYXRlVXNlckRhdGEiLCJkYXRhIiwiZm9sbG93IiwiY3VycmVudFVzZXIiLCJmb2xsb3dUYXJnZXQiLCJQcm9qZWN0IiwiY3JlYXRlT25lIiwibmV3UG9qZWN0T2JqIiwiZ2V0QWxsIiwiZ2V0T25lUG9yamVjdCIsInByb2plY3RJZCIsImRlbGV0ZU9uZSIsImxpa2UiLCJsaWtlcklkIiwiZm9jdXMiLCIkcm9vdFNjb3BlIiwiJHRpbWVvdXQiLCJuYW1lIiwiJGJyb2FkY2FzdCIsImhvbWVDdHJsIiwicHJvamVjdFNldHRpbmdDdHJsIiwiJHNjb3BlIiwiJHN0YXRlUGFyYW1zIiwiJHN0YXRlIiwiJGxvY2F0aW9uIiwiaXNBdXRob3IiLCJ0aGVuIiwicmVzIiwicHJvamVjdCIsInVwZGF0ZVByb2plY3REYXRhIiwiYXV0aG9yIiwiZm9yRWFjaCIsIl9pZCIsImdvIiwiZXJyIiwicmVxdWVzdCIsInBlb3BsZSIsInN1cHBseSIsIm1vbmV5IiwiY2hlY2tVcmwiLCIkJHBhdGgiLCJpbmNsdWRlcyIsImFkZENob2ljZVRvUGVvcGxlIiwiaW5kZXhPZiIsInNwbGljZSIsInB1c2giLCJhZGRDaG9pY2VUb1N1cHBseSIsImFkZENob2ljZVRvTW9uZXkiLCJkZWxldGVQcm9qZWN0IiwicHJvamVjdEZ1bGxOYW1lIiwiZGVsZXRlUHJvamVjdElucHV0IiwiX3Byb2plY3RJZCIsInVzZXJJZCIsImRhbmdlck5vdGlmaWVkIiwiZGFuZ2VyTm90aWZ0eSIsInNhbWVUb1RoZVByb2plY3ROYW1lIiwib2theVRvRGVsZXRlIiwicHJvamVjdHBhZ2VDdHJsIiwic3RhdGUiLCJhdXRob3JzIiwicHJvZmlsZVNldHRpbmdDdHJsIiwiJHdpbmRvdyIsIlVwbG9hZCIsImFuZ3VsYXIiLCJjb3B5IiwidXBkYXRlVXNlckRhdGFTdWJtaXR0ZWQiLCJsb2NhdGlvbiIsInJlbG9hZCIsInBob3RvVXBsb2FkaW5nIiwidXBsb2FkRmlsZXMiLCJmaWxlIiwidXBsb2FkIiwibmV3RmlsZSIsInBwYWdlQ3RybCIsImNoZWNraW5nVXJsIiwiaXNUaGVVc2VyIiwiZm9sbG93U3RhdHVzIiwiZGlzcGxheVVzZXIiLCJ1c2VyIiwicHJvamVjdHMiLCJyZXZlcnNlIiwiY2hlY2tGb2xsb3dTdGF0dXMiLCJjcmVhdGVUaW1lIiwiY3JlYXRlQXRUaW1lIiwibW9tZW50IiwiZnJvbU5vdyIsImV2ZW50VHlwZSIsImZvbGxvd2VyIiwiZm9sbG93aW5nUmVjZWl2ZXIiLCJmb2xsb3dlcnNMaXN0IiwiaW5kZXgiLCJ1bmZvbGxvd2VyIiwidW5mb2xsb3dpbmdSZWNlaXZlciIsImxlbmd0aCIsIm5hdkN0cmwiLCIkYXV0aCIsImxvZ2lubG9hZGluZyIsImxvZ291dGxvYWRpbmciLCJoaWRlTmF2IiwiY3JlYXRlTW9kYWwiLCJhdXRoZW50aWNhdGUiLCJwcm92aWRlciIsImN1cnJlbnQiLCJpc0F1dGhlbnRpY2F0ZWQiLCJsb2dvdXQiLCJnb3BwYWdlIiwiY3JlYXRlIiwicHJvamVjdEluaXRhbGl6aW5nIiwibmV3UHJvamVjdE5hbWUiLCJuZXdQcm9qZWN0UGl0Y2giLCJjcmVhdGVQcm9qZWN0IiwidGl0bGUiLCJwaXRjaCIsIk1hdGgiLCJyYW5kb20iLCJmb2N1c09uIiwic2NvcGUiLCJlbGVtIiwiYXR0ciIsIiRvbiIsImUiLCJ0b29sVGlwIiwiZWxlbWVudCIsImF0dHJzIiwib24iLCJoaWRlVG9vbHRpcCIsInNob3dUb29sdGlwIiwidG9vbHRpcCIsIm1vZHVsZSIsImNvbmZpZyIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwiJGF1dGhQcm92aWRlciIsImZhY2Vib29rIiwiY2xpZW50SWQiLCJob21lIiwib3RoZXJ3aXNlIiwidmlld3MiLCJtYWluIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwiZG9jdW1lbnQiLCJyZWFkeSIsIiRpbmplY3QiLCJzZXJ2aWNlIiwiZmFjdG9yeSIsImRpcmVjdGl2ZSJdLCJtYXBwaW5ncyI6IkFBQUEsWUNJQSxTQUFTQSxRQUNMQyxRQUFRQyxJQUFJLGlCQUNaQyxTQUNBQyxtQkFHSixRQUFTRCxVQUNMRSxFQUFFLFdBQVdGLFFBQ1RHLFdBQVksS0FJcEIsUUFBU0Ysb0JBQ0wsR0FDSUcsR0FEQUMsRUFBZ0IsQ0FFcEJILEdBQUVJLFFBQVFDLE9BQU8sV0FFYkgsRUFBS0YsRUFBRU0sTUFBTUMsWUFDSkosRUFBTEQsR0FDQUYsRUFBRSxrQkFBa0JRLFlBQVksVUFDaENSLEVBQUUsa0JBQWtCUyxJQUFJLGdCQUFpQixjQUV6Q1QsRUFBRSxrQkFBa0JVLFNBQVMsVUFFakNQLEVBQWdCRCxFQUVaRixFQUFFSSxRQUFRRyxZQUFjLEdBQ3hCUCxFQUFFLGtCQUFrQlUsU0FBUyxPQUU3QlYsRUFBRUksUUFBUUcsWUFBYyxHQUN4QlAsRUFBRSxrQkFBa0JRLFlBQVksT0FFaENSLEVBQUVJLFFBQVFHLFlBQWMsR0FHeEJQLEVBQUVJLFFBQVFHLFlBQWMsS0FDeEJQLEVBQUUsa0JBQWtCUyxJQUFJLGFBQWMsc0NBRXRDVCxFQUFFSSxRQUFRRyxZQUFjLEtBQ3hCUCxFQUFFLGtCQUFrQlMsSUFBSSxhQUFjLDBDQ25DbEQsUUFBU0UsU0FBUUMsR0FDYk4sS0FBS08sZUFBaUIs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U0FBVSxRQUFTLFVBQVcsYUFBYyxXQUFZLFVBQVcsU0FBVSxRQUFTLFVBQVcsYUFDN0h0RSxVQUFVc0UsU0FBVyxTQUFVLFNBQVUsYUFBYyxlQUFnQixVQUFXLFVBQVcsV0FBWSxhQUN6R25GLG1CQUFtQm1GLFNBQVcsU0FBVSxRQUFTLGVBQWdCLFVBQVcsU0FBVSxVQUFXLFNBQVUsYUFDM0d0RixnQkFBZ0JzRixTQUFXLFNBQVUsUUFBUyxlQUFnQixXQUM5RDNILG1CQUFtQjJILFNBQVcsU0FBVSxRQUFTLGVBQWdCLFVBQVcsU0FBVSxhQUp0RmhGLFFBQ0tpRSxPQUFPLFlBQ1BZLFdBQVcsVUFBVzlDLFNBQ3RCOEMsV0FBVyxXQUFZekgsVUFDdkJ5SCxXQUFXLFlBQWFuRSxXQUN4Qm1FLFdBQVcscUJBQXNCaEYsb0JBQ2pDZ0YsV0FBVyxrQkFBbUJuRixpQkFDOUJtRixXQUFXLHFCQUFzQnhILG9CQ1B0QzJDLFFBQ0tpRSxPQUFPLFlBQ1BrQixVQUFVLFVBQVcvQixTQ0YxQnBELFFBQ0tpRSxPQUFPLFlBQ1BrQixVQUFVLFVBQVd6QiIsImZpbGUiOiJidW5kbGUubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5hbmd1bGFyXG4gICAgLm1vZHVsZSgncGluY2hBcHAnLCBbXG4gICAgICAgICd1aS5yb3V0ZXInLFxuICAgICAgICAnc2F0ZWxsaXplcicsXG4gICAgICAgIC8vICd1aS5ib290c3RyYXAnLFxuICAgICAgICAnbmdGaWxlVXBsb2FkJyxcbiAgICAgICAgJ25nSW1nQ3JvcCdcbiAgICBdKVxuICAgIC5jb25maWcoZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlciwgJGF1dGhQcm92aWRlcikge1xuXG4gICAgJGF1dGhQcm92aWRlclxuICAgICAgICAuZmFjZWJvb2soe1xuICAgICAgICAgICAgY2xpZW50SWQ6ICcyOTgxNjUxMTM4NDkzNjYnXG4gICAgICAgIH0pO1xuXG4gICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgLnN0YXRlKGhvbWUpXG4gICAgICAgIC8vIC5zdGF0ZShwcGFnZSlcbiAgICAgICAgLy8gLnN0YXRlKHBwYWdlX3Byb2plY3RzKVxuICAgICAgICAvLyAuc3RhdGUocHBhZ2VfbGlrZWQpXG4gICAgICAgIC8vIC5zdGF0ZShwcGFnZV9mb2xsb3dlcnMpXG4gICAgICAgIC8vIC5zdGF0ZShwcm9qZWN0cGFnZSlcbiAgICAgICAgLy8gLnN0YXRlKHByb2plY3RTZXR0aW5nKVxuICAgICAgICAvLyAuc3RhdGUocHJvamVjdFNldHRpbmdfZ2VuZXJhbClcbiAgICAgICAgLy8gLnN0YXRlKHByb2plY3RTZXR0aW5nX3JlcXVlc3QpXG4gICAgICAgIC8vIC5zdGF0ZShwcm9qZWN0U2V0dGluZ19wcml2YWN5KVxuICAgICAgICAvLyAuc3RhdGUocHJvamVjdFNldHRpbmdfZGFuZ2VyKVxuICAgICAgICAvLyAuc3RhdGUocHJvZmlsZVNldHRpbmcpXG4gICAgICAgIC8vIC5zdGF0ZShwcm9maWxlU2V0dGluZ19nZW5lcmFsKVxuICAgICAgICAvLyAuc3RhdGUocHJvZmlsZVNldHRpbmdfcmVxdWVzdClcbiAgICAgICAgLy8gLnN0YXRlKHByb2ZpbGVTZXR0aW5nX3ByaXZhY3kpXG4gICAgICAgIC8vIC5zdGF0ZShwcm9maWxlU2V0dGluZ19kYW5nZXIpXG5cblxuICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcbn0pO1xuXG5cbmxldCBob21lID0ge1xuICAgIG5hbWU6ICdob21lJyxcbiAgICB1cmw6ICcvJyxcbiAgICB2aWV3czoge1xuICAgICAgICBtYWluOiB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL2hvbWUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnaG9tZUN0cmwnXG4gICAgICAgIH1cbiAgICB9XG59XG4vLyBsZXQgcHBhZ2UgPSB7XG4vLyAgICAgbmFtZTogJ3BwYWdlJyxcbi8vICAgICB1cmw6ICcvbS86dXNlcklkJyxcbi8vICAgICB2aWV3czoge1xuLy8gICAgICAgICAnbWFpbic6IHtcbi8vICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvcHBhZ2UuaHRtbCcsXG4vLyAgICAgICAgICAgICBjb250cm9sbGVyOiAncHBhZ2VDdHJsJ1xuLy8gICAgICAgICB9LFxuLy8gICAgICAgICAncmlnaHRfc2VjdGlvbic6IHtcbi8vICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvcHBhZ2VfcHJvamVjdHMuaHRtbCcsXG4vLyAgICAgICAgICAgICBjb250cm9sbGVyOiAncHBhZ2VDdHJsJ1xuLy8gICAgICAgICB9XG4vLyAgICAgfVxuLy8gfVxuLy9cbi8vIGxldCBwcGFnZV9wcm9qZWN0cyA9IHtcbi8vICAgICBuYW1lOiAncHBhZ2VfcHJvamVjdHMnLFxuLy8gICAgIHVybDogJy9wcm9qZWN0cycsXG4vLyAgICAgcGFyZW50OiAncHBhZ2UnLFxuLy8gICAgIHZpZXdzOiB7XG4vLyAgICAgICAgIHJpZ2h0X3NlY3Rpb246IHtcbi8vICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvcHBhZ2VfcHJvamVjdHMuaHRtbCcsXG4vLyAgICAgICAgICAgICBjb250cm9sbGVyOiAncHBhZ2VDdHJsJ1xuLy8gICAgICAgICB9XG4vLyAgICAgfVxuLy8gfVxuLy8gbGV0IHBwYWdlX2xpa2VkID0ge1xuLy8gICAgIG5hbWU6ICdwcGFnZV9saWtlZCcsXG4vLyAgICAgdXJsOiAnL2xpa2VkJyxcbi8vICAgICBwYXJlbnQ6ICdwcGFnZScsXG4vLyAgICAgdmlld3M6IHtcbi8vICAgICAgICAgcmlnaHRfc2VjdGlvbjoge1xuLy8gICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9wcGFnZV9saWtlZC5odG1sJyxcbi8vICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwcGFnZUN0cmwnXG4vLyAgICAgICAgIH1cbi8vICAgICB9XG4vLyB9XG4vLyBsZXQgcHBhZ2VfZm9sbG93ZXJzID0ge1xuLy8gICAgIG5hbWU6ICdwcGFnZV9mb2xsb3dlcnMnLFxuLy8gICAgIHVybDogJy9mb2xsb3dlcnMnLFxuLy8gICAgIHBhcmVudDogJ3BwYWdlJyxcbi8vICAgICB2aWV3czoge1xuLy8gICAgICAgICByaWdodF9zZWN0aW9uOiB7XG4vLyAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL3BwYWdlX2ZvbGxvd2Vycy5odG1sJyxcbi8vICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwcGFnZUN0cmwnXG4vLyAgICAgICAgIH1cbi8vICAgICB9XG4vLyB9XG4vLyBsZXQgcHJvamVjdHBhZ2UgPSB7XG4vLyAgICAgbmFtZTogJ3Byb2plY3RwYWdlJyxcbi8vICAgICB1cmw6ICcvOnByb2plY3RJZCcsXG4vLyAgICAgdmlld3M6IHtcbi8vICAgICAgICAgbWFpbjoge1xuLy8gICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9wcm9qZWN0cGFnZS5odG1sJyxcbi8vICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwcm9qZWN0cGFnZUN0cmwnXG4vLyAgICAgICAgIH1cbi8vICAgICB9XG4vLyB9XG4vLyBsZXQgcHJvamVjdFNldHRpbmcgPSB7XG4vLyAgICAgbmFtZTogJ3Byb2plY3RTZXR0aW5nJyxcbi8vICAgICB1cmw6ICcvcHJvamVjdC86cHJvamVjdElkL3NldHRpbmcnLFxuLy8gICAgIHZpZXdzOiB7XG4vLyAgICAgICAgIG1haW46IHtcbi8vICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvcHJvamVjdFNldHRpbmcuaHRtbCcsXG4vLyAgICAgICAgICAgICBjb250cm9sbGVyOiAncHJvamVjdFNldHRpbmdDdHJsJ1xuLy8gICAgICAgICB9XG4vLyAgICAgfVxuLy8gfVxuLy8gbGV0IHByb2plY3RTZXR0aW5nX2dlbmVyYWwgPSB7XG4vLyAgICAgbmFtZTogJ3Byb2plY3RTZXR0aW5nX2dlbmVyYWwnLFxuLy8gICAgIHVybDogJy9nZW5lcmFsJyxcbi8vICAgICBwYXJlbnQ6ICdwcm9qZWN0U2V0dGluZycsXG4vLyAgICAgdmlld3M6IHtcbi8vICAgICAgICAgcmlnaHRfc2VjdGlvbjoge1xuLy8gICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9wcm9qZWN0U2V0dGluZ19nZW5lcmFsLmh0bWwnLFxuLy8gICAgICAgICAgICAgY29udHJvbGxlcjogJ3Byb2plY3RTZXR0aW5nQ3RybCdcbi8vICAgICAgICAgfVxuLy8gICAgIH1cbi8vIH1cbi8vIGxldCBwcm9qZWN0U2V0dGluZ19yZXF1ZXN0ID0ge1xuLy8gICAgIG5hbWU6ICdwcm9qZWN0U2V0dGluZ19yZXF1ZXN0Jyxcbi8vICAgICB1cmw6ICcvcmVxdWVzdCcsXG4vLyAgICAgcGFyZW50OiAncHJvamVjdFNldHRpbmcnLFxuLy8gICAgIHZpZXdzOiB7XG4vLyAgICAgICAgIHJpZ2h0X3NlY3Rpb246IHtcbi8vICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvcHJvamVjdFNldHRpbmdfcmVxdWVzdC5odG1sJyxcbi8vICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwcm9qZWN0U2V0dGluZ0N0cmwnXG4vLyAgICAgICAgIH1cbi8vICAgICB9XG4vLyB9XG4vLyBsZXQgcHJvamVjdFNldHRpbmdfcHJpdmFjeSA9IHtcbi8vICAgICBuYW1lOiAncHJvamVjdFNldHRpbmdfcHJpdmFjeScsXG4vLyAgICAgdXJsOiAnL3ByaXZhY3knLFxuLy8gICAgIHBhcmVudDogJ3Byb2plY3RTZXR0aW5nJyxcbi8vICAgICB2aWV3czoge1xuLy8gICAgICAgICByaWdodF9zZWN0aW9uOiB7XG4vLyAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL3Byb2plY3RTZXR0aW5nX3ByaXZhY3kuaHRtbCcsXG4vLyAgICAgICAgICAgICBjb250cm9sbGVyOiAncHJvamVjdFNldHRpbmdDdHJsJ1xuLy8gICAgICAgICB9XG4vLyAgICAgfVxuLy8gfVxuLy8gbGV0IHByb2plY3RTZXR0aW5nX2RhbmdlciA9IHtcbi8vICAgICBuYW1lOiAncHJvamVjdFNldHRpbmdfZGFuZ2VyJyxcbi8vICAgICB1cmw6ICcvZGFuZ2VyJyxcbi8vICAgICBwYXJlbnQ6ICdwcm9qZWN0U2V0dGluZycsXG4vLyAgICAgdmlld3M6IHtcbi8vICAgICAgICAgcmlnaHRfc2VjdGlvbjoge1xuLy8gICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9wcm9qZWN0U2V0dGluZ19kYW5nZXIuaHRtbCcsXG4vLyAgICAgICAgICAgICBjb250cm9sbGVyOiAncHJvamVjdFNldHRpbmdDdHJsJ1xuLy8gICAgICAgICB9XG4vLyAgICAgfVxuLy8gfVxuLy8gbGV0IHByb2ZpbGVTZXR0aW5nID0ge1xuLy8gICAgIG5hbWU6ICdwcm9maWxlU2V0dGluZycsXG4vLyAgICAgdXJsOiAnL3VzZXIvOnVzZXJJZC9zZXR0aW5nJyxcbi8vICAgICB2aWV3czoge1xuLy8gICAgICAgICBtYWluOiB7XG4vLyAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL3Byb2ZpbGVTZXR0aW5nLmh0bWwnLFxuLy8gICAgICAgICAgICAgY29udHJvbGxlcjogJ3Byb2ZpbGVTZXR0aW5nQ3RybCdcbi8vICAgICAgICAgfVxuLy8gICAgIH1cbi8vIH1cbi8vIGxldCBwcm9maWxlU2V0dGluZ19nZW5lcmFsID0ge1xuLy8gICAgIG5hbWU6ICdwcm9maWxlU2V0dGluZ19nZW5lcmFsJyxcbi8vICAgICB1cmw6ICcvZ2VuZXJhbCcsXG4vLyAgICAgcGFyZW50OiAncHJvZmlsZVNldHRpbmcnLFxuLy8gICAgIHZpZXdzOiB7XG4vLyAgICAgICAgIHJpZ2h0X3NlY3Rpb246IHtcbi8vICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvcHJvZmlsZVNldHRpbmdfZ2VuZXJhbC5odG1sJyxcbi8vICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwcm9maWxlU2V0dGluZ0N0cmwnXG4vLyAgICAgICAgIH1cbi8vICAgICB9XG4vLyB9XG4vLyBsZXQgcHJvZmlsZVNldHRpbmdfcmVxdWVzdCA9IHtcbi8vICAgICBuYW1lOiAncHJvZmlsZVNldHRpbmdfcmVxdWVzdCcsXG4vLyAgICAgdXJsOiAnL3JlcXVlc3QnLFxuLy8gICAgIHBhcmVudDogJ3Byb2ZpbGVTZXR0aW5nJyxcbi8vICAgICB2aWV3czoge1xuLy8gICAgICAgICByaWdodF9zZWN0aW9uOiB7XG4vLyAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL3Byb2ZpbGVTZXR0aW5nX3JlcXVlc3QuaHRtbCcsXG4vLyAgICAgICAgICAgICBjb250cm9sbGVyOiAncHJvZmlsZVNldHRpbmdDdHJsJ1xuLy8gICAgICAgICB9XG4vLyAgICAgfVxuLy8gfVxuLy8gbGV0IHByb2ZpbGVTZXR0aW5nX3ByaXZhY3kgPSB7XG4vLyAgICAgbmFtZTogJ3Byb2ZpbGVTZXR0aW5nX3ByaXZhY3knLFxuLy8gICAgIHVybDogJy9wcml2YWN5Jyxcbi8vICAgICBwYXJlbnQ6ICdwcm9maWxlU2V0dGluZycsXG4vLyAgICAgdmlld3M6IHtcbi8vICAgICAgICAgcmlnaHRfc2VjdGlvbjoge1xuLy8gICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9wcm9maWxlU2V0dGluZ19wcml2YWN5Lmh0bWwnLFxuLy8gICAgICAgICAgICAgY29udHJvbGxlcjogJ3Byb2ZpbGVTZXR0aW5nQ3RybCdcbi8vICAgICAgICAgfVxuLy8gICAgIH1cbi8vIH1cbi8vIGxldCBwcm9maWxlU2V0dGluZ19kYW5nZXIgPSB7XG4vLyAgICAgICAgIG5hbWU6ICdwcm9maWxlU2V0dGluZ19kYW5nZXInLFxuLy8gICAgICAgICB1cmw6ICcvZGFuZ2VyJyxcbi8vICAgICAgICAgcGFyZW50OiAncHJvZmlsZVNldHRpbmcnLFxuLy8gICAgICAgICB2aWV3czoge1xuLy8gICAgICAgICAgICAgcmlnaHRfc2VjdGlvbjoge1xuLy8gICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvcHJvZmlsZVNldHRpbmdfZGFuZ2VyLmh0bWwnLFxuLy8gICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwcm9maWxlU2V0dGluZ0N0cmwnXG4vLyAgICAgICAgICAgICB9XG4vLyAgICAgICAgIH1cbi8vICAgICB9XG4iLCIndXNlIHN0cmljdCdcblxuJChkb2N1bWVudCkucmVhZHkoaW5pdCk7XG5cbmZ1bmN0aW9uIGluaXQoKSB7XG4gICAgY29uc29sZS5sb2coJ2pxdWVyeSBsb2FkZWQnKTtcbiAgICBzdGlja3koKVxuICAgIHdpbmRvd1Njcm9sbERvd24oKVxufVxuXG5mdW5jdGlvbiBzdGlja3koKSB7XG4gICAgJChcIi5zdGlja3lcIikuc3RpY2t5KHtcbiAgICAgICAgdG9wU3BhY2luZzogNjBcbiAgICB9KVxufVxuXG5mdW5jdGlvbiB3aW5kb3dTY3JvbGxEb3duKCkge1xuICAgIHZhciBsYXN0U2Nyb2xsVG9wID0gMFxuICAgIHZhciBzdFxuICAgICQod2luZG93KS5zY3JvbGwoZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCQod2luZG93KS5zY3JvbGxUb3AoKSk7XG4gICAgICAgIHN0ID0gJCh0aGlzKS5zY3JvbGxUb3AoKTtcbiAgICAgICAgaWYgKHN0IDwgbGFzdFNjcm9sbFRvcCkge1xuICAgICAgICAgICAgJCgnLmhvbWUtcGFnZSBuYXYnKS5yZW1vdmVDbGFzcygnZm9sZGVkJylcbiAgICAgICAgICAgICQoJy5ob21lLXBhZ2UgbmF2JykuY3NzKCdib3JkZXItYm90dG9tJywgJzBweCBzb2xpZCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJCgnLmhvbWUtcGFnZSBuYXYnKS5hZGRDbGFzcygnZm9sZGVkJylcbiAgICAgICAgfVxuICAgICAgICBsYXN0U2Nyb2xsVG9wID0gc3RcblxuICAgICAgICBpZiAoJCh3aW5kb3cpLnNjcm9sbFRvcCgpIDwgMSkge1xuICAgICAgICAgICAgJCgnLmhvbWUtcGFnZSBuYXYnKS5hZGRDbGFzcygndG9wJylcbiAgICAgICAgfVxuICAgICAgICBpZiAoJCh3aW5kb3cpLnNjcm9sbFRvcCgpID4gMSkge1xuICAgICAgICAgICAgJCgnLmhvbWUtcGFnZSBuYXYnKS5yZW1vdmVDbGFzcygndG9wJylcbiAgICAgICAgfVxuICAgICAgICBpZiAoJCh3aW5kb3cpLnNjcm9sbFRvcCgpID4gMzApIHtcblxuICAgICAgICB9XG4gICAgICAgIGlmICgkKHdpbmRvdykuc2Nyb2xsVG9wKCkgPCA1NDApIHtcbiAgICAgICAgICAgICQoJy5ob21lLXBhZ2UgbmF2JykuY3NzKCdib3gtc2hhZG93JywgJ2luc2V0IDAgLTFweCAwcHggMHB4IHJnYmEoMCwwLDAsMCknKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoJCh3aW5kb3cpLnNjcm9sbFRvcCgpID4gNTQwKSB7XG4gICAgICAgICAgICAkKCcuaG9tZS1wYWdlIG5hdicpLmNzcygnYm94LXNoYWRvdycsICdpbnNldCAwIC0xcHggMHB4IDBweCByZ2JhKDAsMCwwLDAuMSknKTtcbiAgICAgICAgfVxuXG4gICAgfSlcbn1cbiIsIid1c2Ugc3RyaWN0JztcblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ3BpbmNoQXBwJylcbiAgICAuc2VydmljZSgnQWNjb3VudCcsIEFjY291bnQpXG4gICAgLnNlcnZpY2UoJ1Byb2plY3QnLCBQcm9qZWN0KVxuICAgIC5mYWN0b3J5KCdmb2N1cycsIGZvY3VzKVxuXG5mdW5jdGlvbiBBY2NvdW50KCRodHRwKSB7XG4gICAgdGhpcy5nZXRDdXJyZW50VXNlciA9ICgpID0+IHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICB1cmw6ICcvYXBpL3VzZXJzL293bidcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHRoaXMuZ2V0VXNlckRhdGEgPSAodXJpVXNlcklkKSA9PiB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgdXJsOiBgL2FwaS91c2Vycy8ke3VyaVVzZXJJZH1gXG4gICAgICAgIH0pXG4gICAgfVxuICAgIHRoaXMudXBkYXRlVXNlckRhdGEgPSAodXJpVXNlcklkLCB1cGRhdGVVc2VyRGF0YSkgPT4ge1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUFVUJyxcbiAgICAgICAgICAgIHVybDogYC9hcGkvdXNlcnMvJHt1cmlVc2VySWR9YCxcbiAgICAgICAgICAgIGRhdGE6IHVwZGF0ZVVzZXJEYXRhXG4gICAgICAgIH0pXG4gICAgfVxuICAgIHRoaXMuZm9sbG93ID0gKGN1cnJlbnRVc2VyLCBmb2xsb3dUYXJnZXQpID0+IHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BVVCcsXG4gICAgICAgICAgICB1cmw6IGAvYXBpL3VzZXJzL2V2ZW50L2ZvbGxvd2AsXG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgY3VycmVudFVzZXI6IGN1cnJlbnRVc2VyLFxuICAgICAgICAgICAgICAgIGZvbGxvd1RhcmdldDogZm9sbG93VGFyZ2V0XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxufVxuXG5mdW5jdGlvbiBQcm9qZWN0KCRodHRwKSB7XG4gICAgdGhpcy5jcmVhdGVPbmUgPSAobmV3UG9qZWN0T2JqKSA9PiB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIHVybDogJy9hcGkvcHJvamVjdHMvJyxcbiAgICAgICAgICAgIGRhdGE6IG5ld1BvamVjdE9ialxuICAgICAgICB9KVxuICAgIH1cbiAgICB0aGlzLmdldEFsbCA9ICgpID0+IHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICB1cmw6ICcvYXBpL3Byb2plY3RzL2FsbCdcbiAgICAgICAgfSlcbiAgICB9XG4gICAgdGhpcy5nZXRPbmVQb3JqZWN0ID0gKHByb2plY3RJZCkgPT4ge1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgIHVybDogYC9hcGkvcHJvamVjdHMvJHtwcm9qZWN0SWR9YFxuICAgICAgICB9KVxuICAgIH1cbiAgICB0aGlzLmRlbGV0ZU9uZSA9IChwcm9qZWN0SWQpID0+IHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICAgICAgICB1cmw6IGAvYXBpL3Byb2plY3RzLyR7cHJvamVjdElkfWBcbiAgICAgICAgfSlcbiAgICB9XG4gICAgdGhpcy5kZWxldGVPbmUgPSAocHJvamVjdElkKSA9PiB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdERUxFVEUnLFxuICAgICAgICAgICAgdXJsOiBgL2FwaS9wcm9qZWN0cy8ke3Byb2plY3RJZH1gXG4gICAgICAgIH0pXG4gICAgfVxuICAgIHRoaXMubGlrZSA9IChwcm9qZWN0SWQsIGxpa2VySWQpID0+IHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BVVCcsXG4gICAgICAgICAgICB1cmw6IGAvYXBpL3Byb2plY3RzL2V2ZW50L2xpa2VgLFxuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgIHByb2plY3RJZDogcHJvamVjdElkLFxuICAgICAgICAgICAgICAgIGxpa2VySWQ6IGxpa2VySWRcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGZvY3VzKCRyb290U2NvcGUsICR0aW1lb3V0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2ZvY3VzT24nLCBuYW1lKTtcbiAgICAgICAgfSwgMCk7XG4gICAgfVxufVxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5hbmd1bGFyXG4gICAgLm1vZHVsZSgncGluY2hBcHAnKVxuICAgIC5jb250cm9sbGVyKCduYXZDdHJsJywgbmF2Q3RybClcbiAgICAuY29udHJvbGxlcignaG9tZUN0cmwnLCBob21lQ3RybClcbiAgICAuY29udHJvbGxlcigncHBhZ2VDdHJsJywgcHBhZ2VDdHJsKVxuICAgIC5jb250cm9sbGVyKCdwcm9maWxlU2V0dGluZ0N0cmwnLCBwcm9maWxlU2V0dGluZ0N0cmwpXG4gICAgLmNvbnRyb2xsZXIoJ3Byb2plY3RwYWdlQ3RybCcsIHByb2plY3RwYWdlQ3RybClcbiAgICAuY29udHJvbGxlcigncHJvamVjdFNldHRpbmdDdHJsJywgcHJvamVjdFNldHRpbmdDdHJsKVxuXG5cbmZ1bmN0aW9uIGhvbWVDdHJsKCkge1xuICAgIGNvbnNvbGUubG9nKCdob21lQ3RybCBsb2FkZWQnKTtcbn1cblxuZnVuY3Rpb24gcHJvamVjdFNldHRpbmdDdHJsKCRzY29wZSwgJGh0dHAsICRzdGF0ZVBhcmFtcywgUHJvamVjdCwgJHN0YXRlLCAkbG9jYXRpb24pIHtcbiAgICBjb25zb2xlLmxvZygncHJvamVjdFNldHRpbmdDdHJsIGxvYWRlZCcpO1xuICAgIHZhciBpc0F1dGhvciA9IGZhbHNlO1xuICAgIHZhciBwcm9qZWN0SWQgPSAkc3RhdGVQYXJhbXMucHJvamVjdElkO1xuXG4gICAgUHJvamVjdC5nZXRPbmVQb3JqZWN0KHByb2plY3RJZCkudGhlbihyZXMgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygncHJvamVjdHM6ICcsIHJlcy5kYXRhKTtcbiAgICAgICAgJHNjb3BlLnByb2plY3QgPSByZXMuZGF0YTtcbiAgICAgICAgJHNjb3BlLnVwZGF0ZVByb2plY3REYXRhID0gJHNjb3BlLnByb2plY3Q7XG4gICAgICAgICRzY29wZS5wcm9qZWN0LmF1dGhvci5mb3JFYWNoKGF1dGhvciA9PiB7XG4gICAgICAgICAgICAvLyBpbiBjYXNlLCBwcm9qZWN0IGhhcyBtdXRpcGxlIGF1dGhvcnNcbiAgICAgICAgICAgIGlmIChhdXRob3IuX2lkID09ICRzY29wZS5jdXJyZW50VXNlci5faWQpIHtcbiAgICAgICAgICAgICAgICBpc0F1dGhvciA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIGlmIChpc0F1dGhvcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2lzQXV0aG9yJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnaXMgbm90IEF1dGhvcicpO1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdob21lJyk7XG4gICAgICAgIH1cbiAgICB9LCBlcnIgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygnZXJyIHdoZW4gZ2V0IHRoaXMgcHJvamVjdDogJywgZXJyKTtcbiAgICB9KVxuICAgICRzY29wZS5yZXF1ZXN0ID0ge1xuICAgICAgICBwZW9wbGU6IFtdLFxuICAgICAgICBzdXBwbHk6IFtdLFxuICAgICAgICBtb25leTogW11cbiAgICB9O1xuXG4gICAgJHNjb3BlLmluaXQgPSAoKSA9PiB7XG4gICAgICAgIHZhciBjaGVja1VybCA9ICRsb2NhdGlvbi4kJHBhdGguaW5jbHVkZXMoJ2RhbmdlcicpIHx8ICRsb2NhdGlvbi4kJHBhdGguaW5jbHVkZXMoJ3JlcXVlc3QnKSB8fCAkbG9jYXRpb24uJCRwYXRoLmluY2x1ZGVzKCdwcml2YWN5JylcbiAgICAgICAgaWYgKCFjaGVja1VybCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdwcm9qZWN0U2V0dGluZ19nZW5lcmFsJyk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgJHNjb3BlLmFkZENob2ljZVRvUGVvcGxlID0gKHBlb3BsZSkgPT4ge1xuICAgICAgICBpZiAoJHNjb3BlLnJlcXVlc3QucGVvcGxlLmluZGV4T2YocGVvcGxlKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICRzY29wZS5yZXF1ZXN0LnBlb3BsZS5zcGxpY2UoJHNjb3BlLnJlcXVlc3QucGVvcGxlLmluZGV4T2YocGVvcGxlKSwgMSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkc2NvcGUucmVxdWVzdC5wZW9wbGUucHVzaChwZW9wbGUpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnNvbGUubG9nKCRzY29wZS5yZXF1ZXN0LnBlb3BsZSk7XG4gICAgfTtcblxuICAgICRzY29wZS5hZGRDaG9pY2VUb1N1cHBseSA9IChzdXBwbHkpID0+IHtcbiAgICAgICAgaWYgKCRzY29wZS5yZXF1ZXN0LnN1cHBseS5pbmRleE9mKHN1cHBseSkgIT09IC0xKSB7XG4gICAgICAgICAgICAkc2NvcGUucmVxdWVzdC5zdXBwbHkuc3BsaWNlKCRzY29wZS5yZXF1ZXN0LnN1cHBseS5pbmRleE9mKHN1cHBseSksIDEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJHNjb3BlLnJlcXVlc3Quc3VwcGx5LnB1c2goc3VwcGx5KTtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUucmVxdWVzdC5zdXBwbHkpO1xuICAgIH1cbiAgICAkc2NvcGUuYWRkQ2hvaWNlVG9Nb25leSA9IChtb25leSkgPT4ge1xuICAgICAgICBpZiAoJHNjb3BlLnJlcXVlc3QubW9uZXkuaW5kZXhPZihtb25leSkgIT09IC0xKSB7XG4gICAgICAgICAgICAkc2NvcGUucmVxdWVzdC5tb25leS5zcGxpY2UoJHNjb3BlLnJlcXVlc3QubW9uZXkuaW5kZXhPZihtb25leSksIDEpO1xuICAgICAgICAgICAgJHNjb3BlLnJlcXVlc3QubW9uZXkgPSBbXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICRzY29wZS5yZXF1ZXN0Lm1vbmV5ID0gW107XG4gICAgICAgICAgICAkc2NvcGUucmVxdWVzdC5tb25leS5wdXNoKG1vbmV5KTtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUucmVxdWVzdC5tb25leSk7XG4gICAgfVxuICAgICRzY29wZS5kZWxldGVQcm9qZWN0ID0gKHByb2plY3RGdWxsTmFtZSkgPT4ge1xuICAgICAgICBpZiAoJHNjb3BlLmRlbGV0ZVByb2plY3RJbnB1dCA9PSBwcm9qZWN0RnVsbE5hbWUpIHtcbiAgICAgICAgICAgIGxldCBwcm9qZWN0SWQgPSAkc3RhdGVQYXJhbXMucHJvamVjdElkO1xuICAgICAgICAgICAgUHJvamVjdC5kZWxldGVPbmUocHJvamVjdElkKS50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3Byb2plY3QgZGVsZXRlZCcpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXM6ICcsIHJlcy5kYXRhKTtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ3BwYWdlJywge1xuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6ICRzY29wZS5jdXJyZW50VXNlci5faWRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sIGVyciA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3VzZXIgaXMgbm90IGxvZ2dlZCBpbi4nKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnbm8nKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgICRzY29wZS5kYW5nZXJOb3RpZmllZCA9IGZhbHNlO1xuICAgICRzY29wZS5kYW5nZXJOb3RpZnR5ID0gKCkgPT4ge1xuICAgICAgICAkc2NvcGUuZGFuZ2VyTm90aWZpZWQgPSAhJHNjb3BlLmRhbmdlck5vdGlmaWVkO1xuICAgIH1cbiAgICAkc2NvcGUuc2FtZVRvVGhlUHJvamVjdE5hbWUgPSAocHJvamVjdEZ1bGxOYW1lKSA9PiB7XG4gICAgICAgIHJldHVybiAkc2NvcGUuZGVsZXRlUHJvamVjdElucHV0ID09IHByb2plY3RGdWxsTmFtZTtcbiAgICB9XG4gICAgJHNjb3BlLm9rYXlUb0RlbGV0ZSA9IChwcm9qZWN0RnVsbE5hbWUpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJyRzY29wZS5kYW5nZXJOb3RpZmllZDogJywgJHNjb3BlLmRhbmdlck5vdGlmaWVkKTtcbiAgICAgICAgcmV0dXJuICRzY29wZS5kZWxldGVQcm9qZWN0SW5wdXQgPT0gcHJvamVjdEZ1bGxOYW1lICYmICRzY29wZS5kYW5nZXJOb3RpZmllZDtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHByb2plY3RwYWdlQ3RybCgkc2NvcGUsICRodHRwLCAkc3RhdGVQYXJhbXMsIFByb2plY3QpIHtcbiAgICBjb25zb2xlLmxvZygncHJvamVjdHBhZ2VDdHJsIGxvYWRlZCcpO1xuICAgICRzY29wZS5zdGF0ZSA9IHt9XG4gICAgJHNjb3BlLnN0YXRlLmlzQXV0aG9yID0gZmFsc2VcbiAgICB2YXIgcHJvamVjdElkID0gJHN0YXRlUGFyYW1zLnByb2plY3RJZDtcbiAgICAvLyBjb25zb2xlLmxvZygncHJvamVjdElkOiAnLCBwcm9qZWN0SWQpO1xuICAgIFByb2plY3QuZ2V0T25lUG9yamVjdChwcm9qZWN0SWQpLnRoZW4ocmVzID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ3Byb2plY3REYXRhOiAnLCByZXMuZGF0YSk7XG4gICAgICAgICRzY29wZS5wcm9qZWN0ID0gcmVzLmRhdGFcbiAgICAgICAgY29uc29sZS5sb2coJyRzY29wZS5jdXJyZW50VXNlci5faWQ6ICcsICRzY29wZS5jdXJyZW50VXNlci5faWQpXG4gICAgICAgIGNvbnNvbGUubG9nKCckc2NvcGUucHJvamVjdC5hdXRob3I6ICcsICRzY29wZS5wcm9qZWN0LmF1dGhvcilcbiAgICAgICAgdmFyIGF1dGhvcnMgPSByZXMuZGF0YS5hdXRob3JcbiAgICAgICAgZm9yICh2YXIgYXV0aG9yIGluIGF1dGhvcnMpIHtcbiAgICAgICAgICAgIGlmICgkc2NvcGUuY3VycmVudFVzZXIuX2lkID09IGF1dGhvcnNbYXV0aG9yXS5faWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJHNjb3BlLnN0YXRlLmlzQXV0aG9yID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIGVyciA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdlcnIgd2hlbiBnZXQgdGhpcyBwcm9qZWN0OiAnLCBlcnIpO1xuICAgIH0pXG4gICAgJHNjb3BlLmxpa2UgPSAobGlrZXJJZCwgcHJvamVjdElkKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGxpa2VySWQsICdjbGlja3MgbGlrZUJ0biBvZicsIHByb2plY3RJZCk7XG4gICAgICAgIGlmICgkc2NvcGUuc3RhdGUuaXNBdXRob3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdsaWtlRXZlbnQgdHJpZ2dlcmVkJylcbiAgICAgICAgICAgIFByb2plY3QubGlrZShwcm9qZWN0SWQsIGxpa2VySWQpLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXM6ICcsIHJlcyk7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBpZiAocmVzLmRhdGEuZXZlbnRUeXBlID09ICdmb2xsb3cnKSB7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgY29uc29sZS5sb2coJ2NoZWNrJyk7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgY29uc29sZS5sb2coJ2ZvbGx3aW5nOiByZXMsICcsIHJlcy5kYXRhKVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIHZhciBmb2xsb3dlciA9IHJlcy5kYXRhLmZvbGxvd2VyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgdmFyIGZvbGxvd2luZ1JlY2VpdmVyID0gcmVzLmRhdGEuZm9sbG93aW5nUmVjZWl2ZXJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAkc2NvcGUudXNlci5mb2xsb3dlcnNMaXN0LnB1c2goZm9sbG93ZXIpXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgY2hlY2tGb2xsb3dTdGF0dXMoKVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgfSBlbHNlIGlmIChyZXMuZGF0YS5ldmVudFR5cGUgPT0gJ3VuZm9sbG93Jykge1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjaGVjaycpO1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd1bmZvbGx3aW5nOiByZXMsICcsIHJlcy5kYXRhKVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIHZhciB1bmZvbGxvd2VyID0gcmVzLmRhdGEudW5mb2xsb3dlclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIHZhciB1bmZvbGxvd2luZ1JlY2VpdmVyID0gcmVzLmRhdGEudW5mb2xsb3dpbmdSZWNlaXZlclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIHZhciBpbmRleCA9ICRzY29wZS51c2VyLmZvbGxvd2Vyc0xpc3QuaW5kZXhPZihmb2xsb3dlcilcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAkc2NvcGUudXNlci5mb2xsb3dlcnNMaXN0LnNwbGljZShpbmRleCwgMSlcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBjaGVja0ZvbGxvd1N0YXR1cygpXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICB9XG4gICAgICAgICAgICB9LCBlcnIgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnIgd2hlbiBsaWtlL3VubGlrZTogJywgZXJyKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gcHJvZmlsZVNldHRpbmdDdHJsKCRzY29wZSwgJGh0dHAsICRzdGF0ZVBhcmFtcywgQWNjb3VudCwgJHN0YXRlLCAkd2luZG93LCBVcGxvYWQsICRsb2NhdGlvbikge1xuICAgIGNvbnNvbGUubG9nKCdwcm9maWxlU2V0dGluZ0N0cmwgbG9hZGVkJyk7XG5cbiAgICBpZiAoJHN0YXRlUGFyYW1zLnVzZXJJZCA9PSAkc2NvcGUuY3VycmVudFVzZXIuX2lkKSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdpc0F1dGhVc2VyJyk7XG4gICAgICAgICRzY29wZS51cGRhdGVVc2VyRGF0YSA9IGFuZ3VsYXIuY29weSgkc2NvcGUuY3VycmVudFVzZXIpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdpcyBub3QgQXV0aFVzZXInKTtcbiAgICAgICAgJHN0YXRlLmdvKCdob21lJyk7XG4gICAgfVxuICAgICRzY29wZS5pbml0ID0gKCkgPT4ge1xuICAgICAgICB2YXIgY2hlY2tVcmwgPSAkbG9jYXRpb24uJCRwYXRoLmluY2x1ZGVzKCdkYW5nZXInKSB8fCAkbG9jYXRpb24uJCRwYXRoLmluY2x1ZGVzKCdyZXF1ZXN0JykgfHwgJGxvY2F0aW9uLiQkcGF0aC5pbmNsdWRlcygncHJpdmFjeScpXG4gICAgICAgIGlmICghY2hlY2tVcmwpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygncHJvZmlsZVNldHRpbmdfZ2VuZXJhbCcpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgICRzY29wZS51cGRhdGVVc2VyRGF0YVN1Ym1pdHRlZCA9ICgpID0+IHtcbiAgICAgICAgdmFyIHVyaVVzZXJJZCA9ICRzY29wZS51cGRhdGVVc2VyRGF0YS5faWQ7XG4gICAgICAgIHZhciB1cGRhdGVVc2VyRGF0YSA9ICRzY29wZS51cGRhdGVVc2VyRGF0YTtcbiAgICAgICAgQWNjb3VudC51cGRhdGVVc2VyRGF0YSh1cmlVc2VySWQsIHVwZGF0ZVVzZXJEYXRhKS50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAkc2NvcGUudXBkYXRlVXNlckRhdGEgPSByZXMuZGF0YTtcbiAgICAgICAgICAgICR3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICAgIH0sIGVyciA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnZXJyIHdoZW4gZ2V0IHVwZGF0ZSB1c2VyIGRhdGE6ICcsIGVycik7XG4gICAgICAgIH0pXG4gICAgfVxuICAgICRzY29wZS5waG90b1VwbG9hZGluZyA9IGZhbHNlXG4gICAgJHNjb3BlLnVwbG9hZEZpbGVzID0gKGZpbGUpID0+IHtcbiAgICAgICAgJHNjb3BlLnBob3RvVXBsb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgdmFyIGZpbGUgPSBmaWxlWzBdXG4gICAgICAgIHZhciB1c2VySWQgPSAkc2NvcGUuY3VycmVudFVzZXIuX2lkO1xuICAgICAgICBjb25zb2xlLmxvZygncGhvdG86ICcsIGZpbGUpO1xuICAgICAgICBpZiAoZmlsZSkge1xuICAgICAgICAgICAgVXBsb2FkLnVwbG9hZCh7XG4gICAgICAgICAgICAgICAgdXJsOiBgL2FwaS91cGxvYWQvJHt1c2VySWR9YCxcbiAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0ZpbGU6IGZpbGVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KS50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlcyBhZnRlciB1cGxvYWQ6ICcsIHJlcy5kYXRhKTtcbiAgICAgICAgICAgICAgICAkd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICAgICAgfSwgZXJyID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZXJyIHdoZW4gdXBsb2FkIGZpbGU6ICcsIGVycik7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfVxuXG59XG5cbmZ1bmN0aW9uIHBwYWdlQ3RybCgkc2NvcGUsICRzdGF0ZSwgJHJvb3RTY29wZSwgJHN0YXRlUGFyYW1zLCBQcm9qZWN0LCBBY2NvdW50LCAkdGltZW91dCwgJGxvY2F0aW9uKSB7XG4gICAgY29uc29sZS5sb2coJ3BwYWdlQ3RybCBsb2FkZWQnKVxuICAgICRzY29wZS5zdGF0ZSA9IHt9XG4gICAgJHNjb3BlLnN0YXRlLmlzVGhlVXNlciA9IGZhbHNlXG4gICAgJHNjb3BlLnN0YXRlLmZvbGxvd1N0YXR1cyA9IGZhbHNlXG4gICAgdmFyIGRpc3BsYXlVc2VyO1xuICAgIHZhciB1cmlVc2VySWQgPSAkc3RhdGVQYXJhbXMudXNlcklkO1xuICAgIGlmICh1cmlVc2VySWQgPT0gJHNjb3BlLmN1cnJlbnRVc2VyLl9pZCkge1xuICAgICAgICAkc2NvcGUuc3RhdGUuaXNUaGVVc2VyID0gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKCRzY29wZS5zdGF0ZS5pc1RoZVVzZXIpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2lzVGhlVXNlcicpXG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2lzIG5vdCBUaGVVc2VyJylcbiAgICB9XG4gICAgJHNjb3BlLmluaXQgPSAoKSA9PiB7XG4gICAgICAgIGNoZWNraW5nVXJsKClcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjaGVja2luZ1VybCgpIHtcbiAgICAgICAgdmFyIGNoZWNrVXJsID0gJGxvY2F0aW9uLiQkcGF0aC5pbmNsdWRlcygnc3RhcnJlZCcpIHx8ICRsb2NhdGlvbi4kJHBhdGguaW5jbHVkZXMoJ2ZvbGxvd2VycycpXG4gICAgICAgIGlmICghY2hlY2tVcmwpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygncHBhZ2VfcHJvamVjdHMnKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBBY2NvdW50LmdldFVzZXJEYXRhKHVyaVVzZXJJZCkudGhlbihyZXMgPT4ge1xuICAgICAgICAkc2NvcGUudXNlciA9IHJlcy5kYXRhXG4gICAgICAgIGRpc3BsYXlVc2VyID0gcmVzLmRhdGFcbiAgICAgICAgJHNjb3BlLnByb2plY3RzID0gcmVzLmRhdGEucHJvamVjdHMucmV2ZXJzZSgpO1xuICAgICAgICBjb25zb2xlLmxvZygnY2FyZHMgaGVyZTogJywgcmVzLmRhdGEucHJvamVjdHMpO1xuICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNoZWNrRm9sbG93U3RhdHVzKClcbiAgICAgICAgfSwgMClcbiAgICB9LCBlcnIgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygnZXJyIHdoZW4gZ2V0IHVzZXJEYXRhOiAnLCBlcnIpO1xuICAgIH0pXG5cbiAgICAkc2NvcGUuY3JlYXRlVGltZSA9IChjcmVhdGVBdFRpbWUpID0+IHtcbiAgICAgICAgcmV0dXJuIG1vbWVudChjcmVhdGVBdFRpbWUpLmZyb21Ob3coKTtcbiAgICB9XG5cbiAgICAkc2NvcGUuZm9sbG93ID0gKGN1cnJlbnRVc2VyLCBmb2xsb3dUYXJnZXQpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ2ZmZmZmZicpO1xuICAgICAgICBjb25zb2xlLmxvZyhjdXJyZW50VXNlciwgZm9sbG93VGFyZ2V0KTtcbiAgICAgICAgaWYgKGN1cnJlbnRVc2VyICE9PSBmb2xsb3dUYXJnZXQgJiYgZm9sbG93VGFyZ2V0ID09IHVyaVVzZXJJZCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2ZvbGxvd0V2ZW50IHRyaWdnZXJlZCcpXG4gICAgICAgICAgICBBY2NvdW50LmZvbGxvdyhjdXJyZW50VXNlciwgZm9sbG93VGFyZ2V0KS50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlczogJywgcmVzKTtcbiAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEuZXZlbnRUeXBlID09ICdmb2xsb3cnKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjaGVjaycpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZm9sbHdpbmc6IHJlcywgJywgcmVzLmRhdGEpXG4gICAgICAgICAgICAgICAgICAgIHZhciBmb2xsb3dlciA9IHJlcy5kYXRhLmZvbGxvd2VyXG4gICAgICAgICAgICAgICAgICAgIHZhciBmb2xsb3dpbmdSZWNlaXZlciA9IHJlcy5kYXRhLmZvbGxvd2luZ1JlY2VpdmVyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS51c2VyLmZvbGxvd2Vyc0xpc3QucHVzaChmb2xsb3dlcilcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tGb2xsb3dTdGF0dXMoKVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzLmRhdGEuZXZlbnRUeXBlID09ICd1bmZvbGxvdycpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2NoZWNrJyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd1bmZvbGx3aW5nOiByZXMsICcsIHJlcy5kYXRhKVxuICAgICAgICAgICAgICAgICAgICB2YXIgdW5mb2xsb3dlciA9IHJlcy5kYXRhLnVuZm9sbG93ZXJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVuZm9sbG93aW5nUmVjZWl2ZXIgPSByZXMuZGF0YS51bmZvbGxvd2luZ1JlY2VpdmVyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRleCA9ICRzY29wZS51c2VyLmZvbGxvd2Vyc0xpc3QuaW5kZXhPZihmb2xsb3dlcilcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnVzZXIuZm9sbG93ZXJzTGlzdC5zcGxpY2UoaW5kZXgsIDEpXG4gICAgICAgICAgICAgICAgICAgIGNoZWNrRm9sbG93U3RhdHVzKClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCBlcnIgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnIgd2hlbiBmb2xsb3cvdW5mb2xsb3c6ICcsIGVycilcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIGNoZWNrRm9sbG93U3RhdHVzID0gKCkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2NoZWNrRm9sbG93U3RhdHVzIHRyaWdlcnJlZCcpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2Rpc3BsYXlVc2VyOiAnLCBkaXNwbGF5VXNlcik7XG4gICAgICAgICAgICBpZiAoZGlzcGxheVVzZXIuZm9sbG93ZXJzTGlzdC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZvbGxvd2Vyc0xpc3QgPSBkaXNwbGF5VXNlci5mb2xsb3dlcnNMaXN0XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2NoZWNrZWQnKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBmb2xsb3dlciBpbiBmb2xsb3dlcnNMaXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjdXJyZW50VXNlcjogJywgJHNjb3BlLmN1cnJlbnRVc2VyLl9pZCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdmb2xsb3dlcnNMaXN0W2ZvbGxvd2VyXS5faWQ6ICcsIGZvbGxvd2Vyc0xpc3RbZm9sbG93ZXJdLl9pZCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmb2xsb3dlcnNMaXN0W2ZvbGxvd2VyXS5faWQgPT0gJHNjb3BlLmN1cnJlbnRVc2VyLl9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN0YXRlLmZvbGxvd1N0YXR1cyA9IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zdGF0ZS5mb2xsb3dTdGF0dXMgPSBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3RhdGUuZm9sbG93U3RhdHVzID0gZmFsc2VcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBjaGVja0ZvbGxvd1N0YXR1cygpXG59XG5cbmZ1bmN0aW9uIG5hdkN0cmwoJGh0dHAsICRzY29wZSwgJGF1dGgsIEFjY291bnQsICRyb290U2NvcGUsICR0aW1lb3V0LCAkd2luZG93LCAkc3RhdGUsIGZvY3VzLCBQcm9qZWN0LCAkbG9jYXRpb24pIHtcbiAgICAvLyBjb25zb2xlLmxvZygnbmF2Q3RybCBsb2FkZWQnKTtcbiAgICAkc2NvcGUuY3VycmVudFVzZXIgPSAnJztcbiAgICAkc2NvcGUubG9naW5sb2FkaW5nID0gZmFsc2U7XG4gICAgJHNjb3BlLmxvZ291dGxvYWRpbmcgPSBmYWxzZTtcbiAgICAkcm9vdFNjb3BlLmhpZGVOYXYgPSBmYWxzZTtcbiAgICAkcm9vdFNjb3BlLmNyZWF0ZU1vZGFsID0gZmFsc2U7XG5cbiAgICAkc2NvcGUuYXV0aGVudGljYXRlID0gKHByb3ZpZGVyKSA9PiB7XG4gICAgICAgICAgICAkc2NvcGUubG9naW5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICRhdXRoLmF1dGhlbnRpY2F0ZShwcm92aWRlcikudGhlbihkYXRhID0+IHtcbiAgICAgICAgICAgICAgICBBY2NvdW50LmdldEN1cnJlbnRVc2VyKCkudGhlbihyZXMgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygndXNlciBsb2dnZWQgaW46ICcsIHJlcy5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnRVc2VyID0gcmVzLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2dpbmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJyRzY29wZS5jdXJyZW50VXNlci5faWQ6ICcsICRzY29wZS5jdXJyZW50VXNlci5faWQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHN0YXRlLmN1cnJlbnQubmFtZSA9PSAnaG9tZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygncHBhZ2UnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiAkc2NvcGUuY3VycmVudFVzZXIuX2lkXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICR3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LCBlcnIgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygndXNlciBpcyBub3QgbG9nZ2VkIGluLicpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9LCBlcnIgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnIgd2hlbiBsb2cgdXNlciBpbjogJywgZXJyKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgICAgLy8gY29uc29sZS5sb2coJyRhdXRoLmlzQXV0aGVudGljYXRlZCgpKTogJywgJGF1dGguaXNBdXRoZW50aWNhdGVkKCkpKTtcbiAgICBpZiAoJGF1dGguaXNBdXRoZW50aWNhdGVkKCkpIHtcbiAgICAgICAgQWNjb3VudC5nZXRDdXJyZW50VXNlcigpLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICAgICRzY29wZS5jdXJyZW50VXNlciA9IHJlcy5kYXRhO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ25hdkN0cmwgdHJpZ2dlcmVkIGFuZCBjdXJyZW50VXNlcjogJywgJHNjb3BlLmN1cnJlbnRVc2VyKTtcbiAgICAgICAgfSwgZXJyID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCd1c2VyIGlzIG5vdCBsb2dnZWQgaW4uJyk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgJHNjb3BlLmlzQXV0aGVudGljYXRlZCA9ICgpID0+IHtcbiAgICAgICAgcmV0dXJuICRhdXRoLmlzQXV0aGVudGljYXRlZCgpO1xuICAgIH1cblxuICAgICRzY29wZS5sb2dvdXQgPSAoKSA9PiB7XG4gICAgICAgICRzY29wZS5sb2dvdXRsb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgJGF1dGgubG9nb3V0KCk7XG4gICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJHNjb3BlLmxvZ291dGxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIC8vICRzdGF0ZS5nbygnaG9tZScpO1xuICAgICAgICAgICAgJHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgfSwgMClcbiAgICB9XG5cbiAgICAkc2NvcGUuZ29wcGFnZSA9ICgpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJyRsb2NhdGlvbi4kJHBhdGg6ICcsICRsb2NhdGlvbi4kJHBhdGgpO1xuICAgICAgICBpZiAoJGxvY2F0aW9uLiQkcGF0aC5pbmNsdWRlcygncHJvamVjdHMnKSkge1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ3N0YXkgb24gdGhlIHBhZ2UsIG9yIHJlZnJlc2ggdGhlIHBhZ2UnKVxuICAgICAgICAgICAgJHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdwcGFnZScsIHtcbiAgICAgICAgICAgICAgICB1c2VySWQ6ICRzY29wZS5jdXJyZW50VXNlci5faWRcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAkc2NvcGUuY3JlYXRlID0gKCkgPT4ge1xuICAgICAgICAkc2NvcGUucHJvamVjdEluaXRhbGl6aW5nID0gZmFsc2U7XG4gICAgICAgICRzY29wZS5uZXdQcm9qZWN0TmFtZSA9ICcnO1xuICAgICAgICAkc2NvcGUubmV3UHJvamVjdFBpdGNoID0gJyc7XG4gICAgICAgICRzY29wZS5jcmVhdGVNb2RhbCA9IHRydWU7XG4gICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgZm9jdXMoJ2ZvY3VzTWUnKTtcbiAgICAgICAgfSwgMTAwKVxuICAgIH1cbiAgICAkc2NvcGUuY3JlYXRlUHJvamVjdCA9ICgpID0+IHtcbiAgICAgICAgJHNjb3BlLnByb2plY3RJbml0YWxpemluZyA9IHRydWU7XG4gICAgICAgIGNvbnNvbGUubG9nKCdjcmVhdGUgcHJvamVjdCBjYWxsZWQ6ICcsICRzY29wZS5uZXdQcm9qZWN0TmFtZSk7XG4gICAgICAgIHZhciBuZXdQb2plY3RPYmogPSB7XG4gICAgICAgICAgICB0aXRsZTogJHNjb3BlLm5ld1Byb2plY3ROYW1lLFxuICAgICAgICAgICAgcGl0Y2g6ICRzY29wZS5uZXdQcm9qZWN0UGl0Y2hcbiAgICAgICAgfVxuICAgICAgICBQcm9qZWN0LmNyZWF0ZU9uZShuZXdQb2plY3RPYmopLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdhZGQgbmV3IGJlaGF2aW9yW2NyZWF0ZU5ld1Byb2plY3RdOiAnLCByZXMuZGF0YSk7XG4gICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUucHJvamVjdEluaXRhbGl6aW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNyZWF0ZU1vZGFsID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKCRzdGF0ZS5jdXJyZW50Lm5hbWUgPT0gJ3BwYWdlJykge1xuICAgICAgICAgICAgICAgICAgICAkd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygncHBhZ2UnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6ICRzY29wZS5jdXJyZW50VXNlci5faWRcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgTWF0aC5yYW5kb20oKSAqIDE1MDAgKyAzMDApO1xuICAgICAgICB9LCBlcnIgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2VyciB3aGVuIGNyZWF0ZSBwcm9qZWN0OiAnLCBlcnIpO1xuICAgICAgICB9KVxuICAgIH1cbn1cbiIsIid1c2Ugc3RyaWN0JztcblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ3BpbmNoQXBwJylcbiAgICAuZGlyZWN0aXZlKCdmb2N1c09uJywgZm9jdXNPbilcblxuZnVuY3Rpb24gZm9jdXNPbigpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGVsZW0sIGF0dHIpIHtcbiAgICAgICAgc2NvcGUuJG9uKCdmb2N1c09uJywgZnVuY3Rpb24oZSwgbmFtZSkge1xuICAgICAgICAgICAgaWYgKG5hbWUgPT09IGF0dHIuZm9jdXNPbikge1xuICAgICAgICAgICAgICAgIGVsZW1bMF0uZm9jdXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbn1cbiIsIid1c2Ugc3RyaWN0JztcblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ3BpbmNoQXBwJylcbiAgICAuZGlyZWN0aXZlKCd0b29sVGlwJywgdG9vbFRpcClcblxuZnVuY3Rpb24gdG9vbFRpcCgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudCgnLnRvb2wtdGlwJykub24oJ2NsaWNrIG1vdXNlbGVhdmUnLCBoaWRlVG9vbHRpcCk7XG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudCgnLnRvb2wtdGlwJykub24oJ21vdXNlZW50ZXInLCBzaG93VG9vbHRpcCk7XG4gICAgfTtcbn1cblxuZnVuY3Rpb24gaGlkZVRvb2x0aXAoKSB7XG4gICAgJCh0aGlzKS50b29sdGlwKCdoaWRlJyk7XG59XG5cbmZ1bmN0aW9uIHNob3dUb29sdGlwKCkge1xuICAgICQodGhpcykudG9vbHRpcCgnc2hvdycpO1xufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
