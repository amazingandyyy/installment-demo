"use strict";function init(){console.log("jquery loaded"),sticky(),windowScrollDown()}function sticky(){$(".sticky").sticky({topSpacing:60})}function windowScrollDown(){var e,o=0;$(window).scroll(function(){e=$(this).scrollTop(),$(window).scrollTop()>30&&(o>e?($(".home-page nav").removeClass("folded"),$(".home-page nav").css("border-bottom","0px solid")):$(".home-page nav").addClass("folded")),o=e,$(window).scrollTop()<10&&$(".home-page nav").addClass("top"),$(window).scrollTop()>10&&$(".home-page nav").removeClass("top"),$(window).scrollTop()>30,$(window).scrollTop()<540&&$(".home-page nav").css("box-shadow","inset 0 -1px 0px 0px rgba(0,0,0,0)"),$(window).scrollTop()>540&&$(".home-page nav").css("box-shadow","inset 0 -1px 0px 0px rgba(0,0,0,0.1)")})}function Account(e){this.getCurrentUser=function(){return e({method:"GET",url:"/api/auth/currentUser"})},this.sendVerifyCode=function(o){return e({method:"POST",url:"/api/verify/phone",data:o})},this.verifyCode=function(o){return e({method:"PUT",url:"/api/verify/phone",data:o})},this.getUserData=function(o){return e({method:"GET",url:"/api/users/"+o})},this.updateUserData=function(o,t){return e({method:"PUT",url:"/api/users/"+o,data:t})}}function Payment(e){this.chargeNow=function(o){return e({method:"POST",url:"/api/payment/chargeNow",data:o})}}function focus(e,o){return function(t){o(function(){e.$broadcast("focusOn",t)},0)}}function Plan(e){var o={};this.addSinglePreview=function(t){return e(function(e,n){o=t,e(o)})},this.getSinglePreview=function(){return e(function(e,t){o&&e(o)})}}function homeCtrl(e){console.log("homeCtrl loaded"),e.previousState,e.currentState,e.$on("$stateChangeSuccess",function(o,t,n,a,r){e.previousState=a.name,e.currentState=t.name,console.log("Previous state:"+e.previousState),console.log("Current state:"+e.currentState)}),e.$on("animStart",function(e,o,t){}),e.$on("animEnd",function(e,o,t){})}function authCtrl(e,o,t,n,a){function r(){o.getToken()&&n.getCurrentUser(o.getToken()).then(function(o){console.log("res @getCurrentUser: ",o.data),e.currentUser=o.data},function(e){t.go("authEntrance")})}console.log("authCtrl loaded"),e.getCurrentUser=function(){r()},e.auth_enter=function(e){o.signup(e).then(function(e){o.setToken(e),t.go("dashboard",{},{reload:!0}),console.log("res @auth_enter: ",e.data),r()},function(e){console.log("err @auth_enter: ",e)})},e.authenticate=function(e){o.authenticate(e)},e.logout=function(){o.logout(),e.currentUser=null,t.go("home",{},{reload:!0}),a.location.reload()}}function dashboardCtrl(e,o,t,n,a,r,l){function s(o){e.verifyPhoneSentOut=!1;var t=Number(o.phone.verifyCode.expiredAt),n=Date.now();t>n&&(e.verifyPhoneSentOut=!0),e.verifyPhoneCountDown=function(){return""+t}}console.log("dashboardCtrl loaded"),n.getCurrentUser(o.getToken()).then(function(e){a.currentUser||(a.currentUser=e.data),console.log("res @getCurrentUser: ",e.data),s(e.data)},function(e){t.go("home")}),e.sendVerifyCode=function(o){if(console.log("phone: ",o),o.length>5){var t={userData:a.currentUser,phone:o};n.sendVerifyCode(t).then(function(t){console.log("res @sendVerifyCode: ",t.data),a.currentUser.phone.data=o,e.verifyPhoneSentOut=!0},function(e){console.log("err @sendVerifyCode: ",e)})}},e.verifyCode=function(e){if(console.log("code: ",e),0!==e.length){var o={userData:a.currentUser,code:e};n.verifyCode(o).then(function(e){console.log("res @verifyCode: ",e.data),a.currentUser.phone.verified=!0},function(e){console.log("err @verifyCode: ",e)})}},e.doCheckout=function(e){console.log("fff"),console.log("token: ",e);var o={stripeToken:e,userData:a.currentUser};r.chargeNow(o).then(function(e){console.log("res: ",e.data)},function(e){console.log("err: ",e)})}}function dashboardPlanCtrl(e,o,t,n,a,r){console.log("dashboardPlanCtrl loaded"),"dashboard_plan_single"==r.currentState&&(e.updateTimes=function(o){e.installmentsGraphData=[];for(var t=0;o>t;t++){var n=~~(e.plan.total/o),a=~~(200*(2/o));e.installmentsGraphData.push({price:n,style:{height:a+"px",width:"90%"}})}},e.previewSinglePlan=function(e){a.addSinglePreview(e).then(function(e){n.go("dashboard_plan_single_preview")},function(e){return console.log("err @addSinglePreview: ",e)})}),"dashboard_plan_single_preview"==r.currentState&&a.getSinglePreview().then(function(e){console.log("res @getSinglePreview: ",e)},function(e){return console.log("err @getSinglePreview: ",e)})}function focusOn(){return function(e,o,t){e.$on("focusOn",function(e,n){n===t.focusOn&&o[0].focus()})}}function toolTip(){return function(e,o,t){angular.element(".tool-tip").on("click mouseleave",hideTooltip),angular.element(".tool-tip").on("mouseenter",showTooltip)}}function hideTooltip(){$(this).tooltip("hide")}function showTooltip(){$(this).tooltip("show")}angular.module("pinchApp",["ui.router","satellizer","ngAnimate","ngFileUpload","ngImgCrop","stripe.checkout","angular-loading-bar","anim-in-out"]).config(["$stateProvider","$urlRouterProvider","$authProvider",function(e,o,t){Stripe.setPublishableKey("pk_test_t1eThhOKl6esrp6f4jyWqU4J"),e.state(home).state(authEntrance).state(dashboard).state(dashboard_payment).state(dashboard_plan).state(dashboard_plan_start).state(dashboard_plan_choose).state(dashboard_plan_single).state(dashboard_plan_single_preview).state(dashboard_plan_multiple).state(dashboard_account),o.otherwise("/")}]);var home={name:"home",url:"/",views:{main:{templateUrl:"/html/home.html",controller:"homeCtrl"}}},authEntrance={name:"authEntrance",url:"/entrance",views:{main:{templateUrl:"/html/entrance.html",controller:"authCtrl"}}},dashboard={name:"dashboard",url:"/dashboard",views:{main:{templateUrl:"/html/dashboard.html",controller:"dashboardCtrl"}}},dashboard_payment={name:"dashboard_payment",url:"/payment",parent:"dashboard",views:{dashboard_section:{templateUrl:"/html/dashboard_payment.html",controller:"dashboardCtrl"}}},dashboard_plan={name:"dashboard_plan",url:"/plan",parent:"dashboard",views:{dashboard_section:{templateUrl:"/html/dashboard_plan.html",controller:"dashboardCtrl"}}},dashboard_plan_start={name:"dashboard_plan_start",url:"/start",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_start.html",controller:"dashboardCtrl"}}},dashboard_plan_choose={name:"dashboard_plan_choose",url:"/choose",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_choose.html",controller:"dashboardCtrl"}}},dashboard_plan_single={name:"dashboard_plan_single",url:"/choose/single",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_single.html",controller:"dashboardPlanCtrl"}}},dashboard_plan_single_preview={name:"dashboard_plan_single_preview",url:"/choose/single/preview",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_single_preview.html",controller:"dashboardPlanCtrl"}}},dashboard_plan_multiple={name:"dashboard_plan_multiple",url:"/choose/mutiple",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_multiple.html",controller:"dashboardCtrl"}}},dashboard_account={name:"dashboard_account",url:"/account",parent:"dashboard",views:{dashboard_section:{templateUrl:"/html/dashboard_account.html",controller:"dashboardCtrl"}}};$(document).ready(init),Account.$inject=["$http"],Payment.$inject=["$http"],focus.$inject=["$rootScope","$timeout"],Plan.$inject=["$q"],angular.module("pinchApp").service("Account",Account).service("Payment",Payment).factory("focus",focus).service("Plan",Plan),homeCtrl.$inject=["$rootScope"],authCtrl.$inject=["$scope","$auth","$state","Account","$window"],dashboardCtrl.$inject=["$scope","$auth","$state","Account","$rootScope","Payment","$interval"],dashboardPlanCtrl.$inject=["$scope","Account","$stateParams","$state","Plan","$rootScope"],angular.module("pinchApp").controller("homeCtrl",homeCtrl).controller("authCtrl",authCtrl).controller("dashboardCtrl",dashboardCtrl).controller("dashboardPlanCtrl",dashboardPlanCtrl),angular.module("pinchApp").directive("focusOn",focusOn),angular.module("pinchApp").directive("toolTip",toolTip);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFtb2R1bGUuanMiLCJtYWluLmpzIiwic2VydmljZXMuanMiLCJjb250cm9sbGVycy9jb250cm9sbGVycy5qcyIsImRpcmVjdGl2ZXMvZm9jdXNPbi5kaXJlY3RpdmUuanMiLCJkaXJlY3RpdmVzL3Rvb2xUaXAuZGlyZWN0aXZlLmpzIl0sIm5hbWVzIjpbImluaXQiLCJjb25zb2xlIiwibG9nIiwic3RpY2t5Iiwid2luZG93U2Nyb2xsRG93biIsIiQiLCJ0b3BTcGFjaW5nIiwic3QiLCJsYXN0U2Nyb2xsVG9wIiwid2luZG93Iiwic2Nyb2xsIiwidGhpcyIsInNjcm9sbFRvcCIsInJlbW92ZUNsYXNzIiwiY3NzIiwiYWRkQ2xhc3MiLCJBY2NvdW50IiwiJGh0dHAiLCJnZXRDdXJyZW50VXNlciIsIm1ldGhvZCIsInVybCIsInNlbmRWZXJpZnlDb2RlIiwidXNlck9iaiIsImRhdGEiLCJ2ZXJpZnlDb2RlIiwiZ2V0VXNlckRhdGEiLCJ1cmlVc2VySWQiLCJ1cGRhdGVVc2VyRGF0YSIsIlBheW1lbnQiLCJjaGFyZ2VOb3ciLCJkYXRhT2JqIiwiZm9jdXMiLCIkcm9vdFNjb3BlIiwiJHRpbWVvdXQiLCJuYW1lIiwiJGJyb2FkY2FzdCIsIlBsYW4iLCIkcSIsInByZXZpZXdQbGFuIiwiYWRkU2luZ2xlUHJldmlldyIsInBsYW4iLCJyZXMiLCJyZWoiLCJnZXRTaW5nbGVQcmV2aWV3IiwiaG9tZUN0cmwiLCJwcmV2aW91c1N0YXRlIiwiY3VycmVudFN0YXRlIiwiJG9uIiwiZXYiLCJ0byIsInRvUGFyYW1zIiwiZnJvbSIsImZyb21QYXJhbXMiLCIkZXZlbnQiLCJlbGVtZW50Iiwic3BlZWQiLCJhdXRoQ3RybCIsIiRzY29wZSIsIiRhdXRoIiwiJHN0YXRlIiwiJHdpbmRvdyIsImdldFRva2VuIiwidGhlbiIsImN1cnJlbnRVc2VyIiwiZXJyIiwiZ28iLCJhdXRoX2VudGVyIiwiYXV0aERhdGEiLCJzaWdudXAiLCJzZXRUb2tlbiIsInJlbG9hZCIsImF1dGhlbnRpY2F0ZSIsInByb3ZpZGVyIiwibG9nb3V0IiwibG9jYXRpb24iLCJkYXNoYm9hcmRDdHJsIiwiJGludGVydmFsIiwiY2hlY2tWZXJpZnlQaG9uZVNlbnRTdGF0dXMiLCJjdXJyZW50VXNlckRhdGEiLCJ2ZXJpZnlQaG9uZVNlbnRPdXQiLCJleHBpcmVkVGltZSIsIk51bWJlciIsInBob25lIiwiZXhwaXJlZEF0Iiwibm93VGltZSIsIkRhdGUiLCJub3ciLCJ2ZXJpZnlQaG9uZUNvdW50RG93biIsImxlbmd0aCIsInVzZXJEYXRhIiwiY29kZSIsInZlcmlmaWVkIiwiZG9DaGVja291dCIsInRva2VuIiwic3RyaXBlVG9rZW4iLCJkYXNoYm9hcmRQbGFuQ3RybCIsIiRzdGF0ZVBhcmFtcyIsInVwZGF0ZVRpbWVzIiwidGltZXMiLCJpbnN0YWxsbWVudHNHcmFwaERhdGEiLCJpIiwiaW5zdGFsbG1lbnQiLCJ0b3RhbCIsImhlaWdodCIsInB1c2giLCJwcmljZSIsInN0eWxlIiwid2lkdGgiLCJwcmV2aWV3U2luZ2xlUGxhbiIsImZvY3VzT24iLCJzY29wZSIsImVsZW0iLCJhdHRyIiwiZSIsInRvb2xUaXAiLCJhdHRycyIsImFuZ3VsYXIiLCJvbiIsImhpZGVUb29sdGlwIiwic2hvd1Rvb2x0aXAiLCJ0b29sdGlwIiwibW9kdWxlIiwiY29uZmlnIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCIkYXV0aFByb3ZpZGVyIiwiU3RyaXBlIiwic2V0UHVibGlzaGFibGVLZXkiLCJzdGF0ZSIsImhvbWUiLCJhdXRoRW50cmFuY2UiLCJkYXNoYm9hcmQiLCJkYXNoYm9hcmRfcGF5bWVudCIsImRhc2hib2FyZF9wbGFuIiwiZGFzaGJvYXJkX3BsYW5fc3RhcnQiLCJkYXNoYm9hcmRfcGxhbl9jaG9vc2UiLCJkYXNoYm9hcmRfcGxhbl9zaW5nbGUiLCJkYXNoYm9hcmRfcGxhbl9zaW5nbGVfcHJldmlldyIsImRhc2hib2FyZF9wbGFuX211bHRpcGxlIiwiZGFzaGJvYXJkX2FjY291bnQiLCJvdGhlcndpc2UiLCJ2aWV3cyIsIm1haW4iLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJwYXJlbnQiLCJkYXNoYm9hcmRfc2VjdGlvbiIsImRhc2hib2FyZF9jaGlsZF9zZWN0aW9uIiwiZG9jdW1lbnQiLCJyZWFkeSIsIiRpbmplY3QiLCJzZXJ2aWNlIiwiZmFjdG9yeSIsImRpcmVjdGl2ZSJdLCJtYXBwaW5ncyI6IkFBQUEsWUNJQSxTQUFTQSxRQUNMQyxRQUFRQyxJQUFJLGlCQUNaQyxTQUNBQyxtQkFHSixRQUFTRCxVQUNMRSxFQUFFLFdBQVdGLFFBQ1RHLFdBQVksS0FJcEIsUUFBU0Ysb0JBQ0wsR0FDSUcsR0FEQUMsRUFBZ0IsQ0FFcEJILEdBQUVJLFFBQVFDLE9BQU8sV0FFYkgsRUFBS0YsRUFBRU0sTUFBTUMsWUFDVlAsRUFBRUksUUFBUUcsWUFBYyxLQUNkSixFQUFMRCxHQUNBRixFQUFFLGtCQUFrQlEsWUFBWSxVQUNoQ1IsRUFBRSxrQkFBa0JTLElBQUksZ0JBQWlCLGNBRXpDVCxFQUFFLGtCQUFrQlUsU0FBUyxXQUdyQ1AsRUFBZ0JELEVBRVpGLEVBQUVJLFFBQVFHLFlBQWMsSUFDeEJQLEVBQUUsa0JBQWtCVSxTQUFTLE9BRTdCVixFQUFFSSxRQUFRRyxZQUFjLElBQ3hCUCxFQUFFLGtCQUFrQlEsWUFBWSxPQUVoQ1IsRUFBRUksUUFBUUcsWUFBYyxHQUd4QlAsRUFBRUksUUFBUUcsWUFBYyxLQUN4QlAsRUFBRSxrQkFBa0JTLElBQUksYUFBYyxzQ0FFdENULEVBQUVJLFFBQVFHLFlBQWMsS0FDeEJQLEVBQUUsa0JBQWtCUyxJQUFJLGFBQWMsMENDcENsRCxRQUFTRSxTQUFRQyxHQUNiTixLQUFLTyxlQUFpQixXQUtsQixNQUFPRCxJQUNIRSxPQUFRLE1BQ1JDLElBQUEsMkJBRFJULEtBQUtVLGVBQWlCLFNBQUFDLEdBS2xCLE1BQU9MLElBQ0hFLE9BQVEsT0FDUkMsSUFBQSxvQkFDQUcsS0FBTUQsS0FEZFgsS0FBS2EsV0FBYSxTQUFBRixHQUtkLE1BQU9MLElBQ0hFLE9BQVEs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TSx5QkFDSUosWUFBYSxxREFDYkMsV0FBWSx1QkFJcEJOLHlCQUNBeEcsS0FBTSwwQkFDTmQsSUFBSyxrQkFDTDZILE9BQVEsaUJBQ1JKLE9BQ0lNLHlCQUNJSixZQUFhLCtDQUNiQyxXQUFZLG1CQUlwQkwsbUJBQ0F6RyxLQUFNLG9CQUNOZCxJQUFLLFdBQ0w2SCxPQUFRLFlBQ1JKLE9BQ0lLLG1CQUNJSCxZQUFhLCtCQUNiQyxXQUFZLGtCQ3hLeEIzSSxHQUFFK0ksVUFBVUMsTUFBTXJKLE1DQWxCZ0IsUUFBUXNJLFNBQVcsU0FDbkIxSCxRQUFRMEgsU0FBVyxTQUNuQnZILE1BQU11SCxTQUFXLGFBQWMsWUFDL0JsSCxLQUFLa0gsU0FBVyxNQUhoQmxDLFFBQ0tLLE9BQU8sWUFDUDhCLFFBQVEsVUFBV3ZJLFNBQ25CdUksUUFBUSxVQUFXM0gsU0FDbkI0SCxRQUFRLFFBQVN6SCxPQUNqQndILFFBQVEsT0FBUW5ILE1DTHJCUSxTQUFTMEcsU0FBVyxjQUNwQjlGLFNBQVM4RixTQUFXLFNBQVUsUUFBUyxTQUFVLFVBQVcsV0FDNUQzRSxjQUFjMkUsU0FBVyxTQUFVLFFBQVMsU0FBVSxVQUFXLGFBQWMsVUFBVyxhQUMxRnZELGtCQUFrQnVELFNBQVcsU0FBVSxVQUFXLGVBQWdCLFNBQVUsT0FBUSxjQUhwRmxDLFFBQ0tLLE9BQU8sWUFDUHVCLFdBQVcsV0FBWXBHLFVBQ3ZCb0csV0FBVyxXQUFZeEYsVUFDdkJ3RixXQUFXLGdCQUFpQnJFLGVBQzVCcUUsV0FBVyxvQkFBcUJqRCxtQkNMckNxQixRQUNLSyxPQUFPLFlBQ1BnQyxVQUFVLFVBQVc1QyxTQ0YxQk8sUUFDS0ssT0FBTyxZQUNQZ0MsVUFBVSxVQUFXdkMiLCJmaWxlIjoiYnVuZGxlLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ3BpbmNoQXBwJywgW1xuICAgICAgICAndWkucm91dGVyJyxcbiAgICAgICAgJ3NhdGVsbGl6ZXInLFxuICAgICAgICAnbmdBbmltYXRlJyxcbiAgICAgICAgLy8gJ3VpLmJvb3RzdHJhcCcsXG4gICAgICAgICduZ0ZpbGVVcGxvYWQnLFxuICAgICAgICAnbmdJbWdDcm9wJyxcbiAgICAgICAgJ3N0cmlwZS5jaGVja291dCcsXG4gICAgICAgICdhbmd1bGFyLWxvYWRpbmctYmFyJyxcbiAgICAgICAgJ2FuaW0taW4tb3V0J1xuICAgIF0pXG4gICAgLmNvbmZpZyhmdW5jdGlvbigkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyLCAkYXV0aFByb3ZpZGVyKSB7XG4gICAgICAgIFN0cmlwZS5zZXRQdWJsaXNoYWJsZUtleSgncGtfdGVzdF90MWVUaGhPS2w2ZXNycDZmNGp5V3FVNEonKVxuXG4gICAgICAgIC8vICRhdXRoUHJvdmlkZXJcbiAgICAgICAgLy8gICAgIC5mYWNlYm9vayh7XG4gICAgICAgIC8vICAgICAgICAgY2xpZW50SWQ6ICcyOTgxNjUxMTM4NDkzNjYnXG4gICAgICAgIC8vICAgICB9KTtcblxuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKGhvbWUpXG4gICAgICAgICAgICAuc3RhdGUoYXV0aEVudHJhbmNlKVxuICAgICAgICAgICAgLnN0YXRlKGRhc2hib2FyZClcbiAgICAgICAgICAgIC5zdGF0ZShkYXNoYm9hcmRfcGF5bWVudClcbiAgICAgICAgICAgIC5zdGF0ZShkYXNoYm9hcmRfcGxhbilcbiAgICAgICAgICAgIC5zdGF0ZShkYXNoYm9hcmRfcGxhbl9zdGFydClcbiAgICAgICAgICAgIC5zdGF0ZShkYXNoYm9hcmRfcGxhbl9jaG9vc2UpXG4gICAgICAgICAgICAuc3RhdGUoZGFzaGJvYXJkX3BsYW5fc2luZ2xlKVxuICAgICAgICAgICAgLnN0YXRlKGRhc2hib2FyZF9wbGFuX3NpbmdsZV9wcmV2aWV3KVxuICAgICAgICAgICAgLnN0YXRlKGRhc2hib2FyZF9wbGFuX211bHRpcGxlKVxuICAgICAgICAgICAgLnN0YXRlKGRhc2hib2FyZF9hY2NvdW50KVxuICAgICAgICAgICAgLy8gLnN0YXRlKHBwYWdlKVxuICAgICAgICAgICAgLy8gLnN0YXRlKHBwYWdlX3Byb2plY3RzKVxuICAgICAgICAgICAgLy8gLnN0YXRlKHBwYWdlX2xpa2VkKVxuICAgICAgICAgICAgLy8gLnN0YXRlKHBwYWdlX2ZvbGxvd2VycylcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcm9qZWN0cGFnZSlcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcm9qZWN0U2V0dGluZylcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcm9qZWN0U2V0dGluZ19nZW5lcmFsKVxuICAgICAgICAgICAgLy8gLnN0YXRlKHByb2plY3RTZXR0aW5nX3JlcXVlc3QpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHJvamVjdFNldHRpbmdfcHJpdmFjeSlcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcm9qZWN0U2V0dGluZ19kYW5nZXIpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHJvZmlsZVNldHRpbmcpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHJvZmlsZVNldHRpbmdfZ2VuZXJhbClcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcm9maWxlU2V0dGluZ19yZXF1ZXN0KVxuICAgICAgICAgICAgLy8gLnN0YXRlKHByb2ZpbGVTZXR0aW5nX3ByaXZhY3kpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHJvZmlsZVNldHRpbmdfZGFuZ2VyKVxuXG5cbiAgICAgICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xuICAgIH0pO1xuXG5cbmxldCBob21lID0ge1xuICAgIG5hbWU6ICdob21lJyxcbiAgICB1cmw6ICcvJyxcbiAgICB2aWV3czoge1xuICAgICAgICBtYWluOiB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL2hvbWUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnaG9tZUN0cmwnXG4gICAgICAgIH1cbiAgICB9XG59XG5sZXQgYXV0aEVudHJhbmNlID0ge1xuICAgIG5hbWU6ICdhdXRoRW50cmFuY2UnLFxuICAgIHVybDogJy9lbnRyYW5jZScsXG4gICAgdmlld3M6IHtcbiAgICAgICAgbWFpbjoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9lbnRyYW5jZS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdhdXRoQ3RybCdcbiAgICAgICAgfVxuICAgIH1cbn1cbmxldCBkYXNoYm9hcmQgPSB7XG4gICAgbmFtZTogJ2Rhc2hib2FyZCcsXG4gICAgdXJsOiAnL2Rhc2hib2FyZCcsXG4gICAgdmlld3M6IHtcbiAgICAgICAgbWFpbjoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9kYXNoYm9hcmQuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnZGFzaGJvYXJkQ3RybCdcbiAgICAgICAgfVxuICAgIH1cbn1cblxubGV0IGRhc2hib2FyZF9wYXltZW50ID0ge1xuICAgIG5hbWU6ICdkYXNoYm9hcmRfcGF5bWVudCcsXG4gICAgdXJsOiAnL3BheW1lbnQnLFxuICAgIHBhcmVudDogJ2Rhc2hib2FyZCcsXG4gICAgdmlld3M6IHtcbiAgICAgICAgZGFzaGJvYXJkX3NlY3Rpb246IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvZGFzaGJvYXJkX3BheW1lbnQuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnZGFzaGJvYXJkQ3RybCdcbiAgICAgICAgfVxuICAgIH1cbn1cbmxldCBkYXNoYm9hcmRfcGxhbiA9IHtcbiAgICBuYW1lOiAnZGFzaGJvYXJkX3BsYW4nLFxuICAgIHVybDogJy9wbGFuJyxcbiAgICBwYXJlbnQ6ICdkYXNoYm9hcmQnLFxuICAgIHZpZXdzOiB7XG4gICAgICAgIGRhc2hib2FyZF9zZWN0aW9uOiB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL2Rhc2hib2FyZF9wbGFuLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2Rhc2hib2FyZEN0cmwnXG4gICAgICAgIH1cbiAgICB9XG59XG5sZXQgZGFzaGJvYXJkX3BsYW5fc3RhcnQgPSB7XG4gICAgbmFtZTogJ2Rhc2hib2FyZF9wbGFuX3N0YXJ0JyxcbiAgICB1cmw6ICcvc3RhcnQnLFxuICAgIHBhcmVudDogJ2Rhc2hib2FyZF9wbGFuJyxcbiAgICB2aWV3czoge1xuICAgICAgICBkYXNoYm9hcmRfY2hpbGRfc2VjdGlvbjoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9kYXNoYm9hcmQvZGFzaGJvYXJkX3BsYW5fc3RhcnQuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnZGFzaGJvYXJkQ3RybCdcbiAgICAgICAgfVxuICAgIH1cbn1cbmxldCBkYXNoYm9hcmRfcGxhbl9jaG9vc2UgPSB7XG4gICAgbmFtZTogJ2Rhc2hib2FyZF9wbGFuX2Nob29zZScsXG4gICAgdXJsOiAnL2Nob29zZScsXG4gICAgcGFyZW50OiAnZGFzaGJvYXJkX3BsYW4nLFxuICAgIHZpZXdzOiB7XG4gICAgICAgIGRhc2hib2FyZF9jaGlsZF9zZWN0aW9uOiB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL2Rhc2hib2FyZC9kYXNoYm9hcmRfcGxhbl9jaG9vc2UuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnZGFzaGJvYXJkQ3RybCdcbiAgICAgICAgfVxuICAgIH1cbn1cbmxldCBkYXNoYm9hcmRfcGxhbl9zaW5nbGUgPSB7XG4gICAgbmFtZTogJ2Rhc2hib2FyZF9wbGFuX3NpbmdsZScsXG4gICAgdXJsOiAnL2Nob29zZS9zaW5nbGUnLFxuICAgIHBhcmVudDogJ2Rhc2hib2FyZF9wbGFuJyxcbiAgICB2aWV3czoge1xuICAgICAgICBkYXNoYm9hcmRfY2hpbGRfc2VjdGlvbjoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9kYXNoYm9hcmQvZGFzaGJvYXJkX3BsYW5fc2luZ2xlLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2Rhc2hib2FyZFBsYW5DdHJsJ1xuICAgICAgICB9XG4gICAgfVxufVxubGV0IGRhc2hib2FyZF9wbGFuX3NpbmdsZV9wcmV2aWV3ID0ge1xuICAgIG5hbWU6ICdkYXNoYm9hcmRfcGxhbl9zaW5nbGVfcHJldmlldycsXG4gICAgdXJsOiAnL2Nob29zZS9zaW5nbGUvcHJldmlldycsXG4gICAgcGFyZW50OiAnZGFzaGJvYXJkX3BsYW4nLFxuICAgIHZpZXdzOiB7XG4gICAgICAgIGRhc2hib2FyZF9jaGlsZF9zZWN0aW9uOiB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL2Rhc2hib2FyZC9kYXNoYm9hcmRfcGxhbl9zaW5nbGVfcHJldmlldy5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdkYXNoYm9hcmRQbGFuQ3RybCdcbiAgICAgICAgfVxuICAgIH1cbn1cbmxldCBkYXNoYm9hcmRfcGxhbl9tdWx0aXBsZSA9IHtcbiAgICBuYW1lOiAnZGFzaGJvYXJkX3BsYW5fbXVsdGlwbGUnLFxuICAgIHVybDogJy9jaG9vc2UvbXV0aXBsZScsXG4gICAgcGFyZW50OiAnZGFzaGJvYXJkX3BsYW4nLFxuICAgIHZpZXdzOiB7XG4gICAgICAgIGRhc2hib2FyZF9jaGlsZF9zZWN0aW9uOiB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL2Rhc2hib2FyZC9kYXNoYm9hcmRfcGxhbl9tdWx0aXBsZS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdkYXNoYm9hcmRDdHJsJ1xuICAgICAgICB9XG4gICAgfVxufVxubGV0IGRhc2hib2FyZF9hY2NvdW50ID0ge1xuICAgIG5hbWU6ICdkYXNoYm9hcmRfYWNjb3VudCcsXG4gICAgdXJsOiAnL2FjY291bnQnLFxuICAgIHBhcmVudDogJ2Rhc2hib2FyZCcsXG4gICAgdmlld3M6IHtcbiAgICAgICAgZGFzaGJvYXJkX3NlY3Rpb246IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvZGFzaGJvYXJkX2FjY291bnQuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnZGFzaGJvYXJkQ3RybCdcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsIid1c2Ugc3RyaWN0J1xuXG4kKGRvY3VtZW50KS5yZWFkeShpbml0KTtcblxuZnVuY3Rpb24gaW5pdCgpIHtcbiAgICBjb25zb2xlLmxvZygnanF1ZXJ5IGxvYWRlZCcpO1xuICAgIHN0aWNreSgpXG4gICAgd2luZG93U2Nyb2xsRG93bigpXG59XG5cbmZ1bmN0aW9uIHN0aWNreSgpIHtcbiAgICAkKFwiLnN0aWNreVwiKS5zdGlja3koe1xuICAgICAgICB0b3BTcGFjaW5nOiA2MFxuICAgIH0pXG59XG5cbmZ1bmN0aW9uIHdpbmRvd1Njcm9sbERvd24oKSB7XG4gICAgdmFyIGxhc3RTY3JvbGxUb3AgPSAwXG4gICAgdmFyIHN0XG4gICAgJCh3aW5kb3cpLnNjcm9sbChmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJCh3aW5kb3cpLnNjcm9sbFRvcCgpKTtcbiAgICAgICAgc3QgPSAkKHRoaXMpLnNjcm9sbFRvcCgpO1xuICAgICAgICBpZigkKHdpbmRvdykuc2Nyb2xsVG9wKCkgPiAzMCl7XG4gICAgICAgICAgICBpZiAoc3QgPCBsYXN0U2Nyb2xsVG9wKSB7XG4gICAgICAgICAgICAgICAgJCgnLmhvbWUtcGFnZSBuYXYnKS5yZW1vdmVDbGFzcygnZm9sZGVkJylcbiAgICAgICAgICAgICAgICAkKCcuaG9tZS1wYWdlIG5hdicpLmNzcygnYm9yZGVyLWJvdHRvbScsICcwcHggc29saWQnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJCgnLmhvbWUtcGFnZSBuYXYnKS5hZGRDbGFzcygnZm9sZGVkJylcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBsYXN0U2Nyb2xsVG9wID0gc3RcblxuICAgICAgICBpZiAoJCh3aW5kb3cpLnNjcm9sbFRvcCgpIDwgMTApIHtcbiAgICAgICAgICAgICQoJy5ob21lLXBhZ2UgbmF2JykuYWRkQ2xhc3MoJ3RvcCcpXG4gICAgICAgIH1cbiAgICAgICAgaWYgKCQod2luZG93KS5zY3JvbGxUb3AoKSA+IDEwKSB7XG4gICAgICAgICAgICAkKCcuaG9tZS1wYWdlIG5hdicpLnJlbW92ZUNsYXNzKCd0b3AnKVxuICAgICAgICB9XG4gICAgICAgIGlmICgkKHdpbmRvdykuc2Nyb2xsVG9wKCkgPiAzMCkge1xuXG4gICAgICAgIH1cbiAgICAgICAgaWYgKCQod2luZG93KS5zY3JvbGxUb3AoKSA8IDU0MCkge1xuICAgICAgICAgICAgJCgnLmhvbWUtcGFnZSBuYXYnKS5jc3MoJ2JveC1zaGFkb3cnLCAnaW5zZXQgMCAtMXB4IDBweCAwcHggcmdiYSgwLDAsMCwwKScpO1xuICAgICAgICB9XG4gICAgICAgIGlmICgkKHdpbmRvdykuc2Nyb2xsVG9wKCkgPiA1NDApIHtcbiAgICAgICAgICAgICQoJy5ob21lLXBhZ2UgbmF2JykuY3NzKCdib3gtc2hhZG93JywgJ2luc2V0IDAgLTFweCAwcHggMHB4IHJnYmEoMCwwLDAsMC4xKScpO1xuICAgICAgICB9XG5cbiAgICB9KVxufVxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5hbmd1bGFyXG4gICAgLm1vZHVsZSgncGluY2hBcHAnKVxuICAgIC5zZXJ2aWNlKCdBY2NvdW50JywgQWNjb3VudClcbiAgICAuc2VydmljZSgnUGF5bWVudCcsIFBheW1lbnQpXG4gICAgLmZhY3RvcnkoJ2ZvY3VzJywgZm9jdXMpXG4gICAgLnNlcnZpY2UoJ1BsYW4nLCBQbGFuKVxuICAgIC8vIC5kaXJlY3RpdmUoJ3N0YXRlTG9hZGluZ0luZGljYXRvcicsIHN0YXRlTG9hZGluZ0luZGljYXRvcilcbmZ1bmN0aW9uIEFjY291bnQoJGh0dHApIHtcbiAgICB0aGlzLmdldEN1cnJlbnRVc2VyID0gKCkgPT4ge1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgIHVybDogYC9hcGkvYXV0aC9jdXJyZW50VXNlcmBcbiAgICAgICAgfSlcbiAgICB9XG4gICAgdGhpcy5zZW5kVmVyaWZ5Q29kZSA9ICh1c2VyT2JqKSA9PiB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIHVybDogYC9hcGkvdmVyaWZ5L3Bob25lYCxcbiAgICAgICAgICAgIGRhdGE6IHVzZXJPYmpcbiAgICAgICAgfSlcbiAgICB9XG4gICAgdGhpcy52ZXJpZnlDb2RlID0gKHVzZXJPYmopID0+IHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BVVCcsXG4gICAgICAgICAgICB1cmw6IGAvYXBpL3ZlcmlmeS9waG9uZWAsXG4gICAgICAgICAgICBkYXRhOiB1c2VyT2JqXG4gICAgICAgIH0pXG4gICAgfVxuICAgIHRoaXMuZ2V0VXNlckRhdGEgPSAodXJpVXNlcklkKSA9PiB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgdXJsOiBgL2FwaS91c2Vycy8ke3VyaVVzZXJJZH1gXG4gICAgICAgIH0pXG4gICAgfVxuICAgIHRoaXMudXBkYXRlVXNlckRhdGEgPSAodXJpVXNlcklkLCB1cGRhdGVVc2VyRGF0YSkgPT4ge1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUFVUJyxcbiAgICAgICAgICAgIHVybDogYC9hcGkvdXNlcnMvJHt1cmlVc2VySWR9YCxcbiAgICAgICAgICAgIGRhdGE6IHVwZGF0ZVVzZXJEYXRhXG4gICAgICAgIH0pXG4gICAgfVxufVxuXG5mdW5jdGlvbiBQYXltZW50KCRodHRwKSB7XG4gICAgdGhpcy5jaGFyZ2VOb3cgPSAoZGF0YU9iaikgPT4ge1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICB1cmw6IGAvYXBpL3BheW1lbnQvY2hhcmdlTm93YCxcbiAgICAgICAgICAgIGRhdGE6IGRhdGFPYmpcbiAgICAgICAgfSlcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGZvY3VzKCRyb290U2NvcGUsICR0aW1lb3V0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2ZvY3VzT24nLCBuYW1lKTtcbiAgICAgICAgfSwgMCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBQbGFuKCRxKSB7XG4gICAgdmFyIHByZXZpZXdQbGFuID0ge31cbiAgICB0aGlzLmFkZFNpbmdsZVByZXZpZXcgPSAocGxhbikgPT4ge1xuICAgICAgICByZXR1cm4gJHEoKHJlcywgcmVqKSA9PiB7XG4gICAgICAgICAgICBwcmV2aWV3UGxhbiA9IHBsYW5cbiAgICAgICAgICAgIHJlcyhwcmV2aWV3UGxhbilcbiAgICAgICAgfSlcbiAgICB9XG4gICAgdGhpcy5nZXRTaW5nbGVQcmV2aWV3ID0gKCkgPT4ge1xuICAgICAgICByZXR1cm4gJHEoKHJlcywgcmVqKSA9PiB7XG4gICAgICAgICAgICBpZihwcmV2aWV3UGxhbil7XG4gICAgICAgICAgICAgICAgcmVzKHByZXZpZXdQbGFuKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH1cbn1cbi8vIGZ1bmN0aW9uIHN0YXRlTG9hZGluZ0luZGljYXRvcigkcm9vdFNjb3BlKSB7XG4vLyAgICAgcmV0dXJuIHtcbi8vICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbi8vICAgICAgICAgdGVtcGxhdGU6IFwiPGRpdiBuZy1zaG93PSdpc1N0YXRlTG9hZGluZycgY2xhc3M9J2xvYWRpbmctaW5kaWNhdG9yJz5cIiArXG4vLyAgICAgICAgICAgICBcIjxkaXYgY2xhc3M9J2xvYWRpbmctaW5kaWNhdG9yLWJvZHknPlwiICtcbi8vICAgICAgICAgICAgIFwiPGgzIGNsYXNzPSdsb2FkaW5nLXRpdGxlJz5Mb2FkaW5nLi4uPC9oMz5cIiArXG4vLyAgICAgICAgICAgICBcIjxkaXYgY2xhc3M9J3NwaW5uZXInPjxjaGFzaW5nLWRvdHMtc3Bpbm5lcj48L2NoYXNpbmctZG90cy1zcGlubmVyPjwvZGl2PlwiICtcbi8vICAgICAgICAgICAgIFwiPC9kaXY+XCIgK1xuLy8gICAgICAgICAgICAgXCI8L2Rpdj5cIixcbi8vICAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbi8vICAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW0sIGF0dHJzKSB7XG4vLyAgICAgICAgICAgICBzY29wZS5pc1N0YXRlTG9hZGluZyA9IGZhbHNlO1xuLy9cbi8vICAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdGFydCcsIGZ1bmN0aW9uKCkge1xuLy8gICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzdGFydCcpXG4vLyAgICAgICAgICAgICAgICAgc2NvcGUuaXNTdGF0ZUxvYWRpbmcgPSB0cnVlO1xuLy8gICAgICAgICAgICAgfSk7XG4vLyAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3VjY2VzcycsIGZ1bmN0aW9uKCkge1xuLy8gICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjb21wbGV0ZScpXG4vLyAgICAgICAgICAgICAgICAgc2NvcGUuaXNTdGF0ZUxvYWRpbmcgPSBmYWxzZTtcbi8vICAgICAgICAgICAgIH0pO1xuLy8gICAgICAgICB9XG4vLyAgICAgfTtcbi8vIH1cbiIsIid1c2Ugc3RyaWN0JztcblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ3BpbmNoQXBwJylcbiAgICAuY29udHJvbGxlcignaG9tZUN0cmwnLCBob21lQ3RybClcbiAgICAuY29udHJvbGxlcignYXV0aEN0cmwnLCBhdXRoQ3RybClcbiAgICAuY29udHJvbGxlcignZGFzaGJvYXJkQ3RybCcsIGRhc2hib2FyZEN0cmwpXG4gICAgLmNvbnRyb2xsZXIoJ2Rhc2hib2FyZFBsYW5DdHJsJywgZGFzaGJvYXJkUGxhbkN0cmwpXG5cbmZ1bmN0aW9uIGhvbWVDdHJsKCRyb290U2NvcGUpIHtcbiAgICBjb25zb2xlLmxvZygnaG9tZUN0cmwgbG9hZGVkJylcbiAgICAkcm9vdFNjb3BlLnByZXZpb3VzU3RhdGVcbiAgICAkcm9vdFNjb3BlLmN1cnJlbnRTdGF0ZVxuICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdWNjZXNzJywgZnVuY3Rpb24oZXYsIHRvLCB0b1BhcmFtcywgZnJvbSwgZnJvbVBhcmFtcykge1xuICAgICAgICAkcm9vdFNjb3BlLnByZXZpb3VzU3RhdGUgPSBmcm9tLm5hbWU7XG4gICAgICAgICRyb290U2NvcGUuY3VycmVudFN0YXRlID0gdG8ubmFtZTtcbiAgICAgICAgY29uc29sZS5sb2coJ1ByZXZpb3VzIHN0YXRlOicgKyAkcm9vdFNjb3BlLnByZXZpb3VzU3RhdGUpXG4gICAgICAgIGNvbnNvbGUubG9nKCdDdXJyZW50IHN0YXRlOicgKyAkcm9vdFNjb3BlLmN1cnJlbnRTdGF0ZSlcbiAgICB9KVxuICAgICRyb290U2NvcGUuJG9uKCdhbmltU3RhcnQnLCBmdW5jdGlvbigkZXZlbnQsIGVsZW1lbnQsIHNwZWVkKSB7fSlcbiAgICAkcm9vdFNjb3BlLiRvbignYW5pbUVuZCcsIGZ1bmN0aW9uKCRldmVudCwgZWxlbWVudCwgc3BlZWQpIHt9KVxufVxuXG5mdW5jdGlvbiBhdXRoQ3RybCgkc2NvcGUsICRhdXRoLCAkc3RhdGUsIEFjY291bnQsICR3aW5kb3cpIHtcbiAgICBjb25zb2xlLmxvZygnYXV0aEN0cmwgbG9hZGVkJylcblxuICAgICRzY29wZS5nZXRDdXJyZW50VXNlciA9ICgpID0+IHtcbiAgICAgICAgZ2V0Q3VycmVudFVzZXIoKVxuICAgIH1cblxuICAgICRzY29wZS5hdXRoX2VudGVyID0gKGF1dGhEYXRhKSA9PiB7XG4gICAgICAgICRhdXRoLnNpZ251cChhdXRoRGF0YSlcbiAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgJGF1dGguc2V0VG9rZW4ocmVzKVxuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnZGFzaGJvYXJkJywge30sIHtcbiAgICAgICAgICAgICAgICAgICAgcmVsb2FkOiB0cnVlXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncmVzIEBhdXRoX2VudGVyOiAnLCByZXMuZGF0YSlcbiAgICAgICAgICAgICAgICBnZXRDdXJyZW50VXNlcigpXG4gICAgICAgICAgICAgICAgICAgIC8vIHRvYXN0ci5pbmZvKCdZb3UgaGF2ZSBzdWNjZXNzZnVsbHkgY3JlYXRlZCBhIG5ldyBhY2NvdW50IGFuZCBoYXZlIGJlZW4gc2lnbmVkLWluJyk7XG4gICAgICAgICAgICB9LCBlcnIgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnIgQGF1dGhfZW50ZXI6ICcsIGVycilcbiAgICAgICAgICAgICAgICAgICAgLy8gdG9hc3RyLmVycm9yKHJlc3BvbnNlLmRhdGEubWVzc2FnZSk7XG4gICAgICAgICAgICB9KVxuICAgIH1cblxuICAgICRzY29wZS5hdXRoZW50aWNhdGUgPSAocHJvdmlkZXIpID0+IHtcbiAgICAgICAgJGF1dGguYXV0aGVudGljYXRlKHByb3ZpZGVyKTtcbiAgICB9XG4gICAgJHNjb3BlLmxvZ291dCA9ICgpID0+IHtcbiAgICAgICAgJGF1dGgubG9nb3V0KClcbiAgICAgICAgJHNjb3BlLmN1cnJlbnRVc2VyID0gbnVsbDtcbiAgICAgICAgJHN0YXRlLmdvKCdob21lJywge30sIHtcbiAgICAgICAgICAgIHJlbG9hZDogdHJ1ZVxuICAgICAgICB9KVxuICAgICAgICAkd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldEN1cnJlbnRVc2VyKCkge1xuICAgICAgICBpZiAoJGF1dGguZ2V0VG9rZW4oKSkge1xuICAgICAgICAgICAgQWNjb3VudC5nZXRDdXJyZW50VXNlcigkYXV0aC5nZXRUb2tlbigpKVxuICAgICAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXMgQGdldEN1cnJlbnRVc2VyOiAnLCByZXMuZGF0YSlcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnRVc2VyID0gcmVzLmRhdGFcbiAgICAgICAgICAgICAgICB9LCBlcnIgPT4ge1xuICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2F1dGhFbnRyYW5jZScpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH1cblxufVxuXG5mdW5jdGlvbiBkYXNoYm9hcmRDdHJsKCRzY29wZSwgJGF1dGgsICRzdGF0ZSwgQWNjb3VudCwgJHJvb3RTY29wZSwgUGF5bWVudCwgJGludGVydmFsKSB7XG4gICAgY29uc29sZS5sb2coJ2Rhc2hib2FyZEN0cmwgbG9hZGVkJylcbiAgICBBY2NvdW50LmdldEN1cnJlbnRVc2VyKCRhdXRoLmdldFRva2VuKCkpXG4gICAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICBpZiAoISRyb290U2NvcGUuY3VycmVudFVzZXIpIHtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gcmVzLmRhdGFcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXMgQGdldEN1cnJlbnRVc2VyOiAnLCByZXMuZGF0YSlcbiAgICAgICAgICAgIGNoZWNrVmVyaWZ5UGhvbmVTZW50U3RhdHVzKHJlcy5kYXRhKVxuICAgICAgICB9LCBlcnIgPT4ge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdob21lJylcbiAgICAgICAgfSlcblxuICAgIGZ1bmN0aW9uIGNoZWNrVmVyaWZ5UGhvbmVTZW50U3RhdHVzKGN1cnJlbnRVc2VyRGF0YSkge1xuICAgICAgICAkc2NvcGUudmVyaWZ5UGhvbmVTZW50T3V0ID0gZmFsc2VcblxuICAgICAgICBsZXQgZXhwaXJlZFRpbWUgPSBOdW1iZXIoY3VycmVudFVzZXJEYXRhLnBob25lLnZlcmlmeUNvZGUuZXhwaXJlZEF0KVxuICAgICAgICBsZXQgbm93VGltZSA9IERhdGUubm93KClcbiAgICAgICAgaWYgKGV4cGlyZWRUaW1lID4gbm93VGltZSkge1xuICAgICAgICAgICAgJHNjb3BlLnZlcmlmeVBob25lU2VudE91dCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgJHNjb3BlLnZlcmlmeVBob25lQ291bnREb3duID0gKCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGAke2V4cGlyZWRUaW1lfWBcbiAgICAgICAgfVxuICAgIH1cblxuICAgICRzY29wZS5zZW5kVmVyaWZ5Q29kZSA9IChwaG9uZSkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygncGhvbmU6ICcsIHBob25lKVxuICAgICAgICBpZiAocGhvbmUubGVuZ3RoID4gNSkge1xuICAgICAgICAgICAgdmFyIHVzZXJPYmogPSB7XG4gICAgICAgICAgICAgICAgdXNlckRhdGE6ICRyb290U2NvcGUuY3VycmVudFVzZXIsXG4gICAgICAgICAgICAgICAgcGhvbmU6IHBob25lXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBBY2NvdW50LnNlbmRWZXJpZnlDb2RlKHVzZXJPYmopXG4gICAgICAgICAgICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlcyBAc2VuZFZlcmlmeUNvZGU6ICcsIHJlcy5kYXRhKVxuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyLnBob25lLmRhdGEgPSBwaG9uZTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnZlcmlmeVBob25lU2VudE91dCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfSwgZXJyID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2VyciBAc2VuZFZlcmlmeUNvZGU6ICcsIGVycik7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH1cbiAgICAkc2NvcGUudmVyaWZ5Q29kZSA9IChjb2RlKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdjb2RlOiAnLCBjb2RlKVxuICAgICAgICBpZiAoY29kZS5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgIHZhciB1c2VyT2JqID0ge1xuICAgICAgICAgICAgICAgIHVzZXJEYXRhOiAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyLFxuICAgICAgICAgICAgICAgIGNvZGU6IGNvZGVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIEFjY291bnQudmVyaWZ5Q29kZSh1c2VyT2JqKVxuICAgICAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXMgQHZlcmlmeUNvZGU6ICcsIHJlcy5kYXRhKVxuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyLnBob25lLnZlcmlmaWVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9LCBlcnIgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZXJyIEB2ZXJpZnlDb2RlOiAnLCBlcnIpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAkc2NvcGUuZG9DaGVja291dCA9ICh0b2tlbikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygnZmZmJyk7XG4gICAgICAgIGNvbnNvbGUubG9nKCd0b2tlbjogJywgdG9rZW4pO1xuICAgICAgICB2YXIgZGF0YU9iaiA9IHtcbiAgICAgICAgICAgIHN0cmlwZVRva2VuOiB0b2tlbixcbiAgICAgICAgICAgIHVzZXJEYXRhOiAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyXG4gICAgICAgIH1cbiAgICAgICAgUGF5bWVudC5jaGFyZ2VOb3coZGF0YU9iaikudGhlbihyZXMgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlczogJywgcmVzLmRhdGEpO1xuICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnI6ICcsIGVycik7XG4gICAgICAgIH0pXG4gICAgfVxufVxuXG5mdW5jdGlvbiBkYXNoYm9hcmRQbGFuQ3RybCgkc2NvcGUsIEFjY291bnQsICRzdGF0ZVBhcmFtcywgJHN0YXRlLCBQbGFuLCAkcm9vdFNjb3BlKSB7XG4gICAgY29uc29sZS5sb2coJ2Rhc2hib2FyZFBsYW5DdHJsIGxvYWRlZCcpO1xuXG4gICAgaWYgKCRyb290U2NvcGUuY3VycmVudFN0YXRlID09ICdkYXNoYm9hcmRfcGxhbl9zaW5nbGUnKSB7XG4gICAgICAgICRzY29wZS51cGRhdGVUaW1lcyA9ICh0aW1lcykgPT4ge1xuICAgICAgICAgICAgJHNjb3BlLmluc3RhbGxtZW50c0dyYXBoRGF0YSA9IFtdXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRpbWVzOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgaW5zdGFsbG1lbnQgPSB+figoJHNjb3BlLnBsYW4udG90YWwgLyB0aW1lcykpO1xuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSB+figyMDAgKiAoMiAvIHRpbWVzKSlcbiAgICAgICAgICAgICAgICAkc2NvcGUuaW5zdGFsbG1lbnRzR3JhcGhEYXRhLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBwcmljZTogaW5zdGFsbG1lbnQsXG4gICAgICAgICAgICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IGAke2hlaWdodH1weGAsXG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogYDkwJWBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUucHJldmlld1NpbmdsZVBsYW4gPSAocGxhbikgPT4ge1xuICAgICAgICAgICAgUGxhbi5hZGRTaW5nbGVQcmV2aWV3KHBsYW4pLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2Rhc2hib2FyZF9wbGFuX3NpbmdsZV9wcmV2aWV3JylcbiAgICAgICAgICAgIH0sIGVyciA9PiBjb25zb2xlLmxvZygnZXJyIEBhZGRTaW5nbGVQcmV2aWV3OiAnLCBlcnIpKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCRyb290U2NvcGUuY3VycmVudFN0YXRlID09ICdkYXNoYm9hcmRfcGxhbl9zaW5nbGVfcHJldmlldycpIHtcbiAgICAgICAgUGxhbi5nZXRTaW5nbGVQcmV2aWV3KCkudGhlbihyZXMgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlcyBAZ2V0U2luZ2xlUHJldmlldzogJywgcmVzKVxuICAgICAgICB9LCBlcnIgPT4gY29uc29sZS5sb2coJ2VyciBAZ2V0U2luZ2xlUHJldmlldzogJywgZXJyKSlcbiAgICB9XG59XG4iLCIndXNlIHN0cmljdCc7XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdwaW5jaEFwcCcpXG4gICAgLmRpcmVjdGl2ZSgnZm9jdXNPbicsIGZvY3VzT24pXG5cbmZ1bmN0aW9uIGZvY3VzT24oKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBlbGVtLCBhdHRyKSB7XG4gICAgICAgIHNjb3BlLiRvbignZm9jdXNPbicsIGZ1bmN0aW9uKGUsIG5hbWUpIHtcbiAgICAgICAgICAgIGlmIChuYW1lID09PSBhdHRyLmZvY3VzT24pIHtcbiAgICAgICAgICAgICAgICBlbGVtWzBdLmZvY3VzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG59XG4iLCIndXNlIHN0cmljdCc7XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdwaW5jaEFwcCcpXG4gICAgLmRpcmVjdGl2ZSgndG9vbFRpcCcsIHRvb2xUaXApXG5cbmZ1bmN0aW9uIHRvb2xUaXAoKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgICBhbmd1bGFyLmVsZW1lbnQoJy50b29sLXRpcCcpLm9uKCdjbGljayBtb3VzZWxlYXZlJywgaGlkZVRvb2x0aXApO1xuICAgICAgICBhbmd1bGFyLmVsZW1lbnQoJy50b29sLXRpcCcpLm9uKCdtb3VzZWVudGVyJywgc2hvd1Rvb2x0aXApO1xuICAgIH07XG59XG5cbmZ1bmN0aW9uIGhpZGVUb29sdGlwKCkge1xuICAgICQodGhpcykudG9vbHRpcCgnaGlkZScpO1xufVxuXG5mdW5jdGlvbiBzaG93VG9vbHRpcCgpIHtcbiAgICAkKHRoaXMpLnRvb2x0aXAoJ3Nob3cnKTtcbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
