"use strict";function init(){console.log("jquery loaded"),sticky(),windowScrollDown()}function sticky(){$(".sticky").sticky({topSpacing:60})}function windowScrollDown(){var e,o=0;$(window).scroll(function(){e=$(this).scrollTop(),$(window).scrollTop()>30&&(o>e?($(".home-page nav").removeClass("folded"),$(".home-page nav").css("border-bottom","0px solid")):$(".home-page nav").addClass("folded")),o=e,$(window).scrollTop()<10&&$(".home-page nav").addClass("top"),$(window).scrollTop()>10&&$(".home-page nav").removeClass("top"),$(window).scrollTop()>30,$(window).scrollTop()<540&&$(".home-page nav").css("box-shadow","inset 0 -1px 0px 0px rgba(0,0,0,0)"),$(window).scrollTop()>540&&$(".home-page nav").css("box-shadow","inset 0 -1px 0px 0px rgba(0,0,0,0.1)")})}function Account(e){this.getCurrentUser=function(){return e({method:"GET",url:"/api/auth/currentUser"})},this.sendVerifyCode=function(o){return e({method:"POST",url:"/api/verify/phone",data:o})},this.verifyCode=function(o){return e({method:"PUT",url:"/api/verify/phone",data:o})},this.getUserData=function(o){return e({method:"GET",url:"/api/users/"+o})},this.updateUserData=function(o,t){return e({method:"PUT",url:"/api/users/"+o,data:t})}}function Payment(e){this.chargeNow=function(o){return e({method:"POST",url:"/api/payment/chargeNow",data:o})}}function focus(e,o){return function(t){o(function(){e.$broadcast("focusOn",t)},0)}}function Plan(e){this.addSinglePreview=function(o){return localStorage.planPreviewData="",e(function(e,t){localStorage.planPreviewData=JSON.stringify(o),e(localStorage.planPreviewData)})},this.getSinglePreview=function(){return e(function(e,o){localStorage.planPreviewData&&e(JSON.parse(localStorage.planPreviewData))})}}function homeCtrl(e){console.log("homeCtrl loaded"),e.previousState,e.currentState,e.$on("$stateChangeSuccess",function(o,t,a,n,r){e.previousState=n.name,e.currentState=t.name,console.log("Previous state:"+e.previousState),console.log("Current state:"+e.currentState)}),e.$on("animStart",function(e,o,t){}),e.$on("animEnd",function(e,o,t){})}function authCtrl(e,o,t,a,n){function r(){o.getToken()&&a.getCurrentUser(o.getToken()).then(function(o){console.log("res @getCurrentUser: ",o.data),e.currentUser=o.data},function(e){t.go("authEntrance")})}console.log("authCtrl loaded"),e.getCurrentUser=function(){r()},e.auth_enter=function(e){o.signup(e).then(function(e){o.setToken(e),t.go("dashboard",{},{reload:!0}),console.log("res @auth_enter: ",e.data),r()},function(e){console.log("err @auth_enter: ",e)})},e.authenticate=function(e){o.authenticate(e)},e.logout=function(){o.logout(),e.currentUser=null,t.go("home",{},{reload:!0}),n.location.reload()}}function dashboardCtrl(e,o,t,a,n,r,l){function s(o){e.verifyPhoneSentOut=!1;var t=Number(o.phone.verifyCode.expiredAt),a=Date.now();t>a&&(e.verifyPhoneSentOut=!0),e.verifyPhoneCountDown=function(){return""+t}}console.log("dashboardCtrl loaded"),a.getCurrentUser(o.getToken()).then(function(e){n.currentUser||(n.currentUser=e.data),console.log("res @getCurrentUser: ",e.data),s(e.data)},function(e){t.go("home")}),e.sendVerifyCode=function(o){if(console.log("phone: ",o),o.length>5){var t={userData:n.currentUser,phone:o};a.sendVerifyCode(t).then(function(t){console.log("res @sendVerifyCode: ",t.data),n.currentUser.phone.data=o,e.verifyPhoneSentOut=!0},function(e){console.log("err @sendVerifyCode: ",e)})}},e.verifyCode=function(e){if(console.log("code: ",e),0!==e.length){var o={userData:n.currentUser,code:e};a.verifyCode(o).then(function(e){console.log("res @verifyCode: ",e.data),n.currentUser.phone.verified=!0},function(e){console.log("err @verifyCode: ",e)})}},e.doCheckout=function(e){console.log("fff"),console.log("token: ",e);var o={stripeToken:e,userData:n.currentUser};r.chargeNow(o).then(function(e){console.log("res: ",e.data)},function(e){console.log("err: ",e)})}}function dashboardPlanCtrl(e,o,t,a,n,r){if(console.log("dashboardPlanCtrl loaded"),"dashboard_plan_single"==r.currentState&&(e.updateTimes=function(o){e.installmentsGraphData=[];for(var t=0;o>t;t++){var a=~~(e.plan.total/o),n=~~(200*(2/o));e.installmentsGraphData.push({price:a,style:{height:n+"px",width:"90%"}})}},e.previewSinglePlan=function(e){n.addSinglePreview(e).then(function(e){a.go("dashboard_plan_single_preview")},function(e){return console.log("err @addSinglePreview: ",e)})}),"dashboard_plan_single_preview"==r.currentState){var l=function(){for(var e=[],o="0123456789abcdef",t=0;36>t;t++)e[t]=o.substr(Math.floor(16*Math.random()),1);e[14]="4",e[19]=o.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-";var a=e.join("");return a};n.getSinglePreview().then(function(o){console.log("res @getSinglePreview: ",o),e.planPreview=o,e.planPreview.installment=(o.total-o.downpay)/o.times},function(e){return console.log("err @getSinglePreview: ",e)});var s=l();console.log("uuid: ",s)}}function focusOn(){return function(e,o,t){e.$on("focusOn",function(e,a){a===t.focusOn&&o[0].focus()})}}function toolTip(){return function(e,o,t){angular.element(".tool-tip").on("click mouseleave",hideTooltip),angular.element(".tool-tip").on("mouseenter",showTooltip)}}function hideTooltip(){$(this).tooltip("hide")}function showTooltip(){$(this).tooltip("show")}angular.module("pinchApp",["ui.router","satellizer","ngAnimate","ngFileUpload","ngImgCrop","stripe.checkout","angular-loading-bar","anim-in-out"]).config(["$stateProvider","$urlRouterProvider","$authProvider",function(e,o,t){Stripe.setPublishableKey("pk_test_t1eThhOKl6esrp6f4jyWqU4J"),e.state(home).state(authEntrance).state(dashboard).state(dashboard_payment).state(dashboard_plan).state(dashboard_plan_start).state(dashboard_plan_choose).state(dashboard_plan_single).state(dashboard_plan_single_preview).state(dashboard_plan_multiple).state(dashboard_account),o.otherwise("/")}]);var home={name:"home",url:"/",views:{main:{templateUrl:"/html/home.html",controller:"homeCtrl"}}},authEntrance={name:"authEntrance",url:"/entrance",views:{main:{templateUrl:"/html/entrance.html",controller:"authCtrl"}}},dashboard={name:"dashboard",url:"/dashboard",views:{main:{templateUrl:"/html/dashboard.html",controller:"dashboardCtrl"}}},dashboard_payment={name:"dashboard_payment",url:"/payment",parent:"dashboard",views:{dashboard_section:{templateUrl:"/html/dashboard_payment.html",controller:"dashboardCtrl"}}},dashboard_plan={name:"dashboard_plan",url:"/plan",parent:"dashboard",views:{dashboard_section:{templateUrl:"/html/dashboard_plan.html",controller:"dashboardCtrl"}}},dashboard_plan_start={name:"dashboard_plan_start",url:"/start",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_start.html",controller:"dashboardCtrl"}}},dashboard_plan_choose={name:"dashboard_plan_choose",url:"/choose",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_choose.html",controller:"dashboardCtrl"}}},dashboard_plan_single={name:"dashboard_plan_single",url:"/choose/single",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_single.html",controller:"dashboardPlanCtrl"}}},dashboard_plan_single_preview={name:"dashboard_plan_single_preview",url:"/choose/single/preview",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_single_preview.html",controller:"dashboardPlanCtrl"}}},dashboard_plan_multiple={name:"dashboard_plan_multiple",url:"/choose/mutiple",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_multiple.html",controller:"dashboardCtrl"}}},dashboard_account={name:"dashboard_account",url:"/account",parent:"dashboard",views:{dashboard_section:{templateUrl:"/html/dashboard_account.html",controller:"dashboardCtrl"}}};$(document).ready(init),Account.$inject=["$http"],Payment.$inject=["$http"],focus.$inject=["$rootScope","$timeout"],Plan.$inject=["$q"],angular.module("pinchApp").service("Account",Account).service("Payment",Payment).factory("focus",focus).service("Plan",Plan),homeCtrl.$inject=["$rootScope"],authCtrl.$inject=["$scope","$auth","$state","Account","$window"],dashboardCtrl.$inject=["$scope","$auth","$state","Account","$rootScope","Payment","$interval"],dashboardPlanCtrl.$inject=["$scope","Account","$stateParams","$state","Plan","$rootScope"],angular.module("pinchApp").controller("homeCtrl",homeCtrl).controller("authCtrl",authCtrl).controller("dashboardCtrl",dashboardCtrl).controller("dashboardPlanCtrl",dashboardPlanCtrl),angular.module("pinchApp").directive("focusOn",focusOn),angular.module("pinchApp").directive("toolTip",toolTip);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFtb2R1bGUuanMiLCJtYWluLmpzIiwic2VydmljZXMuanMiLCJjb250cm9sbGVycy9jb250cm9sbGVycy5qcyIsImRpcmVjdGl2ZXMvZm9jdXNPbi5kaXJlY3RpdmUuanMiLCJkaXJlY3RpdmVzL3Rvb2xUaXAuZGlyZWN0aXZlLmpzIl0sIm5hbWVzIjpbImluaXQiLCJjb25zb2xlIiwibG9nIiwic3RpY2t5Iiwid2luZG93U2Nyb2xsRG93biIsIiQiLCJ0b3BTcGFjaW5nIiwic3QiLCJsYXN0U2Nyb2xsVG9wIiwid2luZG93Iiwic2Nyb2xsIiwidGhpcyIsInNjcm9sbFRvcCIsInJlbW92ZUNsYXNzIiwiY3NzIiwiYWRkQ2xhc3MiLCJBY2NvdW50IiwiJGh0dHAiLCJnZXRDdXJyZW50VXNlciIsIm1ldGhvZCIsInVybCIsInNlbmRWZXJpZnlDb2RlIiwidXNlck9iaiIsImRhdGEiLCJ2ZXJpZnlDb2RlIiwiZ2V0VXNlckRhdGEiLCJ1cmlVc2VySWQiLCJ1cGRhdGVVc2VyRGF0YSIsIlBheW1lbnQiLCJjaGFyZ2VOb3ciLCJkYXRhT2JqIiwiZm9jdXMiLCIkcm9vdFNjb3BlIiwiJHRpbWVvdXQiLCJuYW1lIiwiJGJyb2FkY2FzdCIsIlBsYW4iLCIkcSIsImFkZFNpbmdsZVByZXZpZXciLCJwbGFuIiwibG9jYWxTdG9yYWdlIiwicGxhblByZXZpZXdEYXRhIiwicmVzIiwicmVqIiwiSlNPTiIsInN0cmluZ2lmeSIsImdldFNpbmdsZVByZXZpZXciLCJwYXJzZSIsImhvbWVDdHJsIiwicHJldmlvdXNTdGF0ZSIsImN1cnJlbnRTdGF0ZSIsIiRvbiIsImV2IiwidG8iLCJ0b1BhcmFtcyIsImZyb20iLCJmcm9tUGFyYW1zIiwiJGV2ZW50IiwiZWxlbWVudCIsInNwZWVkIiwiYXV0aEN0cmwiLCIkc2NvcGUiLCIkYXV0aCIsIiRzdGF0ZSIsIiR3aW5kb3ciLCJnZXRUb2tlbiIsInRoZW4iLCJjdXJyZW50VXNlciIsImVyciIsImdvIiwiYXV0aF9lbnRlciIsImF1dGhEYXRhIiwic2lnbnVwIiwic2V0VG9rZW4iLCJyZWxvYWQiLCJhdXRoZW50aWNhdGUiLCJwcm92aWRlciIsImxvZ291dCIsImxvY2F0aW9uIiwiZGFzaGJvYXJkQ3RybCIsIiRpbnRlcnZhbCIsImNoZWNrVmVyaWZ5UGhvbmVTZW50U3RhdHVzIiwiY3VycmVudFVzZXJEYXRhIiwidmVyaWZ5UGhvbmVTZW50T3V0IiwiZXhwaXJlZFRpbWUiLCJOdW1iZXIiLCJwaG9uZSIsImV4cGlyZWRBdCIsIm5vd1RpbWUiLCJEYXRlIiwibm93IiwidmVyaWZ5UGhvbmVDb3VudERvd24iLCJsZW5ndGgiLCJ1c2VyRGF0YSIsImNvZGUiLCJ2ZXJpZmllZCIsImRvQ2hlY2tvdXQiLCJ0b2tlbiIsInN0cmlwZVRva2VuIiwiZGFzaGJvYXJkUGxhbkN0cmwiLCIkc3RhdGVQYXJhbXMiLCJ1cGRhdGVUaW1lcyIsInRpbWVzIiwiaW5zdGFsbG1lbnRzR3JhcGhEYXRhIiwiaSIsImluc3RhbGxtZW50IiwidG90YWwiLCJoZWlnaHQiLCJwdXNoIiwicHJpY2UiLCJzdHlsZSIsIndpZHRoIiwicHJldmlld1NpbmdsZVBsYW4iLCJjcmVhdGVVVUlEIiwicyIsImhleERpZ2l0cyIsInN1YnN0ciIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInV1aWQiLCJqb2luIiwicGxhblByZXZpZXciLCJkb3ducGF5IiwiZm9jdXNPbiIsInNjb3BlIiwiZWxlbSIsImF0dHIiLCJlIiwidG9vbFRpcCIsImF0dHJzIiwiYW5ndWxhciIsIm9uIiwiaGlkZVRvb2x0aXAiLCJzaG93VG9vbHRpcCIsInRvb2x0aXAiLCJtb2R1bGUiLCJjb25maWciLCIkc3RhdGVQcm92aWRlciIsIiR1cmxSb3V0ZXJQcm92aWRlciIsIiRhdXRoUHJvdmlkZXIiLCJTdHJpcGUiLCJzZXRQdWJsaXNoYWJsZUtleSIsInN0YXRlIiwiaG9tZSIsImF1dGhFbnRyYW5jZSIsImRhc2hib2FyZCIsImRhc2hib2FyZF9wYXltZW50IiwiZGFzaGJvYXJkX3BsYW4iLCJkYXNoYm9hcmRfcGxhbl9zdGFydCIsImRhc2hib2FyZF9wbGFuX2Nob29zZSIsImRhc2hib2FyZF9wbGFuX3NpbmdsZSIsImRhc2hib2FyZF9wbGFuX3NpbmdsZV9wcmV2aWV3IiwiZGFzaGJvYXJkX3BsYW5fbXVsdGlwbGUiLCJkYXNoYm9hcmRfYWNjb3VudCIsIm90aGVyd2lzZSIsInZpZXdzIiwibWFpbiIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsInBhcmVudCIsImRhc2hib2FyZF9zZWN0aW9uIiwiZGFzaGJvYXJkX2NoaWxkX3NlY3Rpb24iLCJkb2N1bWVudCIsInJlYWR5IiwiJGluamVjdCIsInNlcnZpY2UiLCJmYWN0b3J5IiwiZGlyZWN0aXZlIl0sIm1hcHBpbmdzIjoiQUFBQSxZQ0lBLFNBQVNBLFFBQ0xDLFFBQVFDLElBQUksaUJBQ1pDLFNBQ0FDLG1CQUdKLFFBQVNELFVBQ0xFLEVBQUUsV0FBV0YsUUFDVEcsV0FBWSxLQUlwQixRQUFTRixvQkFDTCxHQUNJRyxHQURBQyxFQUFnQixDQUVwQkgsR0FBRUksUUFBUUMsT0FBTyxXQUViSCxFQUFLRixFQUFFTSxNQUFNQyxZQUNWUCxFQUFFSSxRQUFRRyxZQUFjLEtBQ2RKLEVBQUxELEdBQ0FGLEVBQUUsa0JBQWtCUSxZQUFZLFVBQ2hDUixFQUFFLGtCQUFrQlMsSUFBSSxnQkFBaUIsY0FFekNULEVBQUUsa0JBQWtCVSxTQUFTLFdBR3JDUCxFQUFnQkQsRUFFWkYsRUFBRUksUUFBUUcsWUFBYyxJQUN4QlAsRUFBRSxrQkFBa0JVLFNBQVMsT0FFN0JWLEVBQUVJLFFBQVFHLFlBQWMsSUFDeEJQLEVBQUUsa0JBQWtCUSxZQUFZLE9BRWhDUixFQUFFSSxRQUFRRyxZQUFjLEdBR3hCUCxFQUFFSSxRQUFRRyxZQUFjLEtBQ3hCUCxFQUFFLGtCQUFrQlMsSUFBSSxhQUFjLHNDQUV0Q1QsRUFBRUksUUFBUUcsWUFBYyxLQUN4QlAsRUFBRSxrQkFBa0JTLElBQUksYUFBYywwQ0NwQ2xELFFBQVNFLFNBQVFDLEdBQ2JOLEtBQUtPLGVBQWlCLFdBS2xC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QUFXLFNBQ25CekksUUFBUXlJLFNBQVcsU0FDbkJ0SSxNQUFNc0ksU0FBVyxhQUFjLFlBQy9CakksS0FBS2lJLFNBQVcsTUFIaEJsQyxRQUNLSyxPQUFPLFlBQ1A4QixRQUFRLFVBQVd0SixTQUNuQnNKLFFBQVEsVUFBVzFJLFNBQ25CMkksUUFBUSxRQUFTeEksT0FDakJ1SSxRQUFRLE9BQVFsSSxNQ0xyQlksU0FBU3FILFNBQVcsY0FDcEJ6RyxTQUFTeUcsU0FBVyxTQUFVLFFBQVMsU0FBVSxVQUFXLFdBQzVEdEYsY0FBY3NGLFNBQVcsU0FBVSxRQUFTLFNBQVUsVUFBVyxhQUFjLFVBQVcsYUFDMUZsRSxrQkFBa0JrRSxTQUFXLFNBQVUsVUFBVyxlQUFnQixTQUFVLE9BQVEsY0FIcEZsQyxRQUNLSyxPQUFPLFlBQ1B1QixXQUFXLFdBQVkvRyxVQUN2QitHLFdBQVcsV0FBWW5HLFVBQ3ZCbUcsV0FBVyxnQkFBaUJoRixlQUM1QmdGLFdBQVcsb0JBQXFCNUQsbUJDTHJDZ0MsUUFDS0ssT0FBTyxZQUNQZ0MsVUFBVSxVQUFXNUMsU0NGMUJPLFFBQ0tLLE9BQU8sWUFDUGdDLFVBQVUsVUFBV3ZDIiwiZmlsZSI6ImJ1bmRsZS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdwaW5jaEFwcCcsIFtcbiAgICAgICAgJ3VpLnJvdXRlcicsXG4gICAgICAgICdzYXRlbGxpemVyJyxcbiAgICAgICAgJ25nQW5pbWF0ZScsXG4gICAgICAgIC8vICd1aS5ib290c3RyYXAnLFxuICAgICAgICAnbmdGaWxlVXBsb2FkJyxcbiAgICAgICAgJ25nSW1nQ3JvcCcsXG4gICAgICAgICdzdHJpcGUuY2hlY2tvdXQnLFxuICAgICAgICAnYW5ndWxhci1sb2FkaW5nLWJhcicsXG4gICAgICAgICdhbmltLWluLW91dCdcbiAgICBdKVxuICAgIC5jb25maWcoZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlciwgJGF1dGhQcm92aWRlcikge1xuICAgICAgICBTdHJpcGUuc2V0UHVibGlzaGFibGVLZXkoJ3BrX3Rlc3RfdDFlVGhoT0tsNmVzcnA2ZjRqeVdxVTRKJylcblxuICAgICAgICAvLyAkYXV0aFByb3ZpZGVyXG4gICAgICAgIC8vICAgICAuZmFjZWJvb2soe1xuICAgICAgICAvLyAgICAgICAgIGNsaWVudElkOiAnMjk4MTY1MTEzODQ5MzY2J1xuICAgICAgICAvLyAgICAgfSk7XG5cbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZShob21lKVxuICAgICAgICAgICAgLnN0YXRlKGF1dGhFbnRyYW5jZSlcbiAgICAgICAgICAgIC5zdGF0ZShkYXNoYm9hcmQpXG4gICAgICAgICAgICAuc3RhdGUoZGFzaGJvYXJkX3BheW1lbnQpXG4gICAgICAgICAgICAuc3RhdGUoZGFzaGJvYXJkX3BsYW4pXG4gICAgICAgICAgICAuc3RhdGUoZGFzaGJvYXJkX3BsYW5fc3RhcnQpXG4gICAgICAgICAgICAuc3RhdGUoZGFzaGJvYXJkX3BsYW5fY2hvb3NlKVxuICAgICAgICAgICAgLnN0YXRlKGRhc2hib2FyZF9wbGFuX3NpbmdsZSlcbiAgICAgICAgICAgIC5zdGF0ZShkYXNoYm9hcmRfcGxhbl9zaW5nbGVfcHJldmlldylcbiAgICAgICAgICAgIC5zdGF0ZShkYXNoYm9hcmRfcGxhbl9tdWx0aXBsZSlcbiAgICAgICAgICAgIC5zdGF0ZShkYXNoYm9hcmRfYWNjb3VudClcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcGFnZSlcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcGFnZV9wcm9qZWN0cylcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcGFnZV9saWtlZClcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcGFnZV9mb2xsb3dlcnMpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHJvamVjdHBhZ2UpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHJvamVjdFNldHRpbmcpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHJvamVjdFNldHRpbmdfZ2VuZXJhbClcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcm9qZWN0U2V0dGluZ19yZXF1ZXN0KVxuICAgICAgICAgICAgLy8gLnN0YXRlKHByb2plY3RTZXR0aW5nX3ByaXZhY3kpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHJvamVjdFNldHRpbmdfZGFuZ2VyKVxuICAgICAgICAgICAgLy8gLnN0YXRlKHByb2ZpbGVTZXR0aW5nKVxuICAgICAgICAgICAgLy8gLnN0YXRlKHByb2ZpbGVTZXR0aW5nX2dlbmVyYWwpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHJvZmlsZVNldHRpbmdfcmVxdWVzdClcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcm9maWxlU2V0dGluZ19wcml2YWN5KVxuICAgICAgICAgICAgLy8gLnN0YXRlKHByb2ZpbGVTZXR0aW5nX2RhbmdlcilcblxuXG4gICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcbiAgICB9KTtcblxuXG5sZXQgaG9tZSA9IHtcbiAgICBuYW1lOiAnaG9tZScsXG4gICAgdXJsOiAnLycsXG4gICAgdmlld3M6IHtcbiAgICAgICAgbWFpbjoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9ob21lLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2hvbWVDdHJsJ1xuICAgICAgICB9XG4gICAgfVxufVxubGV0IGF1dGhFbnRyYW5jZSA9IHtcbiAgICBuYW1lOiAnYXV0aEVudHJhbmNlJyxcbiAgICB1cmw6ICcvZW50cmFuY2UnLFxuICAgIHZpZXdzOiB7XG4gICAgICAgIG1haW46IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvZW50cmFuY2UuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnYXV0aEN0cmwnXG4gICAgICAgIH1cbiAgICB9XG59XG5sZXQgZGFzaGJvYXJkID0ge1xuICAgIG5hbWU6ICdkYXNoYm9hcmQnLFxuICAgIHVybDogJy9kYXNoYm9hcmQnLFxuICAgIHZpZXdzOiB7XG4gICAgICAgIG1haW46IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvZGFzaGJvYXJkLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2Rhc2hib2FyZEN0cmwnXG4gICAgICAgIH1cbiAgICB9XG59XG5cbmxldCBkYXNoYm9hcmRfcGF5bWVudCA9IHtcbiAgICBuYW1lOiAnZGFzaGJvYXJkX3BheW1lbnQnLFxuICAgIHVybDogJy9wYXltZW50JyxcbiAgICBwYXJlbnQ6ICdkYXNoYm9hcmQnLFxuICAgIHZpZXdzOiB7XG4gICAgICAgIGRhc2hib2FyZF9zZWN0aW9uOiB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL2Rhc2hib2FyZF9wYXltZW50Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2Rhc2hib2FyZEN0cmwnXG4gICAgICAgIH1cbiAgICB9XG59XG5sZXQgZGFzaGJvYXJkX3BsYW4gPSB7XG4gICAgbmFtZTogJ2Rhc2hib2FyZF9wbGFuJyxcbiAgICB1cmw6ICcvcGxhbicsXG4gICAgcGFyZW50OiAnZGFzaGJvYXJkJyxcbiAgICB2aWV3czoge1xuICAgICAgICBkYXNoYm9hcmRfc2VjdGlvbjoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9kYXNoYm9hcmRfcGxhbi5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdkYXNoYm9hcmRDdHJsJ1xuICAgICAgICB9XG4gICAgfVxufVxubGV0IGRhc2hib2FyZF9wbGFuX3N0YXJ0ID0ge1xuICAgIG5hbWU6ICdkYXNoYm9hcmRfcGxhbl9zdGFydCcsXG4gICAgdXJsOiAnL3N0YXJ0JyxcbiAgICBwYXJlbnQ6ICdkYXNoYm9hcmRfcGxhbicsXG4gICAgdmlld3M6IHtcbiAgICAgICAgZGFzaGJvYXJkX2NoaWxkX3NlY3Rpb246IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvZGFzaGJvYXJkL2Rhc2hib2FyZF9wbGFuX3N0YXJ0Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2Rhc2hib2FyZEN0cmwnXG4gICAgICAgIH1cbiAgICB9XG59XG5sZXQgZGFzaGJvYXJkX3BsYW5fY2hvb3NlID0ge1xuICAgIG5hbWU6ICdkYXNoYm9hcmRfcGxhbl9jaG9vc2UnLFxuICAgIHVybDogJy9jaG9vc2UnLFxuICAgIHBhcmVudDogJ2Rhc2hib2FyZF9wbGFuJyxcbiAgICB2aWV3czoge1xuICAgICAgICBkYXNoYm9hcmRfY2hpbGRfc2VjdGlvbjoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9kYXNoYm9hcmQvZGFzaGJvYXJkX3BsYW5fY2hvb3NlLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2Rhc2hib2FyZEN0cmwnXG4gICAgICAgIH1cbiAgICB9XG59XG5sZXQgZGFzaGJvYXJkX3BsYW5fc2luZ2xlID0ge1xuICAgIG5hbWU6ICdkYXNoYm9hcmRfcGxhbl9zaW5nbGUnLFxuICAgIHVybDogJy9jaG9vc2Uvc2luZ2xlJyxcbiAgICBwYXJlbnQ6ICdkYXNoYm9hcmRfcGxhbicsXG4gICAgdmlld3M6IHtcbiAgICAgICAgZGFzaGJvYXJkX2NoaWxkX3NlY3Rpb246IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvZGFzaGJvYXJkL2Rhc2hib2FyZF9wbGFuX3NpbmdsZS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdkYXNoYm9hcmRQbGFuQ3RybCdcbiAgICAgICAgfVxuICAgIH1cbn1cbmxldCBkYXNoYm9hcmRfcGxhbl9zaW5nbGVfcHJldmlldyA9IHtcbiAgICBuYW1lOiAnZGFzaGJvYXJkX3BsYW5fc2luZ2xlX3ByZXZpZXcnLFxuICAgIHVybDogJy9jaG9vc2Uvc2luZ2xlL3ByZXZpZXcnLFxuICAgIHBhcmVudDogJ2Rhc2hib2FyZF9wbGFuJyxcbiAgICB2aWV3czoge1xuICAgICAgICBkYXNoYm9hcmRfY2hpbGRfc2VjdGlvbjoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9kYXNoYm9hcmQvZGFzaGJvYXJkX3BsYW5fc2luZ2xlX3ByZXZpZXcuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnZGFzaGJvYXJkUGxhbkN0cmwnXG4gICAgICAgIH1cbiAgICB9XG59XG5sZXQgZGFzaGJvYXJkX3BsYW5fbXVsdGlwbGUgPSB7XG4gICAgbmFtZTogJ2Rhc2hib2FyZF9wbGFuX211bHRpcGxlJyxcbiAgICB1cmw6ICcvY2hvb3NlL211dGlwbGUnLFxuICAgIHBhcmVudDogJ2Rhc2hib2FyZF9wbGFuJyxcbiAgICB2aWV3czoge1xuICAgICAgICBkYXNoYm9hcmRfY2hpbGRfc2VjdGlvbjoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9kYXNoYm9hcmQvZGFzaGJvYXJkX3BsYW5fbXVsdGlwbGUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnZGFzaGJvYXJkQ3RybCdcbiAgICAgICAgfVxuICAgIH1cbn1cbmxldCBkYXNoYm9hcmRfYWNjb3VudCA9IHtcbiAgICBuYW1lOiAnZGFzaGJvYXJkX2FjY291bnQnLFxuICAgIHVybDogJy9hY2NvdW50JyxcbiAgICBwYXJlbnQ6ICdkYXNoYm9hcmQnLFxuICAgIHZpZXdzOiB7XG4gICAgICAgIGRhc2hib2FyZF9zZWN0aW9uOiB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL2Rhc2hib2FyZF9hY2NvdW50Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2Rhc2hib2FyZEN0cmwnXG4gICAgICAgIH1cbiAgICB9XG59XG4iLCIndXNlIHN0cmljdCdcblxuJChkb2N1bWVudCkucmVhZHkoaW5pdCk7XG5cbmZ1bmN0aW9uIGluaXQoKSB7XG4gICAgY29uc29sZS5sb2coJ2pxdWVyeSBsb2FkZWQnKTtcbiAgICBzdGlja3koKVxuICAgIHdpbmRvd1Njcm9sbERvd24oKVxufVxuXG5mdW5jdGlvbiBzdGlja3koKSB7XG4gICAgJChcIi5zdGlja3lcIikuc3RpY2t5KHtcbiAgICAgICAgdG9wU3BhY2luZzogNjBcbiAgICB9KVxufVxuXG5mdW5jdGlvbiB3aW5kb3dTY3JvbGxEb3duKCkge1xuICAgIHZhciBsYXN0U2Nyb2xsVG9wID0gMFxuICAgIHZhciBzdFxuICAgICQod2luZG93KS5zY3JvbGwoZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCQod2luZG93KS5zY3JvbGxUb3AoKSk7XG4gICAgICAgIHN0ID0gJCh0aGlzKS5zY3JvbGxUb3AoKTtcbiAgICAgICAgaWYoJCh3aW5kb3cpLnNjcm9sbFRvcCgpID4gMzApe1xuICAgICAgICAgICAgaWYgKHN0IDwgbGFzdFNjcm9sbFRvcCkge1xuICAgICAgICAgICAgICAgICQoJy5ob21lLXBhZ2UgbmF2JykucmVtb3ZlQ2xhc3MoJ2ZvbGRlZCcpXG4gICAgICAgICAgICAgICAgJCgnLmhvbWUtcGFnZSBuYXYnKS5jc3MoJ2JvcmRlci1ib3R0b20nLCAnMHB4IHNvbGlkJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICQoJy5ob21lLXBhZ2UgbmF2JykuYWRkQ2xhc3MoJ2ZvbGRlZCcpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbGFzdFNjcm9sbFRvcCA9IHN0XG5cbiAgICAgICAgaWYgKCQod2luZG93KS5zY3JvbGxUb3AoKSA8IDEwKSB7XG4gICAgICAgICAgICAkKCcuaG9tZS1wYWdlIG5hdicpLmFkZENsYXNzKCd0b3AnKVxuICAgICAgICB9XG4gICAgICAgIGlmICgkKHdpbmRvdykuc2Nyb2xsVG9wKCkgPiAxMCkge1xuICAgICAgICAgICAgJCgnLmhvbWUtcGFnZSBuYXYnKS5yZW1vdmVDbGFzcygndG9wJylcbiAgICAgICAgfVxuICAgICAgICBpZiAoJCh3aW5kb3cpLnNjcm9sbFRvcCgpID4gMzApIHtcblxuICAgICAgICB9XG4gICAgICAgIGlmICgkKHdpbmRvdykuc2Nyb2xsVG9wKCkgPCA1NDApIHtcbiAgICAgICAgICAgICQoJy5ob21lLXBhZ2UgbmF2JykuY3NzKCdib3gtc2hhZG93JywgJ2luc2V0IDAgLTFweCAwcHggMHB4IHJnYmEoMCwwLDAsMCknKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoJCh3aW5kb3cpLnNjcm9sbFRvcCgpID4gNTQwKSB7XG4gICAgICAgICAgICAkKCcuaG9tZS1wYWdlIG5hdicpLmNzcygnYm94LXNoYWRvdycsICdpbnNldCAwIC0xcHggMHB4IDBweCByZ2JhKDAsMCwwLDAuMSknKTtcbiAgICAgICAgfVxuXG4gICAgfSlcbn1cbiIsIid1c2Ugc3RyaWN0JztcblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ3BpbmNoQXBwJylcbiAgICAuc2VydmljZSgnQWNjb3VudCcsIEFjY291bnQpXG4gICAgLnNlcnZpY2UoJ1BheW1lbnQnLCBQYXltZW50KVxuICAgIC5mYWN0b3J5KCdmb2N1cycsIGZvY3VzKVxuICAgIC5zZXJ2aWNlKCdQbGFuJywgUGxhbilcbiAgICAvLyAuZGlyZWN0aXZlKCdzdGF0ZUxvYWRpbmdJbmRpY2F0b3InLCBzdGF0ZUxvYWRpbmdJbmRpY2F0b3IpXG5mdW5jdGlvbiBBY2NvdW50KCRodHRwKSB7XG4gICAgdGhpcy5nZXRDdXJyZW50VXNlciA9ICgpID0+IHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICB1cmw6IGAvYXBpL2F1dGgvY3VycmVudFVzZXJgXG4gICAgICAgIH0pXG4gICAgfVxuICAgIHRoaXMuc2VuZFZlcmlmeUNvZGUgPSAodXNlck9iaikgPT4ge1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICB1cmw6IGAvYXBpL3ZlcmlmeS9waG9uZWAsXG4gICAgICAgICAgICBkYXRhOiB1c2VyT2JqXG4gICAgICAgIH0pXG4gICAgfVxuICAgIHRoaXMudmVyaWZ5Q29kZSA9ICh1c2VyT2JqKSA9PiB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdQVVQnLFxuICAgICAgICAgICAgdXJsOiBgL2FwaS92ZXJpZnkvcGhvbmVgLFxuICAgICAgICAgICAgZGF0YTogdXNlck9ialxuICAgICAgICB9KVxuICAgIH1cbiAgICB0aGlzLmdldFVzZXJEYXRhID0gKHVyaVVzZXJJZCkgPT4ge1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgIHVybDogYC9hcGkvdXNlcnMvJHt1cmlVc2VySWR9YFxuICAgICAgICB9KVxuICAgIH1cbiAgICB0aGlzLnVwZGF0ZVVzZXJEYXRhID0gKHVyaVVzZXJJZCwgdXBkYXRlVXNlckRhdGEpID0+IHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BVVCcsXG4gICAgICAgICAgICB1cmw6IGAvYXBpL3VzZXJzLyR7dXJpVXNlcklkfWAsXG4gICAgICAgICAgICBkYXRhOiB1cGRhdGVVc2VyRGF0YVxuICAgICAgICB9KVxuICAgIH1cbn1cblxuZnVuY3Rpb24gUGF5bWVudCgkaHR0cCkge1xuICAgIHRoaXMuY2hhcmdlTm93ID0gKGRhdGFPYmopID0+IHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgdXJsOiBgL2FwaS9wYXltZW50L2NoYXJnZU5vd2AsXG4gICAgICAgICAgICBkYXRhOiBkYXRhT2JqXG4gICAgICAgIH0pXG4gICAgfVxufVxuXG5mdW5jdGlvbiBmb2N1cygkcm9vdFNjb3BlLCAkdGltZW91dCkge1xuICAgIHJldHVybiBmdW5jdGlvbihuYW1lKSB7XG4gICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdmb2N1c09uJywgbmFtZSk7XG4gICAgICAgIH0sIDApO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gUGxhbigkcSkge1xuICAgIHRoaXMuYWRkU2luZ2xlUHJldmlldyA9IChwbGFuKSA9PiB7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5wbGFuUHJldmlld0RhdGEgPSAnJztcbiAgICAgICAgcmV0dXJuICRxKChyZXMsIHJlaikgPT4ge1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnBsYW5QcmV2aWV3RGF0YSA9IEpTT04uc3RyaW5naWZ5KHBsYW4pXG4gICAgICAgICAgICByZXMobG9jYWxTdG9yYWdlLnBsYW5QcmV2aWV3RGF0YSlcbiAgICAgICAgfSlcbiAgICB9XG4gICAgdGhpcy5nZXRTaW5nbGVQcmV2aWV3ID0gKCkgPT4ge1xuICAgICAgICByZXR1cm4gJHEoKHJlcywgcmVqKSA9PiB7XG4gICAgICAgICAgICBpZihsb2NhbFN0b3JhZ2UucGxhblByZXZpZXdEYXRhKXtcbiAgICAgICAgICAgICAgICByZXMoSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UucGxhblByZXZpZXdEYXRhKSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG59XG4vLyBmdW5jdGlvbiBzdGF0ZUxvYWRpbmdJbmRpY2F0b3IoJHJvb3RTY29wZSkge1xuLy8gICAgIHJldHVybiB7XG4vLyAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4vLyAgICAgICAgIHRlbXBsYXRlOiBcIjxkaXYgbmctc2hvdz0naXNTdGF0ZUxvYWRpbmcnIGNsYXNzPSdsb2FkaW5nLWluZGljYXRvcic+XCIgK1xuLy8gICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPSdsb2FkaW5nLWluZGljYXRvci1ib2R5Jz5cIiArXG4vLyAgICAgICAgICAgICBcIjxoMyBjbGFzcz0nbG9hZGluZy10aXRsZSc+TG9hZGluZy4uLjwvaDM+XCIgK1xuLy8gICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPSdzcGlubmVyJz48Y2hhc2luZy1kb3RzLXNwaW5uZXI+PC9jaGFzaW5nLWRvdHMtc3Bpbm5lcj48L2Rpdj5cIiArXG4vLyAgICAgICAgICAgICBcIjwvZGl2PlwiICtcbi8vICAgICAgICAgICAgIFwiPC9kaXY+XCIsXG4vLyAgICAgICAgIHJlcGxhY2U6IHRydWUsXG4vLyAgICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtLCBhdHRycykge1xuLy8gICAgICAgICAgICAgc2NvcGUuaXNTdGF0ZUxvYWRpbmcgPSBmYWxzZTtcbi8vXG4vLyAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3RhcnQnLCBmdW5jdGlvbigpIHtcbi8vICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnc3RhcnQnKVxuLy8gICAgICAgICAgICAgICAgIHNjb3BlLmlzU3RhdGVMb2FkaW5nID0gdHJ1ZTtcbi8vICAgICAgICAgICAgIH0pO1xuLy8gICAgICAgICAgICAgJHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZVN1Y2Nlc3MnLCBmdW5jdGlvbigpIHtcbi8vICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnY29tcGxldGUnKVxuLy8gICAgICAgICAgICAgICAgIHNjb3BlLmlzU3RhdGVMb2FkaW5nID0gZmFsc2U7XG4vLyAgICAgICAgICAgICB9KTtcbi8vICAgICAgICAgfVxuLy8gICAgIH07XG4vLyB9XG4iLCIndXNlIHN0cmljdCc7XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdwaW5jaEFwcCcpXG4gICAgLmNvbnRyb2xsZXIoJ2hvbWVDdHJsJywgaG9tZUN0cmwpXG4gICAgLmNvbnRyb2xsZXIoJ2F1dGhDdHJsJywgYXV0aEN0cmwpXG4gICAgLmNvbnRyb2xsZXIoJ2Rhc2hib2FyZEN0cmwnLCBkYXNoYm9hcmRDdHJsKVxuICAgIC5jb250cm9sbGVyKCdkYXNoYm9hcmRQbGFuQ3RybCcsIGRhc2hib2FyZFBsYW5DdHJsKVxuXG5mdW5jdGlvbiBob21lQ3RybCgkcm9vdFNjb3BlKSB7XG4gICAgY29uc29sZS5sb2coJ2hvbWVDdHJsIGxvYWRlZCcpXG4gICAgJHJvb3RTY29wZS5wcmV2aW91c1N0YXRlXG4gICAgJHJvb3RTY29wZS5jdXJyZW50U3RhdGVcbiAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3VjY2VzcycsIGZ1bmN0aW9uKGV2LCB0bywgdG9QYXJhbXMsIGZyb20sIGZyb21QYXJhbXMpIHtcbiAgICAgICAgJHJvb3RTY29wZS5wcmV2aW91c1N0YXRlID0gZnJvbS5uYW1lO1xuICAgICAgICAkcm9vdFNjb3BlLmN1cnJlbnRTdGF0ZSA9IHRvLm5hbWU7XG4gICAgICAgIGNvbnNvbGUubG9nKCdQcmV2aW91cyBzdGF0ZTonICsgJHJvb3RTY29wZS5wcmV2aW91c1N0YXRlKVxuICAgICAgICBjb25zb2xlLmxvZygnQ3VycmVudCBzdGF0ZTonICsgJHJvb3RTY29wZS5jdXJyZW50U3RhdGUpXG4gICAgfSlcbiAgICAkcm9vdFNjb3BlLiRvbignYW5pbVN0YXJ0JywgZnVuY3Rpb24oJGV2ZW50LCBlbGVtZW50LCBzcGVlZCkge30pXG4gICAgJHJvb3RTY29wZS4kb24oJ2FuaW1FbmQnLCBmdW5jdGlvbigkZXZlbnQsIGVsZW1lbnQsIHNwZWVkKSB7fSlcbn1cblxuZnVuY3Rpb24gYXV0aEN0cmwoJHNjb3BlLCAkYXV0aCwgJHN0YXRlLCBBY2NvdW50LCAkd2luZG93KSB7XG4gICAgY29uc29sZS5sb2coJ2F1dGhDdHJsIGxvYWRlZCcpXG5cbiAgICAkc2NvcGUuZ2V0Q3VycmVudFVzZXIgPSAoKSA9PiB7XG4gICAgICAgIGdldEN1cnJlbnRVc2VyKClcbiAgICB9XG5cbiAgICAkc2NvcGUuYXV0aF9lbnRlciA9IChhdXRoRGF0YSkgPT4ge1xuICAgICAgICAkYXV0aC5zaWdudXAoYXV0aERhdGEpXG4gICAgICAgICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICAgICAgICAgICRhdXRoLnNldFRva2VuKHJlcylcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2Rhc2hib2FyZCcsIHt9LCB7XG4gICAgICAgICAgICAgICAgICAgIHJlbG9hZDogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlcyBAYXV0aF9lbnRlcjogJywgcmVzLmRhdGEpXG4gICAgICAgICAgICAgICAgZ2V0Q3VycmVudFVzZXIoKVxuICAgICAgICAgICAgICAgICAgICAvLyB0b2FzdHIuaW5mbygnWW91IGhhdmUgc3VjY2Vzc2Z1bGx5IGNyZWF0ZWQgYSBuZXcgYWNjb3VudCBhbmQgaGF2ZSBiZWVuIHNpZ25lZC1pbicpO1xuICAgICAgICAgICAgfSwgZXJyID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZXJyIEBhdXRoX2VudGVyOiAnLCBlcnIpXG4gICAgICAgICAgICAgICAgICAgIC8vIHRvYXN0ci5lcnJvcihyZXNwb25zZS5kYXRhLm1lc3NhZ2UpO1xuICAgICAgICAgICAgfSlcbiAgICB9XG5cbiAgICAkc2NvcGUuYXV0aGVudGljYXRlID0gKHByb3ZpZGVyKSA9PiB7XG4gICAgICAgICRhdXRoLmF1dGhlbnRpY2F0ZShwcm92aWRlcik7XG4gICAgfVxuICAgICRzY29wZS5sb2dvdXQgPSAoKSA9PiB7XG4gICAgICAgICRhdXRoLmxvZ291dCgpXG4gICAgICAgICRzY29wZS5jdXJyZW50VXNlciA9IG51bGw7XG4gICAgICAgICRzdGF0ZS5nbygnaG9tZScsIHt9LCB7XG4gICAgICAgICAgICByZWxvYWQ6IHRydWVcbiAgICAgICAgfSlcbiAgICAgICAgJHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRDdXJyZW50VXNlcigpIHtcbiAgICAgICAgaWYgKCRhdXRoLmdldFRva2VuKCkpIHtcbiAgICAgICAgICAgIEFjY291bnQuZ2V0Q3VycmVudFVzZXIoJGF1dGguZ2V0VG9rZW4oKSlcbiAgICAgICAgICAgICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncmVzIEBnZXRDdXJyZW50VXNlcjogJywgcmVzLmRhdGEpXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jdXJyZW50VXNlciA9IHJlcy5kYXRhXG4gICAgICAgICAgICAgICAgfSwgZXJyID0+IHtcbiAgICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdhdXRoRW50cmFuY2UnKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9XG5cbn1cblxuZnVuY3Rpb24gZGFzaGJvYXJkQ3RybCgkc2NvcGUsICRhdXRoLCAkc3RhdGUsIEFjY291bnQsICRyb290U2NvcGUsIFBheW1lbnQsICRpbnRlcnZhbCkge1xuICAgIGNvbnNvbGUubG9nKCdkYXNoYm9hcmRDdHJsIGxvYWRlZCcpXG4gICAgQWNjb3VudC5nZXRDdXJyZW50VXNlcigkYXV0aC5nZXRUb2tlbigpKVxuICAgICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICAgICAgaWYgKCEkcm9vdFNjb3BlLmN1cnJlbnRVc2VyKSB7XG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5jdXJyZW50VXNlciA9IHJlcy5kYXRhXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zb2xlLmxvZygncmVzIEBnZXRDdXJyZW50VXNlcjogJywgcmVzLmRhdGEpXG4gICAgICAgICAgICBjaGVja1ZlcmlmeVBob25lU2VudFN0YXR1cyhyZXMuZGF0YSlcbiAgICAgICAgfSwgZXJyID0+IHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnaG9tZScpXG4gICAgICAgIH0pXG5cbiAgICBmdW5jdGlvbiBjaGVja1ZlcmlmeVBob25lU2VudFN0YXR1cyhjdXJyZW50VXNlckRhdGEpIHtcbiAgICAgICAgJHNjb3BlLnZlcmlmeVBob25lU2VudE91dCA9IGZhbHNlXG5cbiAgICAgICAgbGV0IGV4cGlyZWRUaW1lID0gTnVtYmVyKGN1cnJlbnRVc2VyRGF0YS5waG9uZS52ZXJpZnlDb2RlLmV4cGlyZWRBdClcbiAgICAgICAgbGV0IG5vd1RpbWUgPSBEYXRlLm5vdygpXG4gICAgICAgIGlmIChleHBpcmVkVGltZSA+IG5vd1RpbWUpIHtcbiAgICAgICAgICAgICRzY29wZS52ZXJpZnlQaG9uZVNlbnRPdXQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgICRzY29wZS52ZXJpZnlQaG9uZUNvdW50RG93biA9ICgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBgJHtleHBpcmVkVGltZX1gXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAkc2NvcGUuc2VuZFZlcmlmeUNvZGUgPSAocGhvbmUpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ3Bob25lOiAnLCBwaG9uZSlcbiAgICAgICAgaWYgKHBob25lLmxlbmd0aCA+IDUpIHtcbiAgICAgICAgICAgIHZhciB1c2VyT2JqID0ge1xuICAgICAgICAgICAgICAgIHVzZXJEYXRhOiAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyLFxuICAgICAgICAgICAgICAgIHBob25lOiBwaG9uZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgQWNjb3VudC5zZW5kVmVyaWZ5Q29kZSh1c2VyT2JqKVxuICAgICAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXMgQHNlbmRWZXJpZnlDb2RlOiAnLCByZXMuZGF0YSlcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5jdXJyZW50VXNlci5waG9uZS5kYXRhID0gcGhvbmU7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS52ZXJpZnlQaG9uZVNlbnRPdXQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0sIGVyciA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnIgQHNlbmRWZXJpZnlDb2RlOiAnLCBlcnIpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9XG4gICAgJHNjb3BlLnZlcmlmeUNvZGUgPSAoY29kZSkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygnY29kZTogJywgY29kZSlcbiAgICAgICAgaWYgKGNvZGUubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICB2YXIgdXNlck9iaiA9IHtcbiAgICAgICAgICAgICAgICB1c2VyRGF0YTogJHJvb3RTY29wZS5jdXJyZW50VXNlcixcbiAgICAgICAgICAgICAgICBjb2RlOiBjb2RlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBBY2NvdW50LnZlcmlmeUNvZGUodXNlck9iailcbiAgICAgICAgICAgICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncmVzIEB2ZXJpZnlDb2RlOiAnLCByZXMuZGF0YSlcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5jdXJyZW50VXNlci5waG9uZS52ZXJpZmllZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfSwgZXJyID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2VyciBAdmVyaWZ5Q29kZTogJywgZXJyKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgJHNjb3BlLmRvQ2hlY2tvdXQgPSAodG9rZW4pID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ2ZmZicpO1xuICAgICAgICBjb25zb2xlLmxvZygndG9rZW46ICcsIHRva2VuKTtcbiAgICAgICAgdmFyIGRhdGFPYmogPSB7XG4gICAgICAgICAgICBzdHJpcGVUb2tlbjogdG9rZW4sXG4gICAgICAgICAgICB1c2VyRGF0YTogJHJvb3RTY29wZS5jdXJyZW50VXNlclxuICAgICAgICB9XG4gICAgICAgIFBheW1lbnQuY2hhcmdlTm93KGRhdGFPYmopLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXM6ICcsIHJlcy5kYXRhKTtcbiAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnZXJyOiAnLCBlcnIpO1xuICAgICAgICB9KVxuICAgIH1cbn1cblxuZnVuY3Rpb24gZGFzaGJvYXJkUGxhbkN0cmwoJHNjb3BlLCBBY2NvdW50LCAkc3RhdGVQYXJhbXMsICRzdGF0ZSwgUGxhbiwgJHJvb3RTY29wZSkge1xuICAgIGNvbnNvbGUubG9nKCdkYXNoYm9hcmRQbGFuQ3RybCBsb2FkZWQnKTtcblxuICAgIGlmICgkcm9vdFNjb3BlLmN1cnJlbnRTdGF0ZSA9PSAnZGFzaGJvYXJkX3BsYW5fc2luZ2xlJykge1xuICAgICAgICAkc2NvcGUudXBkYXRlVGltZXMgPSAodGltZXMpID0+IHtcbiAgICAgICAgICAgICRzY29wZS5pbnN0YWxsbWVudHNHcmFwaERhdGEgPSBbXVxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aW1lczsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGluc3RhbGxtZW50ID0gfn4oKCRzY29wZS5wbGFuLnRvdGFsIC8gdGltZXMpKTtcbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gfn4oMjAwICogKDIgLyB0aW1lcykpXG4gICAgICAgICAgICAgICAgJHNjb3BlLmluc3RhbGxtZW50c0dyYXBoRGF0YS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgcHJpY2U6IGluc3RhbGxtZW50LFxuICAgICAgICAgICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBgJHtoZWlnaHR9cHhgLFxuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IGA5MCVgXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgJHNjb3BlLnByZXZpZXdTaW5nbGVQbGFuID0gKHBsYW4pID0+IHtcbiAgICAgICAgICAgIFBsYW4uYWRkU2luZ2xlUHJldmlldyhwbGFuKS50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdkYXNoYm9hcmRfcGxhbl9zaW5nbGVfcHJldmlldycpXG4gICAgICAgICAgICB9LCBlcnIgPT4gY29uc29sZS5sb2coJ2VyciBAYWRkU2luZ2xlUHJldmlldzogJywgZXJyKSlcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmICgkcm9vdFNjb3BlLmN1cnJlbnRTdGF0ZSA9PSAnZGFzaGJvYXJkX3BsYW5fc2luZ2xlX3ByZXZpZXcnKSB7XG4gICAgICAgIFBsYW4uZ2V0U2luZ2xlUHJldmlldygpLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXMgQGdldFNpbmdsZVByZXZpZXc6ICcsIHJlcylcbiAgICAgICAgICAgICRzY29wZS5wbGFuUHJldmlldyA9IHJlcztcbiAgICAgICAgICAgICRzY29wZS5wbGFuUHJldmlldy5pbnN0YWxsbWVudCA9IChyZXMudG90YWwgLSByZXMuZG93bnBheSkgLyByZXMudGltZXNcbiAgICAgICAgfSwgZXJyID0+IGNvbnNvbGUubG9nKCdlcnIgQGdldFNpbmdsZVByZXZpZXc6ICcsIGVycikpXG5cbiAgICAgICAgdmFyIHV1aWQgPSBjcmVhdGVVVUlEKClcbiAgICAgICAgY29uc29sZS5sb2coJ3V1aWQ6ICcsIHV1aWQpXG5cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlVVVJRCgpIHtcbiAgICAgICAgICAgIHZhciBzID0gW107XG4gICAgICAgICAgICB2YXIgaGV4RGlnaXRzID0gXCIwMTIzNDU2Nzg5YWJjZGVmXCI7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDM2OyBpKyspIHtcbiAgICAgICAgICAgICAgICBzW2ldID0gaGV4RGlnaXRzLnN1YnN0cihNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAweDEwKSwgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzWzE0XSA9IFwiNFwiOyAvLyBiaXRzIDEyLTE1IG9mIHRoZSB0aW1lX2hpX2FuZF92ZXJzaW9uIGZpZWxkIHRvIDAwMTBcbiAgICAgICAgICAgIHNbMTldID0gaGV4RGlnaXRzLnN1YnN0cigoc1sxOV0gJiAweDMpIHwgMHg4LCAxKTsgLy8gYml0cyA2LTcgb2YgdGhlIGNsb2NrX3NlcV9oaV9hbmRfcmVzZXJ2ZWQgdG8gMDFcbiAgICAgICAgICAgIHNbOF0gPSBzWzEzXSA9IHNbMThdID0gc1syM10gPSBcIi1cIjtcblxuICAgICAgICAgICAgdmFyIHV1aWQgPSBzLmpvaW4oXCJcIik7XG4gICAgICAgICAgICByZXR1cm4gdXVpZDtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsIid1c2Ugc3RyaWN0JztcblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ3BpbmNoQXBwJylcbiAgICAuZGlyZWN0aXZlKCdmb2N1c09uJywgZm9jdXNPbilcblxuZnVuY3Rpb24gZm9jdXNPbigpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGVsZW0sIGF0dHIpIHtcbiAgICAgICAgc2NvcGUuJG9uKCdmb2N1c09uJywgZnVuY3Rpb24oZSwgbmFtZSkge1xuICAgICAgICAgICAgaWYgKG5hbWUgPT09IGF0dHIuZm9jdXNPbikge1xuICAgICAgICAgICAgICAgIGVsZW1bMF0uZm9jdXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbn1cbiIsIid1c2Ugc3RyaWN0JztcblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ3BpbmNoQXBwJylcbiAgICAuZGlyZWN0aXZlKCd0b29sVGlwJywgdG9vbFRpcClcblxuZnVuY3Rpb24gdG9vbFRpcCgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudCgnLnRvb2wtdGlwJykub24oJ2NsaWNrIG1vdXNlbGVhdmUnLCBoaWRlVG9vbHRpcCk7XG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudCgnLnRvb2wtdGlwJykub24oJ21vdXNlZW50ZXInLCBzaG93VG9vbHRpcCk7XG4gICAgfTtcbn1cblxuZnVuY3Rpb24gaGlkZVRvb2x0aXAoKSB7XG4gICAgJCh0aGlzKS50b29sdGlwKCdoaWRlJyk7XG59XG5cbmZ1bmN0aW9uIHNob3dUb29sdGlwKCkge1xuICAgICQodGhpcykudG9vbHRpcCgnc2hvdycpO1xufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
