"use strict";function init(){sticky(),windowScrollDown()}function sticky(){$(".sticky").sticky({topSpacing:60})}function windowScrollDown(){var e,o=0;$(window).scroll(function(){console.log($(window).scrollTop()),e=$(this).scrollTop(),o>e?($(".home-page nav").removeClass("folded"),$(".home-page nav").css("border-bottom","0px solid")):$(".home-page nav").addClass("folded"),o=e,$(window).scrollTop()<1&&$(".home-page nav").addClass("top"),$(window).scrollTop()>1&&$(".home-page nav").removeClass("top"),$(window).scrollTop()>30,$(window).scrollTop()<540&&$(".home-page nav").css("box-shadow","inset 0 -1px 0px 0px rgba(0,0,0,0)"),$(window).scrollTop()>540&&$(".home-page nav").css("box-shadow","inset 0 -1px 0px 0px rgba(0,0,0,0.1)")})}function Account(e){this.getCurrentUser=function(){return e({method:"GET",url:"/api/users/own"})},this.getUserData=function(o){return e({method:"GET",url:"/api/users/"+o})},this.updateUserData=function(o,t){return e({method:"PUT",url:"/api/users/"+o,data:t})},this.follow=function(o,t){return e({method:"PUT",url:"/api/users/event/follow",data:{currentUser:o,followTarget:t}})}}function Project(e){this.createOne=function(o){return e({method:"POST",url:"/api/projects/",data:o})},this.getAll=function(){return e({method:"GET",url:"/api/projects/all"})},this.getOnePorject=function(o){return e({method:"GET",url:"/api/projects/"+o})},this.deleteOne=function(o){return e({method:"DELETE",url:"/api/projects/"+o})},this.deleteOne=function(o){return e({method:"DELETE",url:"/api/projects/"+o})},this.like=function(o,t){return e({method:"PUT",url:"/api/projects/event/like",data:{projectId:o,likerId:t}})}}function focus(e,o){return function(t){o(function(){e.$broadcast("focusOn",t)},0)}}function homeCtrl(){console.log("homeCtrl loaded")}function projectSettingCtrl(e,o,t,n,r,l){console.log("projectSettingCtrl loaded");var c=!1,i=t.projectId;n.getOnePorject(i).then(function(o){console.log("projects: ",o.data),e.project=o.data,e.updateProjectData=e.project,e.project.author.forEach(function(o){o._id==e.currentUser._id&&(c=!0)}),c?console.log("isAuthor"):(console.log("is not Author"),r.go("home"))},function(e){console.log("err when get this project: ",e)}),e.request={people:[],supply:[],money:[]},e.init=function(){var e=l.$$path.includes("danger")||l.$$path.includes("request")||l.$$path.includes("privacy");e||r.go("projectSetting_general")},e.addChoiceToPeople=function(o){-1!==e.request.people.indexOf(o)?e.request.people.splice(e.request.people.indexOf(o),1):e.request.people.push(o),console.log(e.request.people)},e.addChoiceToSupply=function(o){-1!==e.request.supply.indexOf(o)?e.request.supply.splice(e.request.supply.indexOf(o),1):e.request.supply.push(o),console.log(e.request.supply)},e.addChoiceToMoney=function(o){-1!==e.request.money.indexOf(o)?(e.request.money.splice(e.request.money.indexOf(o),1),e.request.money=[]):(e.request.money=[],e.request.money.push(o)),console.log(e.request.money)},e.deleteProject=function(o){if(e.deleteProjectInput==o){var l=t.projectId;n.deleteOne(l).then(function(o){console.log("project deleted"),console.log("res: ",o.data),r.go("ppage",{userId:e.currentUser._id})},function(e){console.log("user is not logged in.")})}else console.log("no")},e.dangerNotified=!1,e.dangerNotifty=function(){e.dangerNotified=!e.dangerNotified},e.sameToTheProjectName=function(o){return e.deleteProjectInput==o},e.okayToDelete=function(o){return console.log("$scope.dangerNotified: ",e.dangerNotified),e.deleteProjectInput==o&&e.dangerNotified}}function projectpageCtrl(e,o,t,n){console.log("projectpageCtrl loaded"),e.state={},e.state.isAuthor=!1;var r=t.projectId;n.getOnePorject(r).then(function(o){console.log("projectData: ",o.data),e.project=o.data,console.log("$scope.currentUser._id: ",e.currentUser._id),console.log("$scope.project.author: ",e.project.author);var t=o.data.author;for(var n in t)if(e.currentUser._id==t[n]._id)return e.state.isAuthor=!0},function(e){console.log("err when get this project: ",e)}),e.like=function(o,t){console.log(o,"clicks likeBtn of",t),e.state.isAuthor&&(console.log("likeEvent triggered"),n.like(t,o).then(function(e){console.log("res: ",e)},function(e){console.log("err when like/unlike: ",e)}))}}function profileSettingCtrl(e,o,t,n,r,l,c,i){console.log("profileSettingCtrl loaded"),t.userId==e.currentUser._id?e.updateUserData=angular.copy(e.currentUser):r.go("home"),e.init=function(){var e=i.$$path.includes("danger")||i.$$path.includes("request")||i.$$path.includes("privacy");e||r.go("profileSetting_general")},e.updateUserDataSubmitted=function(){var o=e.updateUserData._id,t=e.updateUserData;n.updateUserData(o,t).then(function(o){e.updateUserData=o.data,l.location.reload()},function(e){console.log("err when get update user data: ",e)})},e.photoUploading=!1,e.uploadFiles=function(o){e.photoUploading=!0;var o=o[0],t=e.currentUser._id;console.log("photo: ",o),o&&c.upload({url:"/api/upload/"+t,data:{newFile:o}}).then(function(e){console.log("res after upload: ",e.data),l.location.reload()},function(e){console.log("err when upload file: ",e)})}}function ppageCtrl(e,o,t,n,r,l,c,i){function a(){var e=i.$$path.includes("starred")||i.$$path.includes("followers");e||o.go("ppage_projects")}console.log("ppageCtrl loaded"),e.state={},e.state.isTheUser=!1,e.state.followStatus=!1;var s,u=n.userId;u==e.currentUser._id&&(e.state.isTheUser=!0),e.state.isTheUser?console.log("isTheUser"):console.log("is not TheUser"),e.init=function(){a()},l.getUserData(u).then(function(o){e.user=o.data,s=o.data,e.projects=o.data.projects.reverse(),console.log("cards here: ",o.data.projects),c(function(){p()},0)},function(e){console.log("err when get userData: ",e)}),e.createTime=function(e){return moment(e).fromNow()},e.follow=function(o,t){console.log("ffffff"),console.log(o,t),o!==t&&t==u&&(console.log("followEvent triggered"),l.follow(o,t).then(function(o){if(console.log("res: ",o),"follow"==o.data.eventType){console.log("check"),console.log("follwing: res, ",o.data);var t=o.data.follower;o.data.followingReceiver;e.user.followersList.push(t),p()}else if("unfollow"==o.data.eventType){console.log("check"),console.log("unfollwing: res, ",o.data);var n=(o.data.unfollower,o.data.unfollowingReceiver,e.user.followersList.indexOf(t));e.user.followersList.splice(n,1),p()}},function(e){console.log("err when follow/unfollow: ",e)}))};var p=function(){if(console.log("checkFollowStatus trigerred"),console.log("displayUser: ",s),s.followersList.length>0){var o=s.followersList;console.log("checked");for(var t in o)console.log("currentUser: ",e.currentUser._id),console.log("followersList[follower]._id: ",o[t]._id),o[t]._id==e.currentUser._id?e.state.followStatus=!0:e.state.followStatus=!1}else e.state.followStatus=!1}}function navCtrl(e,o,t,n,r,l,c,i,a,s,u){o.currentUser="",o.loginloading=!1,o.logoutloading=!1,r.hideNav=!1,r.createModal=!1,o.authenticate=function(e){o.loginloading=!0,t.authenticate(e).then(function(e){n.getCurrentUser().then(function(e){console.log("user logged in: ",e.data),o.currentUser=e.data,o.loginloading=!1,console.log("$scope.currentUser._id: ",o.currentUser._id),"home"==i.current.name?i.go("ppage",{userId:o.currentUser._id}):c.location.reload()},function(e){console.log("user is not logged in.")})},function(e){console.log("err when log user in: ",e)})},t.isAuthenticated()&&n.getCurrentUser().then(function(e){o.currentUser=e.data,console.log("navCtrl triggered and currentUser: ",o.currentUser)},function(e){console.log("user is not logged in.")}),o.isAuthenticated=function(){return t.isAuthenticated()},o.logout=function(){o.logoutloading=!0,t.logout(),l(function(){o.logoutloading=!1,c.location.reload()},0)},o.goppage=function(){console.log("$location.$$path: ",u.$$path),u.$$path.includes("projects")?c.location.reload():i.go("ppage",{userId:o.currentUser._id})},o.create=function(){o.projectInitalizing=!1,o.newProjectName="",o.newProjectPitch="",o.createModal=!0,l(function(){a("focusMe")},100)},o.createProject=function(){o.projectInitalizing=!0,console.log("create project called: ",o.newProjectName);var e={title:o.newProjectName,pitch:o.newProjectPitch};s.createOne(e).then(function(e){console.log("add new behavior[createNewProject]: ",e.data),l(function(){o.projectInitalizing=!1,o.createModal=!1,"ppage"==i.current.name?c.location.reload():i.go("ppage",{userId:o.currentUser._id})},1500*Math.random()+300)},function(e){console.log("err when create project: ",e)})}}function focusOn(){return function(e,o,t){e.$on("focusOn",function(e,n){n===t.focusOn&&o[0].focus()})}}function toolTip(){return function(e,o,t){angular.element(".tool-tip").on("click mouseleave",hideTooltip),angular.element(".tool-tip").on("mouseenter",showTooltip)}}function hideTooltip(){$(this).tooltip("hide")}function showTooltip(){$(this).tooltip("show")}angular.module("pinchApp",["ui.router","satellizer","ui.bootstrap","ngFileUpload","ngImgCrop"]).config(["$stateProvider","$urlRouterProvider","$authProvider",function(e,o,t){t.facebook({clientId:"298165113849366"}),e.state(home),o.otherwise("/")}]);var home={name:"home",url:"/",views:{main:{templateUrl:"/html/home.html",controller:"homeCtrl"}}};$(document).ready(init),Account.$inject=["$http"],Project.$inject=["$http"],focus.$inject=["$rootScope","$timeout"],angular.module("pinchApp").service("Account",Account).service("Project",Project).factory("focus",focus),navCtrl.$inject=["$http","$scope","$auth","Account","$rootScope","$timeout","$window","$state","focus","Project","$location"],ppageCtrl.$inject=["$scope","$state","$rootScope","$stateParams","Project","Account","$timeout","$location"],profileSettingCtrl.$inject=["$scope","$http","$stateParams","Account","$state","$window","Upload","$location"],projectpageCtrl.$inject=["$scope","$http","$stateParams","Project"],projectSettingCtrl.$inject=["$scope","$http","$stateParams","Project","$state","$location"],angular.module("pinchApp").controller("navCtrl",navCtrl).controller("homeCtrl",homeCtrl).controller("ppageCtrl",ppageCtrl).controller("profileSettingCtrl",profileSettingCtrl).controller("projectpageCtrl",projectpageCtrl).controller("projectSettingCtrl",projectSettingCtrl),angular.module("pinchApp").directive("focusOn",focusOn),angular.module("pinchApp").directive("toolTip",toolTip);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFtb2R1bGUuanMiLCJtYWluLmpzIiwic2VydmljZXMuanMiLCJjb250cm9sbGVycy9jb250cm9sbGVycy5qcyIsImRpcmVjdGl2ZXMvZm9jdXNPbi5kaXJlY3RpdmUuanMiLCJkaXJlY3RpdmVzL3Rvb2xUaXAuZGlyZWN0aXZlLmpzIl0sIm5hbWVzIjpbImluaXQiLCJzdGlja3kiLCJ3aW5kb3dTY3JvbGxEb3duIiwiJCIsInRvcFNwYWNpbmciLCJzdCIsImxhc3RTY3JvbGxUb3AiLCJ3aW5kb3ciLCJzY3JvbGwiLCJjb25zb2xlIiwibG9nIiwic2Nyb2xsVG9wIiwidGhpcyIsInJlbW92ZUNsYXNzIiwiY3NzIiwiYWRkQ2xhc3MiLCJBY2NvdW50IiwiJGh0dHAiLCJnZXRDdXJyZW50VXNlciIsIm1ldGhvZCIsInVybCIsImdldFVzZXJEYXRhIiwidXJpVXNlcklkIiwidXBkYXRlVXNlckRhdGEiLCJkYXRhIiwiZm9sbG93IiwiY3VycmVudFVzZXIiLCJmb2xsb3dUYXJnZXQiLCJQcm9qZWN0IiwiY3JlYXRlT25lIiwibmV3UG9qZWN0T2JqIiwiZ2V0QWxsIiwiZ2V0T25lUG9yamVjdCIsInByb2plY3RJZCIsImRlbGV0ZU9uZSIsImxpa2UiLCJsaWtlcklkIiwiZm9jdXMiLCIkcm9vdFNjb3BlIiwiJHRpbWVvdXQiLCJuYW1lIiwiJGJyb2FkY2FzdCIsImhvbWVDdHJsIiwicHJvamVjdFNldHRpbmdDdHJsIiwiJHNjb3BlIiwiJHN0YXRlUGFyYW1zIiwiJHN0YXRlIiwiJGxvY2F0aW9uIiwiaXNBdXRob3IiLCJ0aGVuIiwicmVzIiwicHJvamVjdCIsInVwZGF0ZVByb2plY3REYXRhIiwiYXV0aG9yIiwiZm9yRWFjaCIsIl9pZCIsImdvIiwiZXJyIiwicmVxdWVzdCIsInBlb3BsZSIsInN1cHBseSIsIm1vbmV5IiwiY2hlY2tVcmwiLCIkJHBhdGgiLCJpbmNsdWRlcyIsImFkZENob2ljZVRvUGVvcGxlIiwiaW5kZXhPZiIsInNwbGljZSIsInB1c2giLCJhZGRDaG9pY2VUb1N1cHBseSIsImFkZENob2ljZVRvTW9uZXkiLCJkZWxldGVQcm9qZWN0IiwicHJvamVjdEZ1bGxOYW1lIiwiZGVsZXRlUHJvamVjdElucHV0IiwiX3Byb2plY3RJZCIsInVzZXJJZCIsImRhbmdlck5vdGlmaWVkIiwiZGFuZ2VyTm90aWZ0eSIsInNhbWVUb1RoZVByb2plY3ROYW1lIiwib2theVRvRGVsZXRlIiwicHJvamVjdHBhZ2VDdHJsIiwic3RhdGUiLCJhdXRob3JzIiwicHJvZmlsZVNldHRpbmdDdHJsIiwiJHdpbmRvdyIsIlVwbG9hZCIsImFuZ3VsYXIiLCJjb3B5IiwidXBkYXRlVXNlckRhdGFTdWJtaXR0ZWQiLCJsb2NhdGlvbiIsInJlbG9hZCIsInBob3RvVXBsb2FkaW5nIiwidXBsb2FkRmlsZXMiLCJmaWxlIiwidXBsb2FkIiwibmV3RmlsZSIsInBwYWdlQ3RybCIsImNoZWNraW5nVXJsIiwiaXNUaGVVc2VyIiwiZm9sbG93U3RhdHVzIiwiZGlzcGxheVVzZXIiLCJ1c2VyIiwicHJvamVjdHMiLCJyZXZlcnNlIiwiY2hlY2tGb2xsb3dTdGF0dXMiLCJjcmVhdGVUaW1lIiwiY3JlYXRlQXRUaW1lIiwibW9tZW50IiwiZnJvbU5vdyIsImV2ZW50VHlwZSIsImZvbGxvd2VyIiwiZm9sbG93aW5nUmVjZWl2ZXIiLCJmb2xsb3dlcnNMaXN0IiwiaW5kZXgiLCJ1bmZvbGxvd2VyIiwidW5mb2xsb3dpbmdSZWNlaXZlciIsImxlbmd0aCIsIm5hdkN0cmwiLCIkYXV0aCIsImxvZ2lubG9hZGluZyIsImxvZ291dGxvYWRpbmciLCJoaWRlTmF2IiwiY3JlYXRlTW9kYWwiLCJhdXRoZW50aWNhdGUiLCJwcm92aWRlciIsImN1cnJlbnQiLCJpc0F1dGhlbnRpY2F0ZWQiLCJsb2dvdXQiLCJnb3BwYWdlIiwiY3JlYXRlIiwicHJvamVjdEluaXRhbGl6aW5nIiwibmV3UHJvamVjdE5hbWUiLCJuZXdQcm9qZWN0UGl0Y2giLCJjcmVhdGVQcm9qZWN0IiwidGl0bGUiLCJwaXRjaCIsIk1hdGgiLCJyYW5kb20iLCJmb2N1c09uIiwic2NvcGUiLCJlbGVtIiwiYXR0ciIsIiRvbiIsImUiLCJ0b29sVGlwIiwiZWxlbWVudCIsImF0dHJzIiwib24iLCJoaWRlVG9vbHRpcCIsInNob3dUb29sdGlwIiwidG9vbHRpcCIsIm1vZHVsZSIsImNvbmZpZyIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwiJGF1dGhQcm92aWRlciIsImZhY2Vib29rIiwiY2xpZW50SWQiLCJob21lIiwib3RoZXJ3aXNlIiwidmlld3MiLCJtYWluIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwiZG9jdW1lbnQiLCJyZWFkeSIsIiRpbmplY3QiLCJzZXJ2aWNlIiwiZmFjdG9yeSIsImRpcmVjdGl2ZSJdLCJtYXBwaW5ncyI6IkFBQUEsWUNJQSxTQUFTQSxRQUNMQyxTQUNBQyxtQkFHSixRQUFTRCxVQUNMRSxFQUFFLFdBQVdGLFFBQ1RHLFdBQVksS0FJcEIsUUFBU0Ysb0JBQ0wsR0FDSUcsR0FEQUMsRUFBZ0IsQ0FFcEJILEdBQUVJLFFBQVFDLE9BQU8sV0FDYkMsUUFBUUMsSUFBSVAsRUFBRUksUUFBUUksYUFDdEJOLEVBQUtGLEVBQUVTLE1BQU1ELFlBQ0pMLEVBQUxELEdBQ0FGLEVBQUUsa0JBQWtCVSxZQUFZLFVBQ2hDVixFQUFFLGtCQUFrQlcsSUFBSSxnQkFBaUIsY0FFekNYLEVBQUUsa0JBQWtCWSxTQUFTLFVBRWpDVCxFQUFnQkQsRUFFWkYsRUFBRUksUUFBUUksWUFBYyxHQUN4QlIsRUFBRSxrQkFBa0JZLFNBQVMsT0FFN0JaLEVBQUVJLFFBQVFJLFlBQWMsR0FDeEJSLEVBQUUsa0JBQWtCVSxZQUFZLE9BRWhDVixFQUFFSSxRQUFRSSxZQUFjLEdBR3hCUixFQUFFSSxRQUFRSSxZQUFjLEtBQ3hCUixFQUFFLGtCQUFrQlcsSUFBSSxhQUFjLHNDQUV0Q1gsRUFBRUksUUFBUUksWUFBYyxLQUN4QlIsRUFBRSxrQkFBa0JXLElBQUksYUFBYywwQ0NsQ2xELFFBQVNFLFNBQVFDLEdBQ2JM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QVFpRCxTQUFXLFFBQVMsU0FBVSxRQUFTLFVBQVcsYUFBYyxXQUFZLFVBQVcsU0FBVSxRQUFTLFVBQVcsYUFDN0h0RSxVQUFVc0UsU0FBVyxTQUFVLFNBQVUsYUFBYyxlQUFnQixVQUFXLFVBQVcsV0FBWSxhQUN6R25GLG1CQUFtQm1GLFNBQVcsU0FBVSxRQUFTLGVBQWdCLFVBQVcsU0FBVSxVQUFXLFNBQVUsYUFDM0d0RixnQkFBZ0JzRixTQUFXLFNBQVUsUUFBUyxlQUFnQixXQUM5RDNILG1CQUFtQjJILFNBQVcsU0FBVSxRQUFTLGVBQWdCLFVBQVcsU0FBVSxhQUp0RmhGLFFBQ0tpRSxPQUFPLFlBQ1BZLFdBQVcsVUFBVzlDLFNBQ3RCOEMsV0FBVyxXQUFZekgsVUFDdkJ5SCxXQUFXLFlBQWFuRSxXQUN4Qm1FLFdBQVcscUJBQXNCaEYsb0JBQ2pDZ0YsV0FBVyxrQkFBbUJuRixpQkFDOUJtRixXQUFXLHFCQUFzQnhILG9CQ1B0QzJDLFFBQ0tpRSxPQUFPLFlBQ1BrQixVQUFVLFVBQVcvQixTQ0YxQnBELFFBQ0tpRSxPQUFPLFlBQ1BrQixVQUFVLFVBQVd6QiIsImZpbGUiOiJidW5kbGUubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5hbmd1bGFyXG4gICAgLm1vZHVsZSgncGluY2hBcHAnLCBbXG4gICAgICAgICd1aS5yb3V0ZXInLFxuICAgICAgICAnc2F0ZWxsaXplcicsXG4gICAgICAgICd1aS5ib290c3RyYXAnLFxuICAgICAgICAnbmdGaWxlVXBsb2FkJyxcbiAgICAgICAgJ25nSW1nQ3JvcCdcbiAgICBdKVxuICAgIC5jb25maWcoZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlciwgJGF1dGhQcm92aWRlcikge1xuXG4gICAgJGF1dGhQcm92aWRlclxuICAgICAgICAuZmFjZWJvb2soe1xuICAgICAgICAgICAgY2xpZW50SWQ6ICcyOTgxNjUxMTM4NDkzNjYnXG4gICAgICAgIH0pO1xuXG4gICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgLnN0YXRlKGhvbWUpXG4gICAgICAgIC8vIC5zdGF0ZShwcGFnZSlcbiAgICAgICAgLy8gLnN0YXRlKHBwYWdlX3Byb2plY3RzKVxuICAgICAgICAvLyAuc3RhdGUocHBhZ2VfbGlrZWQpXG4gICAgICAgIC8vIC5zdGF0ZShwcGFnZV9mb2xsb3dlcnMpXG4gICAgICAgIC8vIC5zdGF0ZShwcm9qZWN0cGFnZSlcbiAgICAgICAgLy8gLnN0YXRlKHByb2plY3RTZXR0aW5nKVxuICAgICAgICAvLyAuc3RhdGUocHJvamVjdFNldHRpbmdfZ2VuZXJhbClcbiAgICAgICAgLy8gLnN0YXRlKHByb2plY3RTZXR0aW5nX3JlcXVlc3QpXG4gICAgICAgIC8vIC5zdGF0ZShwcm9qZWN0U2V0dGluZ19wcml2YWN5KVxuICAgICAgICAvLyAuc3RhdGUocHJvamVjdFNldHRpbmdfZGFuZ2VyKVxuICAgICAgICAvLyAuc3RhdGUocHJvZmlsZVNldHRpbmcpXG4gICAgICAgIC8vIC5zdGF0ZShwcm9maWxlU2V0dGluZ19nZW5lcmFsKVxuICAgICAgICAvLyAuc3RhdGUocHJvZmlsZVNldHRpbmdfcmVxdWVzdClcbiAgICAgICAgLy8gLnN0YXRlKHByb2ZpbGVTZXR0aW5nX3ByaXZhY3kpXG4gICAgICAgIC8vIC5zdGF0ZShwcm9maWxlU2V0dGluZ19kYW5nZXIpXG5cblxuICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcbn0pO1xuXG5cbmxldCBob21lID0ge1xuICAgIG5hbWU6ICdob21lJyxcbiAgICB1cmw6ICcvJyxcbiAgICB2aWV3czoge1xuICAgICAgICBtYWluOiB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL2hvbWUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnaG9tZUN0cmwnXG4gICAgICAgIH1cbiAgICB9XG59XG4vLyBsZXQgcHBhZ2UgPSB7XG4vLyAgICAgbmFtZTogJ3BwYWdlJyxcbi8vICAgICB1cmw6ICcvbS86dXNlcklkJyxcbi8vICAgICB2aWV3czoge1xuLy8gICAgICAgICAnbWFpbic6IHtcbi8vICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvcHBhZ2UuaHRtbCcsXG4vLyAgICAgICAgICAgICBjb250cm9sbGVyOiAncHBhZ2VDdHJsJ1xuLy8gICAgICAgICB9LFxuLy8gICAgICAgICAncmlnaHRfc2VjdGlvbic6IHtcbi8vICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvcHBhZ2VfcHJvamVjdHMuaHRtbCcsXG4vLyAgICAgICAgICAgICBjb250cm9sbGVyOiAncHBhZ2VDdHJsJ1xuLy8gICAgICAgICB9XG4vLyAgICAgfVxuLy8gfVxuLy9cbi8vIGxldCBwcGFnZV9wcm9qZWN0cyA9IHtcbi8vICAgICBuYW1lOiAncHBhZ2VfcHJvamVjdHMnLFxuLy8gICAgIHVybDogJy9wcm9qZWN0cycsXG4vLyAgICAgcGFyZW50OiAncHBhZ2UnLFxuLy8gICAgIHZpZXdzOiB7XG4vLyAgICAgICAgIHJpZ2h0X3NlY3Rpb246IHtcbi8vICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvcHBhZ2VfcHJvamVjdHMuaHRtbCcsXG4vLyAgICAgICAgICAgICBjb250cm9sbGVyOiAncHBhZ2VDdHJsJ1xuLy8gICAgICAgICB9XG4vLyAgICAgfVxuLy8gfVxuLy8gbGV0IHBwYWdlX2xpa2VkID0ge1xuLy8gICAgIG5hbWU6ICdwcGFnZV9saWtlZCcsXG4vLyAgICAgdXJsOiAnL2xpa2VkJyxcbi8vICAgICBwYXJlbnQ6ICdwcGFnZScsXG4vLyAgICAgdmlld3M6IHtcbi8vICAgICAgICAgcmlnaHRfc2VjdGlvbjoge1xuLy8gICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9wcGFnZV9saWtlZC5odG1sJyxcbi8vICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwcGFnZUN0cmwnXG4vLyAgICAgICAgIH1cbi8vICAgICB9XG4vLyB9XG4vLyBsZXQgcHBhZ2VfZm9sbG93ZXJzID0ge1xuLy8gICAgIG5hbWU6ICdwcGFnZV9mb2xsb3dlcnMnLFxuLy8gICAgIHVybDogJy9mb2xsb3dlcnMnLFxuLy8gICAgIHBhcmVudDogJ3BwYWdlJyxcbi8vICAgICB2aWV3czoge1xuLy8gICAgICAgICByaWdodF9zZWN0aW9uOiB7XG4vLyAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL3BwYWdlX2ZvbGxvd2Vycy5odG1sJyxcbi8vICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwcGFnZUN0cmwnXG4vLyAgICAgICAgIH1cbi8vICAgICB9XG4vLyB9XG4vLyBsZXQgcHJvamVjdHBhZ2UgPSB7XG4vLyAgICAgbmFtZTogJ3Byb2plY3RwYWdlJyxcbi8vICAgICB1cmw6ICcvOnByb2plY3RJZCcsXG4vLyAgICAgdmlld3M6IHtcbi8vICAgICAgICAgbWFpbjoge1xuLy8gICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9wcm9qZWN0cGFnZS5odG1sJyxcbi8vICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwcm9qZWN0cGFnZUN0cmwnXG4vLyAgICAgICAgIH1cbi8vICAgICB9XG4vLyB9XG4vLyBsZXQgcHJvamVjdFNldHRpbmcgPSB7XG4vLyAgICAgbmFtZTogJ3Byb2plY3RTZXR0aW5nJyxcbi8vICAgICB1cmw6ICcvcHJvamVjdC86cHJvamVjdElkL3NldHRpbmcnLFxuLy8gICAgIHZpZXdzOiB7XG4vLyAgICAgICAgIG1haW46IHtcbi8vICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvcHJvamVjdFNldHRpbmcuaHRtbCcsXG4vLyAgICAgICAgICAgICBjb250cm9sbGVyOiAncHJvamVjdFNldHRpbmdDdHJsJ1xuLy8gICAgICAgICB9XG4vLyAgICAgfVxuLy8gfVxuLy8gbGV0IHByb2plY3RTZXR0aW5nX2dlbmVyYWwgPSB7XG4vLyAgICAgbmFtZTogJ3Byb2plY3RTZXR0aW5nX2dlbmVyYWwnLFxuLy8gICAgIHVybDogJy9nZW5lcmFsJyxcbi8vICAgICBwYXJlbnQ6ICdwcm9qZWN0U2V0dGluZycsXG4vLyAgICAgdmlld3M6IHtcbi8vICAgICAgICAgcmlnaHRfc2VjdGlvbjoge1xuLy8gICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9wcm9qZWN0U2V0dGluZ19nZW5lcmFsLmh0bWwnLFxuLy8gICAgICAgICAgICAgY29udHJvbGxlcjogJ3Byb2plY3RTZXR0aW5nQ3RybCdcbi8vICAgICAgICAgfVxuLy8gICAgIH1cbi8vIH1cbi8vIGxldCBwcm9qZWN0U2V0dGluZ19yZXF1ZXN0ID0ge1xuLy8gICAgIG5hbWU6ICdwcm9qZWN0U2V0dGluZ19yZXF1ZXN0Jyxcbi8vICAgICB1cmw6ICcvcmVxdWVzdCcsXG4vLyAgICAgcGFyZW50OiAncHJvamVjdFNldHRpbmcnLFxuLy8gICAgIHZpZXdzOiB7XG4vLyAgICAgICAgIHJpZ2h0X3NlY3Rpb246IHtcbi8vICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvcHJvamVjdFNldHRpbmdfcmVxdWVzdC5odG1sJyxcbi8vICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwcm9qZWN0U2V0dGluZ0N0cmwnXG4vLyAgICAgICAgIH1cbi8vICAgICB9XG4vLyB9XG4vLyBsZXQgcHJvamVjdFNldHRpbmdfcHJpdmFjeSA9IHtcbi8vICAgICBuYW1lOiAncHJvamVjdFNldHRpbmdfcHJpdmFjeScsXG4vLyAgICAgdXJsOiAnL3ByaXZhY3knLFxuLy8gICAgIHBhcmVudDogJ3Byb2plY3RTZXR0aW5nJyxcbi8vICAgICB2aWV3czoge1xuLy8gICAgICAgICByaWdodF9zZWN0aW9uOiB7XG4vLyAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL3Byb2plY3RTZXR0aW5nX3ByaXZhY3kuaHRtbCcsXG4vLyAgICAgICAgICAgICBjb250cm9sbGVyOiAncHJvamVjdFNldHRpbmdDdHJsJ1xuLy8gICAgICAgICB9XG4vLyAgICAgfVxuLy8gfVxuLy8gbGV0IHByb2plY3RTZXR0aW5nX2RhbmdlciA9IHtcbi8vICAgICBuYW1lOiAncHJvamVjdFNldHRpbmdfZGFuZ2VyJyxcbi8vICAgICB1cmw6ICcvZGFuZ2VyJyxcbi8vICAgICBwYXJlbnQ6ICdwcm9qZWN0U2V0dGluZycsXG4vLyAgICAgdmlld3M6IHtcbi8vICAgICAgICAgcmlnaHRfc2VjdGlvbjoge1xuLy8gICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9wcm9qZWN0U2V0dGluZ19kYW5nZXIuaHRtbCcsXG4vLyAgICAgICAgICAgICBjb250cm9sbGVyOiAncHJvamVjdFNldHRpbmdDdHJsJ1xuLy8gICAgICAgICB9XG4vLyAgICAgfVxuLy8gfVxuLy8gbGV0IHByb2ZpbGVTZXR0aW5nID0ge1xuLy8gICAgIG5hbWU6ICdwcm9maWxlU2V0dGluZycsXG4vLyAgICAgdXJsOiAnL3VzZXIvOnVzZXJJZC9zZXR0aW5nJyxcbi8vICAgICB2aWV3czoge1xuLy8gICAgICAgICBtYWluOiB7XG4vLyAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL3Byb2ZpbGVTZXR0aW5nLmh0bWwnLFxuLy8gICAgICAgICAgICAgY29udHJvbGxlcjogJ3Byb2ZpbGVTZXR0aW5nQ3RybCdcbi8vICAgICAgICAgfVxuLy8gICAgIH1cbi8vIH1cbi8vIGxldCBwcm9maWxlU2V0dGluZ19nZW5lcmFsID0ge1xuLy8gICAgIG5hbWU6ICdwcm9maWxlU2V0dGluZ19nZW5lcmFsJyxcbi8vICAgICB1cmw6ICcvZ2VuZXJhbCcsXG4vLyAgICAgcGFyZW50OiAncHJvZmlsZVNldHRpbmcnLFxuLy8gICAgIHZpZXdzOiB7XG4vLyAgICAgICAgIHJpZ2h0X3NlY3Rpb246IHtcbi8vICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvcHJvZmlsZVNldHRpbmdfZ2VuZXJhbC5odG1sJyxcbi8vICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwcm9maWxlU2V0dGluZ0N0cmwnXG4vLyAgICAgICAgIH1cbi8vICAgICB9XG4vLyB9XG4vLyBsZXQgcHJvZmlsZVNldHRpbmdfcmVxdWVzdCA9IHtcbi8vICAgICBuYW1lOiAncHJvZmlsZVNldHRpbmdfcmVxdWVzdCcsXG4vLyAgICAgdXJsOiAnL3JlcXVlc3QnLFxuLy8gICAgIHBhcmVudDogJ3Byb2ZpbGVTZXR0aW5nJyxcbi8vICAgICB2aWV3czoge1xuLy8gICAgICAgICByaWdodF9zZWN0aW9uOiB7XG4vLyAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL3Byb2ZpbGVTZXR0aW5nX3JlcXVlc3QuaHRtbCcsXG4vLyAgICAgICAgICAgICBjb250cm9sbGVyOiAncHJvZmlsZVNldHRpbmdDdHJsJ1xuLy8gICAgICAgICB9XG4vLyAgICAgfVxuLy8gfVxuLy8gbGV0IHByb2ZpbGVTZXR0aW5nX3ByaXZhY3kgPSB7XG4vLyAgICAgbmFtZTogJ3Byb2ZpbGVTZXR0aW5nX3ByaXZhY3knLFxuLy8gICAgIHVybDogJy9wcml2YWN5Jyxcbi8vICAgICBwYXJlbnQ6ICdwcm9maWxlU2V0dGluZycsXG4vLyAgICAgdmlld3M6IHtcbi8vICAgICAgICAgcmlnaHRfc2VjdGlvbjoge1xuLy8gICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9wcm9maWxlU2V0dGluZ19wcml2YWN5Lmh0bWwnLFxuLy8gICAgICAgICAgICAgY29udHJvbGxlcjogJ3Byb2ZpbGVTZXR0aW5nQ3RybCdcbi8vICAgICAgICAgfVxuLy8gICAgIH1cbi8vIH1cbi8vIGxldCBwcm9maWxlU2V0dGluZ19kYW5nZXIgPSB7XG4vLyAgICAgICAgIG5hbWU6ICdwcm9maWxlU2V0dGluZ19kYW5nZXInLFxuLy8gICAgICAgICB1cmw6ICcvZGFuZ2VyJyxcbi8vICAgICAgICAgcGFyZW50OiAncHJvZmlsZVNldHRpbmcnLFxuLy8gICAgICAgICB2aWV3czoge1xuLy8gICAgICAgICAgICAgcmlnaHRfc2VjdGlvbjoge1xuLy8gICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvcHJvZmlsZVNldHRpbmdfZGFuZ2VyLmh0bWwnLFxuLy8gICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwcm9maWxlU2V0dGluZ0N0cmwnXG4vLyAgICAgICAgICAgICB9XG4vLyAgICAgICAgIH1cbi8vICAgICB9XG4iLCIndXNlIHN0cmljdCdcblxuJChkb2N1bWVudCkucmVhZHkoaW5pdCk7XG5cbmZ1bmN0aW9uIGluaXQoKSB7XG4gICAgc3RpY2t5KClcbiAgICB3aW5kb3dTY3JvbGxEb3duKClcbn1cblxuZnVuY3Rpb24gc3RpY2t5KCkge1xuICAgICQoXCIuc3RpY2t5XCIpLnN0aWNreSh7XG4gICAgICAgIHRvcFNwYWNpbmc6IDYwXG4gICAgfSlcbn1cblxuZnVuY3Rpb24gd2luZG93U2Nyb2xsRG93bigpIHtcbiAgICB2YXIgbGFzdFNjcm9sbFRvcCA9IDBcbiAgICB2YXIgc3RcbiAgICAkKHdpbmRvdykuc2Nyb2xsKGZ1bmN0aW9uKCkge1xuICAgICAgICBjb25zb2xlLmxvZygkKHdpbmRvdykuc2Nyb2xsVG9wKCkpO1xuICAgICAgICBzdCA9ICQodGhpcykuc2Nyb2xsVG9wKCk7XG4gICAgICAgIGlmIChzdCA8IGxhc3RTY3JvbGxUb3ApIHtcbiAgICAgICAgICAgICQoJy5ob21lLXBhZ2UgbmF2JykucmVtb3ZlQ2xhc3MoJ2ZvbGRlZCcpXG4gICAgICAgICAgICAkKCcuaG9tZS1wYWdlIG5hdicpLmNzcygnYm9yZGVyLWJvdHRvbScsICcwcHggc29saWQnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICQoJy5ob21lLXBhZ2UgbmF2JykuYWRkQ2xhc3MoJ2ZvbGRlZCcpXG4gICAgICAgIH1cbiAgICAgICAgbGFzdFNjcm9sbFRvcCA9IHN0XG5cbiAgICAgICAgaWYgKCQod2luZG93KS5zY3JvbGxUb3AoKSA8IDEpIHtcbiAgICAgICAgICAgICQoJy5ob21lLXBhZ2UgbmF2JykuYWRkQ2xhc3MoJ3RvcCcpXG4gICAgICAgIH1cbiAgICAgICAgaWYgKCQod2luZG93KS5zY3JvbGxUb3AoKSA+IDEpIHtcbiAgICAgICAgICAgICQoJy5ob21lLXBhZ2UgbmF2JykucmVtb3ZlQ2xhc3MoJ3RvcCcpXG4gICAgICAgIH1cbiAgICAgICAgaWYgKCQod2luZG93KS5zY3JvbGxUb3AoKSA+IDMwKSB7XG5cbiAgICAgICAgfVxuICAgICAgICBpZiAoJCh3aW5kb3cpLnNjcm9sbFRvcCgpIDwgNTQwKSB7XG4gICAgICAgICAgICAkKCcuaG9tZS1wYWdlIG5hdicpLmNzcygnYm94LXNoYWRvdycsICdpbnNldCAwIC0xcHggMHB4IDBweCByZ2JhKDAsMCwwLDApJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCQod2luZG93KS5zY3JvbGxUb3AoKSA+IDU0MCkge1xuICAgICAgICAgICAgJCgnLmhvbWUtcGFnZSBuYXYnKS5jc3MoJ2JveC1zaGFkb3cnLCAnaW5zZXQgMCAtMXB4IDBweCAwcHggcmdiYSgwLDAsMCwwLjEpJyk7XG4gICAgICAgIH1cblxuICAgIH0pXG59XG4iLCIndXNlIHN0cmljdCc7XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdwaW5jaEFwcCcpXG4gICAgLnNlcnZpY2UoJ0FjY291bnQnLCBBY2NvdW50KVxuICAgIC5zZXJ2aWNlKCdQcm9qZWN0JywgUHJvamVjdClcbiAgICAuZmFjdG9yeSgnZm9jdXMnLCBmb2N1cylcblxuZnVuY3Rpb24gQWNjb3VudCgkaHR0cCkge1xuICAgIHRoaXMuZ2V0Q3VycmVudFVzZXIgPSAoKSA9PiB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgdXJsOiAnL2FwaS91c2Vycy9vd24nXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICB0aGlzLmdldFVzZXJEYXRhID0gKHVyaVVzZXJJZCkgPT4ge1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgIHVybDogYC9hcGkvdXNlcnMvJHt1cmlVc2VySWR9YFxuICAgICAgICB9KVxuICAgIH1cbiAgICB0aGlzLnVwZGF0ZVVzZXJEYXRhID0gKHVyaVVzZXJJZCwgdXBkYXRlVXNlckRhdGEpID0+IHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BVVCcsXG4gICAgICAgICAgICB1cmw6IGAvYXBpL3VzZXJzLyR7dXJpVXNlcklkfWAsXG4gICAgICAgICAgICBkYXRhOiB1cGRhdGVVc2VyRGF0YVxuICAgICAgICB9KVxuICAgIH1cbiAgICB0aGlzLmZvbGxvdyA9IChjdXJyZW50VXNlciwgZm9sbG93VGFyZ2V0KSA9PiB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdQVVQnLFxuICAgICAgICAgICAgdXJsOiBgL2FwaS91c2Vycy9ldmVudC9mb2xsb3dgLFxuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRVc2VyOiBjdXJyZW50VXNlcixcbiAgICAgICAgICAgICAgICBmb2xsb3dUYXJnZXQ6IGZvbGxvd1RhcmdldFxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH1cbn1cblxuZnVuY3Rpb24gUHJvamVjdCgkaHR0cCkge1xuICAgIHRoaXMuY3JlYXRlT25lID0gKG5ld1BvamVjdE9iaikgPT4ge1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICB1cmw6ICcvYXBpL3Byb2plY3RzLycsXG4gICAgICAgICAgICBkYXRhOiBuZXdQb2plY3RPYmpcbiAgICAgICAgfSlcbiAgICB9XG4gICAgdGhpcy5nZXRBbGwgPSAoKSA9PiB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgdXJsOiAnL2FwaS9wcm9qZWN0cy9hbGwnXG4gICAgICAgIH0pXG4gICAgfVxuICAgIHRoaXMuZ2V0T25lUG9yamVjdCA9IChwcm9qZWN0SWQpID0+IHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICB1cmw6IGAvYXBpL3Byb2plY3RzLyR7cHJvamVjdElkfWBcbiAgICAgICAgfSlcbiAgICB9XG4gICAgdGhpcy5kZWxldGVPbmUgPSAocHJvamVjdElkKSA9PiB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdERUxFVEUnLFxuICAgICAgICAgICAgdXJsOiBgL2FwaS9wcm9qZWN0cy8ke3Byb2plY3RJZH1gXG4gICAgICAgIH0pXG4gICAgfVxuICAgIHRoaXMuZGVsZXRlT25lID0gKHByb2plY3RJZCkgPT4ge1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgICAgICAgIHVybDogYC9hcGkvcHJvamVjdHMvJHtwcm9qZWN0SWR9YFxuICAgICAgICB9KVxuICAgIH1cbiAgICB0aGlzLmxpa2UgPSAocHJvamVjdElkLCBsaWtlcklkKSA9PiB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdQVVQnLFxuICAgICAgICAgICAgdXJsOiBgL2FwaS9wcm9qZWN0cy9ldmVudC9saWtlYCxcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICBwcm9qZWN0SWQ6IHByb2plY3RJZCxcbiAgICAgICAgICAgICAgICBsaWtlcklkOiBsaWtlcklkXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxufVxuXG5mdW5jdGlvbiBmb2N1cygkcm9vdFNjb3BlLCAkdGltZW91dCkge1xuICAgIHJldHVybiBmdW5jdGlvbihuYW1lKSB7XG4gICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdmb2N1c09uJywgbmFtZSk7XG4gICAgICAgIH0sIDApO1xuICAgIH1cbn1cbiIsIid1c2Ugc3RyaWN0JztcblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ3BpbmNoQXBwJylcbiAgICAuY29udHJvbGxlcignbmF2Q3RybCcsIG5hdkN0cmwpXG4gICAgLmNvbnRyb2xsZXIoJ2hvbWVDdHJsJywgaG9tZUN0cmwpXG4gICAgLmNvbnRyb2xsZXIoJ3BwYWdlQ3RybCcsIHBwYWdlQ3RybClcbiAgICAuY29udHJvbGxlcigncHJvZmlsZVNldHRpbmdDdHJsJywgcHJvZmlsZVNldHRpbmdDdHJsKVxuICAgIC5jb250cm9sbGVyKCdwcm9qZWN0cGFnZUN0cmwnLCBwcm9qZWN0cGFnZUN0cmwpXG4gICAgLmNvbnRyb2xsZXIoJ3Byb2plY3RTZXR0aW5nQ3RybCcsIHByb2plY3RTZXR0aW5nQ3RybClcblxuXG5mdW5jdGlvbiBob21lQ3RybCgpIHtcbiAgICBjb25zb2xlLmxvZygnaG9tZUN0cmwgbG9hZGVkJyk7XG59XG5cbmZ1bmN0aW9uIHByb2plY3RTZXR0aW5nQ3RybCgkc2NvcGUsICRodHRwLCAkc3RhdGVQYXJhbXMsIFByb2plY3QsICRzdGF0ZSwgJGxvY2F0aW9uKSB7XG4gICAgY29uc29sZS5sb2coJ3Byb2plY3RTZXR0aW5nQ3RybCBsb2FkZWQnKTtcbiAgICB2YXIgaXNBdXRob3IgPSBmYWxzZTtcbiAgICB2YXIgcHJvamVjdElkID0gJHN0YXRlUGFyYW1zLnByb2plY3RJZDtcblxuICAgIFByb2plY3QuZ2V0T25lUG9yamVjdChwcm9qZWN0SWQpLnRoZW4ocmVzID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ3Byb2plY3RzOiAnLCByZXMuZGF0YSk7XG4gICAgICAgICRzY29wZS5wcm9qZWN0ID0gcmVzLmRhdGE7XG4gICAgICAgICRzY29wZS51cGRhdGVQcm9qZWN0RGF0YSA9ICRzY29wZS5wcm9qZWN0O1xuICAgICAgICAkc2NvcGUucHJvamVjdC5hdXRob3IuZm9yRWFjaChhdXRob3IgPT4ge1xuICAgICAgICAgICAgLy8gaW4gY2FzZSwgcHJvamVjdCBoYXMgbXV0aXBsZSBhdXRob3JzXG4gICAgICAgICAgICBpZiAoYXV0aG9yLl9pZCA9PSAkc2NvcGUuY3VycmVudFVzZXIuX2lkKSB7XG4gICAgICAgICAgICAgICAgaXNBdXRob3IgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICBpZiAoaXNBdXRob3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdpc0F1dGhvcicpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2lzIG5vdCBBdXRob3InKTtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnaG9tZScpO1xuICAgICAgICB9XG4gICAgfSwgZXJyID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ2VyciB3aGVuIGdldCB0aGlzIHByb2plY3Q6ICcsIGVycik7XG4gICAgfSlcbiAgICAkc2NvcGUucmVxdWVzdCA9IHtcbiAgICAgICAgcGVvcGxlOiBbXSxcbiAgICAgICAgc3VwcGx5OiBbXSxcbiAgICAgICAgbW9uZXk6IFtdXG4gICAgfTtcblxuICAgICRzY29wZS5pbml0ID0gKCkgPT4ge1xuICAgICAgICB2YXIgY2hlY2tVcmwgPSAkbG9jYXRpb24uJCRwYXRoLmluY2x1ZGVzKCdkYW5nZXInKSB8fCAkbG9jYXRpb24uJCRwYXRoLmluY2x1ZGVzKCdyZXF1ZXN0JykgfHwgJGxvY2F0aW9uLiQkcGF0aC5pbmNsdWRlcygncHJpdmFjeScpXG4gICAgICAgIGlmICghY2hlY2tVcmwpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygncHJvamVjdFNldHRpbmdfZ2VuZXJhbCcpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgICRzY29wZS5hZGRDaG9pY2VUb1Blb3BsZSA9IChwZW9wbGUpID0+IHtcbiAgICAgICAgaWYgKCRzY29wZS5yZXF1ZXN0LnBlb3BsZS5pbmRleE9mKHBlb3BsZSkgIT09IC0xKSB7XG4gICAgICAgICAgICAkc2NvcGUucmVxdWVzdC5wZW9wbGUuc3BsaWNlKCRzY29wZS5yZXF1ZXN0LnBlb3BsZS5pbmRleE9mKHBlb3BsZSksIDEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJHNjb3BlLnJlcXVlc3QucGVvcGxlLnB1c2gocGVvcGxlKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUucmVxdWVzdC5wZW9wbGUpO1xuICAgIH07XG5cbiAgICAkc2NvcGUuYWRkQ2hvaWNlVG9TdXBwbHkgPSAoc3VwcGx5KSA9PiB7XG4gICAgICAgIGlmICgkc2NvcGUucmVxdWVzdC5zdXBwbHkuaW5kZXhPZihzdXBwbHkpICE9PSAtMSkge1xuICAgICAgICAgICAgJHNjb3BlLnJlcXVlc3Quc3VwcGx5LnNwbGljZSgkc2NvcGUucmVxdWVzdC5zdXBwbHkuaW5kZXhPZihzdXBwbHkpLCAxKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICRzY29wZS5yZXF1ZXN0LnN1cHBseS5wdXNoKHN1cHBseSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLnJlcXVlc3Quc3VwcGx5KTtcbiAgICB9XG4gICAgJHNjb3BlLmFkZENob2ljZVRvTW9uZXkgPSAobW9uZXkpID0+IHtcbiAgICAgICAgaWYgKCRzY29wZS5yZXF1ZXN0Lm1vbmV5LmluZGV4T2YobW9uZXkpICE9PSAtMSkge1xuICAgICAgICAgICAgJHNjb3BlLnJlcXVlc3QubW9uZXkuc3BsaWNlKCRzY29wZS5yZXF1ZXN0Lm1vbmV5LmluZGV4T2YobW9uZXkpLCAxKTtcbiAgICAgICAgICAgICRzY29wZS5yZXF1ZXN0Lm1vbmV5ID0gW107XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkc2NvcGUucmVxdWVzdC5tb25leSA9IFtdO1xuICAgICAgICAgICAgJHNjb3BlLnJlcXVlc3QubW9uZXkucHVzaChtb25leSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLnJlcXVlc3QubW9uZXkpO1xuICAgIH1cbiAgICAkc2NvcGUuZGVsZXRlUHJvamVjdCA9IChwcm9qZWN0RnVsbE5hbWUpID0+IHtcbiAgICAgICAgaWYgKCRzY29wZS5kZWxldGVQcm9qZWN0SW5wdXQgPT0gcHJvamVjdEZ1bGxOYW1lKSB7XG4gICAgICAgICAgICBsZXQgcHJvamVjdElkID0gJHN0YXRlUGFyYW1zLnByb2plY3RJZDtcbiAgICAgICAgICAgIFByb2plY3QuZGVsZXRlT25lKHByb2plY3RJZCkudGhlbihyZXMgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdwcm9qZWN0IGRlbGV0ZWQnKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncmVzOiAnLCByZXMuZGF0YSk7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdwcGFnZScsIHtcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiAkc2NvcGUuY3VycmVudFVzZXIuX2lkXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LCBlcnIgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd1c2VyIGlzIG5vdCBsb2dnZWQgaW4uJyk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ25vJyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAkc2NvcGUuZGFuZ2VyTm90aWZpZWQgPSBmYWxzZTtcbiAgICAkc2NvcGUuZGFuZ2VyTm90aWZ0eSA9ICgpID0+IHtcbiAgICAgICAgJHNjb3BlLmRhbmdlck5vdGlmaWVkID0gISRzY29wZS5kYW5nZXJOb3RpZmllZDtcbiAgICB9XG4gICAgJHNjb3BlLnNhbWVUb1RoZVByb2plY3ROYW1lID0gKHByb2plY3RGdWxsTmFtZSkgPT4ge1xuICAgICAgICByZXR1cm4gJHNjb3BlLmRlbGV0ZVByb2plY3RJbnB1dCA9PSBwcm9qZWN0RnVsbE5hbWU7XG4gICAgfVxuICAgICRzY29wZS5va2F5VG9EZWxldGUgPSAocHJvamVjdEZ1bGxOYW1lKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCckc2NvcGUuZGFuZ2VyTm90aWZpZWQ6ICcsICRzY29wZS5kYW5nZXJOb3RpZmllZCk7XG4gICAgICAgIHJldHVybiAkc2NvcGUuZGVsZXRlUHJvamVjdElucHV0ID09IHByb2plY3RGdWxsTmFtZSAmJiAkc2NvcGUuZGFuZ2VyTm90aWZpZWQ7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBwcm9qZWN0cGFnZUN0cmwoJHNjb3BlLCAkaHR0cCwgJHN0YXRlUGFyYW1zLCBQcm9qZWN0KSB7XG4gICAgY29uc29sZS5sb2coJ3Byb2plY3RwYWdlQ3RybCBsb2FkZWQnKTtcbiAgICAkc2NvcGUuc3RhdGUgPSB7fVxuICAgICRzY29wZS5zdGF0ZS5pc0F1dGhvciA9IGZhbHNlXG4gICAgdmFyIHByb2plY3RJZCA9ICRzdGF0ZVBhcmFtcy5wcm9qZWN0SWQ7XG4gICAgLy8gY29uc29sZS5sb2coJ3Byb2plY3RJZDogJywgcHJvamVjdElkKTtcbiAgICBQcm9qZWN0LmdldE9uZVBvcmplY3QocHJvamVjdElkKS50aGVuKHJlcyA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdwcm9qZWN0RGF0YTogJywgcmVzLmRhdGEpO1xuICAgICAgICAkc2NvcGUucHJvamVjdCA9IHJlcy5kYXRhXG4gICAgICAgIGNvbnNvbGUubG9nKCckc2NvcGUuY3VycmVudFVzZXIuX2lkOiAnLCAkc2NvcGUuY3VycmVudFVzZXIuX2lkKVxuICAgICAgICBjb25zb2xlLmxvZygnJHNjb3BlLnByb2plY3QuYXV0aG9yOiAnLCAkc2NvcGUucHJvamVjdC5hdXRob3IpXG4gICAgICAgIHZhciBhdXRob3JzID0gcmVzLmRhdGEuYXV0aG9yXG4gICAgICAgIGZvciAodmFyIGF1dGhvciBpbiBhdXRob3JzKSB7XG4gICAgICAgICAgICBpZiAoJHNjb3BlLmN1cnJlbnRVc2VyLl9pZCA9PSBhdXRob3JzW2F1dGhvcl0uX2lkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICRzY29wZS5zdGF0ZS5pc0F1dGhvciA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCBlcnIgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygnZXJyIHdoZW4gZ2V0IHRoaXMgcHJvamVjdDogJywgZXJyKTtcbiAgICB9KVxuICAgICRzY29wZS5saWtlID0gKGxpa2VySWQsIHByb2plY3RJZCkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhsaWtlcklkLCAnY2xpY2tzIGxpa2VCdG4gb2YnLCBwcm9qZWN0SWQpO1xuICAgICAgICBpZiAoJHNjb3BlLnN0YXRlLmlzQXV0aG9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnbGlrZUV2ZW50IHRyaWdnZXJlZCcpXG4gICAgICAgICAgICBQcm9qZWN0Lmxpa2UocHJvamVjdElkLCBsaWtlcklkKS50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncmVzOiAnLCByZXMpO1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgaWYgKHJlcy5kYXRhLmV2ZW50VHlwZSA9PSAnZm9sbG93Jykge1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjaGVjaycpO1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdmb2xsd2luZzogcmVzLCAnLCByZXMuZGF0YSlcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB2YXIgZm9sbG93ZXIgPSByZXMuZGF0YS5mb2xsb3dlclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIHZhciBmb2xsb3dpbmdSZWNlaXZlciA9IHJlcy5kYXRhLmZvbGxvd2luZ1JlY2VpdmVyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgJHNjb3BlLnVzZXIuZm9sbG93ZXJzTGlzdC5wdXNoKGZvbGxvd2VyKVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGNoZWNrRm9sbG93U3RhdHVzKClcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIH0gZWxzZSBpZiAocmVzLmRhdGEuZXZlbnRUeXBlID09ICd1bmZvbGxvdycpIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBjb25zb2xlLmxvZygnY2hlY2snKTtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBjb25zb2xlLmxvZygndW5mb2xsd2luZzogcmVzLCAnLCByZXMuZGF0YSlcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB2YXIgdW5mb2xsb3dlciA9IHJlcy5kYXRhLnVuZm9sbG93ZXJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB2YXIgdW5mb2xsb3dpbmdSZWNlaXZlciA9IHJlcy5kYXRhLnVuZm9sbG93aW5nUmVjZWl2ZXJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB2YXIgaW5kZXggPSAkc2NvcGUudXNlci5mb2xsb3dlcnNMaXN0LmluZGV4T2YoZm9sbG93ZXIpXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgJHNjb3BlLnVzZXIuZm9sbG93ZXJzTGlzdC5zcGxpY2UoaW5kZXgsIDEpXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgY2hlY2tGb2xsb3dTdGF0dXMoKVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgfVxuICAgICAgICAgICAgfSwgZXJyID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZXJyIHdoZW4gbGlrZS91bmxpa2U6ICcsIGVycilcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIHByb2ZpbGVTZXR0aW5nQ3RybCgkc2NvcGUsICRodHRwLCAkc3RhdGVQYXJhbXMsIEFjY291bnQsICRzdGF0ZSwgJHdpbmRvdywgVXBsb2FkLCAkbG9jYXRpb24pIHtcbiAgICBjb25zb2xlLmxvZygncHJvZmlsZVNldHRpbmdDdHJsIGxvYWRlZCcpO1xuXG4gICAgaWYgKCRzdGF0ZVBhcmFtcy51c2VySWQgPT0gJHNjb3BlLmN1cnJlbnRVc2VyLl9pZCkge1xuICAgICAgICAvLyBjb25zb2xlLmxvZygnaXNBdXRoVXNlcicpO1xuICAgICAgICAkc2NvcGUudXBkYXRlVXNlckRhdGEgPSBhbmd1bGFyLmNvcHkoJHNjb3BlLmN1cnJlbnRVc2VyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBjb25zb2xlLmxvZygnaXMgbm90IEF1dGhVc2VyJyk7XG4gICAgICAgICRzdGF0ZS5nbygnaG9tZScpO1xuICAgIH1cbiAgICAkc2NvcGUuaW5pdCA9ICgpID0+IHtcbiAgICAgICAgdmFyIGNoZWNrVXJsID0gJGxvY2F0aW9uLiQkcGF0aC5pbmNsdWRlcygnZGFuZ2VyJykgfHwgJGxvY2F0aW9uLiQkcGF0aC5pbmNsdWRlcygncmVxdWVzdCcpIHx8ICRsb2NhdGlvbi4kJHBhdGguaW5jbHVkZXMoJ3ByaXZhY3knKVxuICAgICAgICBpZiAoIWNoZWNrVXJsKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ3Byb2ZpbGVTZXR0aW5nX2dlbmVyYWwnKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAkc2NvcGUudXBkYXRlVXNlckRhdGFTdWJtaXR0ZWQgPSAoKSA9PiB7XG4gICAgICAgIHZhciB1cmlVc2VySWQgPSAkc2NvcGUudXBkYXRlVXNlckRhdGEuX2lkO1xuICAgICAgICB2YXIgdXBkYXRlVXNlckRhdGEgPSAkc2NvcGUudXBkYXRlVXNlckRhdGE7XG4gICAgICAgIEFjY291bnQudXBkYXRlVXNlckRhdGEodXJpVXNlcklkLCB1cGRhdGVVc2VyRGF0YSkudGhlbihyZXMgPT4ge1xuICAgICAgICAgICAgJHNjb3BlLnVwZGF0ZVVzZXJEYXRhID0gcmVzLmRhdGE7XG4gICAgICAgICAgICAkd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICB9LCBlcnIgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2VyciB3aGVuIGdldCB1cGRhdGUgdXNlciBkYXRhOiAnLCBlcnIpO1xuICAgICAgICB9KVxuICAgIH1cbiAgICAkc2NvcGUucGhvdG9VcGxvYWRpbmcgPSBmYWxzZVxuICAgICRzY29wZS51cGxvYWRGaWxlcyA9IChmaWxlKSA9PiB7XG4gICAgICAgICRzY29wZS5waG90b1VwbG9hZGluZyA9IHRydWU7XG4gICAgICAgIHZhciBmaWxlID0gZmlsZVswXVxuICAgICAgICB2YXIgdXNlcklkID0gJHNjb3BlLmN1cnJlbnRVc2VyLl9pZDtcbiAgICAgICAgY29uc29sZS5sb2coJ3Bob3RvOiAnLCBmaWxlKTtcbiAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgIFVwbG9hZC51cGxvYWQoe1xuICAgICAgICAgICAgICAgIHVybDogYC9hcGkvdXBsb2FkLyR7dXNlcklkfWAsXG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICBuZXdGaWxlOiBmaWxlXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkudGhlbihyZXMgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXMgYWZ0ZXIgdXBsb2FkOiAnLCByZXMuZGF0YSk7XG4gICAgICAgICAgICAgICAgJHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgIH0sIGVyciA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2VyciB3aGVuIHVwbG9hZCBmaWxlOiAnLCBlcnIpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH1cblxufVxuXG5mdW5jdGlvbiBwcGFnZUN0cmwoJHNjb3BlLCAkc3RhdGUsICRyb290U2NvcGUsICRzdGF0ZVBhcmFtcywgUHJvamVjdCwgQWNjb3VudCwgJHRpbWVvdXQsICRsb2NhdGlvbikge1xuICAgIGNvbnNvbGUubG9nKCdwcGFnZUN0cmwgbG9hZGVkJylcbiAgICAkc2NvcGUuc3RhdGUgPSB7fVxuICAgICRzY29wZS5zdGF0ZS5pc1RoZVVzZXIgPSBmYWxzZVxuICAgICRzY29wZS5zdGF0ZS5mb2xsb3dTdGF0dXMgPSBmYWxzZVxuICAgIHZhciBkaXNwbGF5VXNlcjtcbiAgICB2YXIgdXJpVXNlcklkID0gJHN0YXRlUGFyYW1zLnVzZXJJZDtcbiAgICBpZiAodXJpVXNlcklkID09ICRzY29wZS5jdXJyZW50VXNlci5faWQpIHtcbiAgICAgICAgJHNjb3BlLnN0YXRlLmlzVGhlVXNlciA9IHRydWU7XG4gICAgfVxuICAgIGlmICgkc2NvcGUuc3RhdGUuaXNUaGVVc2VyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdpc1RoZVVzZXInKVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdpcyBub3QgVGhlVXNlcicpXG4gICAgfVxuICAgICRzY29wZS5pbml0ID0gKCkgPT4ge1xuICAgICAgICBjaGVja2luZ1VybCgpXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2hlY2tpbmdVcmwoKSB7XG4gICAgICAgIHZhciBjaGVja1VybCA9ICRsb2NhdGlvbi4kJHBhdGguaW5jbHVkZXMoJ3N0YXJyZWQnKSB8fCAkbG9jYXRpb24uJCRwYXRoLmluY2x1ZGVzKCdmb2xsb3dlcnMnKVxuICAgICAgICBpZiAoIWNoZWNrVXJsKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ3BwYWdlX3Byb2plY3RzJyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgQWNjb3VudC5nZXRVc2VyRGF0YSh1cmlVc2VySWQpLnRoZW4ocmVzID0+IHtcbiAgICAgICAgJHNjb3BlLnVzZXIgPSByZXMuZGF0YVxuICAgICAgICBkaXNwbGF5VXNlciA9IHJlcy5kYXRhXG4gICAgICAgICRzY29wZS5wcm9qZWN0cyA9IHJlcy5kYXRhLnByb2plY3RzLnJldmVyc2UoKTtcbiAgICAgICAgY29uc29sZS5sb2coJ2NhcmRzIGhlcmU6ICcsIHJlcy5kYXRhLnByb2plY3RzKTtcbiAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjaGVja0ZvbGxvd1N0YXR1cygpXG4gICAgICAgIH0sIDApXG4gICAgfSwgZXJyID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ2VyciB3aGVuIGdldCB1c2VyRGF0YTogJywgZXJyKTtcbiAgICB9KVxuXG4gICAgJHNjb3BlLmNyZWF0ZVRpbWUgPSAoY3JlYXRlQXRUaW1lKSA9PiB7XG4gICAgICAgIHJldHVybiBtb21lbnQoY3JlYXRlQXRUaW1lKS5mcm9tTm93KCk7XG4gICAgfVxuXG4gICAgJHNjb3BlLmZvbGxvdyA9IChjdXJyZW50VXNlciwgZm9sbG93VGFyZ2V0KSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdmZmZmZmYnKTtcbiAgICAgICAgY29uc29sZS5sb2coY3VycmVudFVzZXIsIGZvbGxvd1RhcmdldCk7XG4gICAgICAgIGlmIChjdXJyZW50VXNlciAhPT0gZm9sbG93VGFyZ2V0ICYmIGZvbGxvd1RhcmdldCA9PSB1cmlVc2VySWQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdmb2xsb3dFdmVudCB0cmlnZ2VyZWQnKVxuICAgICAgICAgICAgQWNjb3VudC5mb2xsb3coY3VycmVudFVzZXIsIGZvbGxvd1RhcmdldCkudGhlbihyZXMgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXM6ICcsIHJlcyk7XG4gICAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLmV2ZW50VHlwZSA9PSAnZm9sbG93Jykge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnY2hlY2snKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2ZvbGx3aW5nOiByZXMsICcsIHJlcy5kYXRhKVxuICAgICAgICAgICAgICAgICAgICB2YXIgZm9sbG93ZXIgPSByZXMuZGF0YS5mb2xsb3dlclxuICAgICAgICAgICAgICAgICAgICB2YXIgZm9sbG93aW5nUmVjZWl2ZXIgPSByZXMuZGF0YS5mb2xsb3dpbmdSZWNlaXZlclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudXNlci5mb2xsb3dlcnNMaXN0LnB1c2goZm9sbG93ZXIpXG4gICAgICAgICAgICAgICAgICAgIGNoZWNrRm9sbG93U3RhdHVzKClcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlcy5kYXRhLmV2ZW50VHlwZSA9PSAndW5mb2xsb3cnKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjaGVjaycpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygndW5mb2xsd2luZzogcmVzLCAnLCByZXMuZGF0YSlcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVuZm9sbG93ZXIgPSByZXMuZGF0YS51bmZvbGxvd2VyXG4gICAgICAgICAgICAgICAgICAgIHZhciB1bmZvbGxvd2luZ1JlY2VpdmVyID0gcmVzLmRhdGEudW5mb2xsb3dpbmdSZWNlaXZlclxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSAkc2NvcGUudXNlci5mb2xsb3dlcnNMaXN0LmluZGV4T2YoZm9sbG93ZXIpXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS51c2VyLmZvbGxvd2Vyc0xpc3Quc3BsaWNlKGluZGV4LCAxKVxuICAgICAgICAgICAgICAgICAgICBjaGVja0ZvbGxvd1N0YXR1cygpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgZXJyID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZXJyIHdoZW4gZm9sbG93L3VuZm9sbG93OiAnLCBlcnIpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfVxuICAgIHZhciBjaGVja0ZvbGxvd1N0YXR1cyA9ICgpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjaGVja0ZvbGxvd1N0YXR1cyB0cmlnZXJyZWQnKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdkaXNwbGF5VXNlcjogJywgZGlzcGxheVVzZXIpO1xuICAgICAgICAgICAgaWYgKGRpc3BsYXlVc2VyLmZvbGxvd2Vyc0xpc3QubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHZhciBmb2xsb3dlcnNMaXN0ID0gZGlzcGxheVVzZXIuZm9sbG93ZXJzTGlzdFxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjaGVja2VkJyk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgZm9sbG93ZXIgaW4gZm9sbG93ZXJzTGlzdCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnY3VycmVudFVzZXI6ICcsICRzY29wZS5jdXJyZW50VXNlci5faWQpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZm9sbG93ZXJzTGlzdFtmb2xsb3dlcl0uX2lkOiAnLCBmb2xsb3dlcnNMaXN0W2ZvbGxvd2VyXS5faWQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZm9sbG93ZXJzTGlzdFtmb2xsb3dlcl0uX2lkID09ICRzY29wZS5jdXJyZW50VXNlci5faWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zdGF0ZS5mb2xsb3dTdGF0dXMgPSB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3RhdGUuZm9sbG93U3RhdHVzID0gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0YXRlLmZvbGxvd1N0YXR1cyA9IGZhbHNlXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gY2hlY2tGb2xsb3dTdGF0dXMoKVxufVxuXG5mdW5jdGlvbiBuYXZDdHJsKCRodHRwLCAkc2NvcGUsICRhdXRoLCBBY2NvdW50LCAkcm9vdFNjb3BlLCAkdGltZW91dCwgJHdpbmRvdywgJHN0YXRlLCBmb2N1cywgUHJvamVjdCwgJGxvY2F0aW9uKSB7XG4gICAgLy8gY29uc29sZS5sb2coJ25hdkN0cmwgbG9hZGVkJyk7XG4gICAgJHNjb3BlLmN1cnJlbnRVc2VyID0gJyc7XG4gICAgJHNjb3BlLmxvZ2lubG9hZGluZyA9IGZhbHNlO1xuICAgICRzY29wZS5sb2dvdXRsb2FkaW5nID0gZmFsc2U7XG4gICAgJHJvb3RTY29wZS5oaWRlTmF2ID0gZmFsc2U7XG4gICAgJHJvb3RTY29wZS5jcmVhdGVNb2RhbCA9IGZhbHNlO1xuXG4gICAgJHNjb3BlLmF1dGhlbnRpY2F0ZSA9IChwcm92aWRlcikgPT4ge1xuICAgICAgICAgICAgJHNjb3BlLmxvZ2lubG9hZGluZyA9IHRydWU7XG4gICAgICAgICAgICAkYXV0aC5hdXRoZW50aWNhdGUocHJvdmlkZXIpLnRoZW4oZGF0YSA9PiB7XG4gICAgICAgICAgICAgICAgQWNjb3VudC5nZXRDdXJyZW50VXNlcigpLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3VzZXIgbG9nZ2VkIGluOiAnLCByZXMuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jdXJyZW50VXNlciA9IHJlcy5kYXRhO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9naW5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCckc2NvcGUuY3VycmVudFVzZXIuX2lkOiAnLCAkc2NvcGUuY3VycmVudFVzZXIuX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzdGF0ZS5jdXJyZW50Lm5hbWUgPT0gJ2hvbWUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ3BwYWdlJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogJHNjb3BlLmN1cnJlbnRVc2VyLl9pZFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgZXJyID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3VzZXIgaXMgbm90IGxvZ2dlZCBpbi4nKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSwgZXJyID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZXJyIHdoZW4gbG9nIHVzZXIgaW46ICcsIGVycik7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCckYXV0aC5pc0F1dGhlbnRpY2F0ZWQoKSk6ICcsICRhdXRoLmlzQXV0aGVudGljYXRlZCgpKSk7XG4gICAgaWYgKCRhdXRoLmlzQXV0aGVudGljYXRlZCgpKSB7XG4gICAgICAgIEFjY291bnQuZ2V0Q3VycmVudFVzZXIoKS50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAkc2NvcGUuY3VycmVudFVzZXIgPSByZXMuZGF0YTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCduYXZDdHJsIHRyaWdnZXJlZCBhbmQgY3VycmVudFVzZXI6ICcsICRzY29wZS5jdXJyZW50VXNlcik7XG4gICAgICAgIH0sIGVyciA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygndXNlciBpcyBub3QgbG9nZ2VkIGluLicpO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgICRzY29wZS5pc0F1dGhlbnRpY2F0ZWQgPSAoKSA9PiB7XG4gICAgICAgIHJldHVybiAkYXV0aC5pc0F1dGhlbnRpY2F0ZWQoKTtcbiAgICB9XG5cbiAgICAkc2NvcGUubG9nb3V0ID0gKCkgPT4ge1xuICAgICAgICAkc2NvcGUubG9nb3V0bG9hZGluZyA9IHRydWU7XG4gICAgICAgICRhdXRoLmxvZ291dCgpO1xuICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRzY29wZS5sb2dvdXRsb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAvLyAkc3RhdGUuZ28oJ2hvbWUnKTtcbiAgICAgICAgICAgICR3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICAgIH0sIDApXG4gICAgfVxuXG4gICAgJHNjb3BlLmdvcHBhZ2UgPSAoKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCckbG9jYXRpb24uJCRwYXRoOiAnLCAkbG9jYXRpb24uJCRwYXRoKTtcbiAgICAgICAgaWYgKCRsb2NhdGlvbi4kJHBhdGguaW5jbHVkZXMoJ3Byb2plY3RzJykpIHtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdzdGF5IG9uIHRoZSBwYWdlLCBvciByZWZyZXNoIHRoZSBwYWdlJylcbiAgICAgICAgICAgICR3aW5kb3cubG9jYXRpb24ucmVsb2FkKClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygncHBhZ2UnLCB7XG4gICAgICAgICAgICAgICAgdXNlcklkOiAkc2NvcGUuY3VycmVudFVzZXIuX2lkXG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgJHNjb3BlLmNyZWF0ZSA9ICgpID0+IHtcbiAgICAgICAgJHNjb3BlLnByb2plY3RJbml0YWxpemluZyA9IGZhbHNlO1xuICAgICAgICAkc2NvcGUubmV3UHJvamVjdE5hbWUgPSAnJztcbiAgICAgICAgJHNjb3BlLm5ld1Byb2plY3RQaXRjaCA9ICcnO1xuICAgICAgICAkc2NvcGUuY3JlYXRlTW9kYWwgPSB0cnVlO1xuICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGZvY3VzKCdmb2N1c01lJyk7XG4gICAgICAgIH0sIDEwMClcbiAgICB9XG4gICAgJHNjb3BlLmNyZWF0ZVByb2plY3QgPSAoKSA9PiB7XG4gICAgICAgICRzY29wZS5wcm9qZWN0SW5pdGFsaXppbmcgPSB0cnVlO1xuICAgICAgICBjb25zb2xlLmxvZygnY3JlYXRlIHByb2plY3QgY2FsbGVkOiAnLCAkc2NvcGUubmV3UHJvamVjdE5hbWUpO1xuICAgICAgICB2YXIgbmV3UG9qZWN0T2JqID0ge1xuICAgICAgICAgICAgdGl0bGU6ICRzY29wZS5uZXdQcm9qZWN0TmFtZSxcbiAgICAgICAgICAgIHBpdGNoOiAkc2NvcGUubmV3UHJvamVjdFBpdGNoXG4gICAgICAgIH1cbiAgICAgICAgUHJvamVjdC5jcmVhdGVPbmUobmV3UG9qZWN0T2JqKS50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnYWRkIG5ldyBiZWhhdmlvcltjcmVhdGVOZXdQcm9qZWN0XTogJywgcmVzLmRhdGEpO1xuICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnByb2plY3RJbml0YWxpemluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICRzY29wZS5jcmVhdGVNb2RhbCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmICgkc3RhdGUuY3VycmVudC5uYW1lID09ICdwcGFnZScpIHtcbiAgICAgICAgICAgICAgICAgICAgJHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ3BwYWdlJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiAkc2NvcGUuY3VycmVudFVzZXIuX2lkXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIE1hdGgucmFuZG9tKCkgKiAxNTAwICsgMzAwKTtcbiAgICAgICAgfSwgZXJyID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnIgd2hlbiBjcmVhdGUgcHJvamVjdDogJywgZXJyKTtcbiAgICAgICAgfSlcbiAgICB9XG59XG4iLCIndXNlIHN0cmljdCc7XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdwaW5jaEFwcCcpXG4gICAgLmRpcmVjdGl2ZSgnZm9jdXNPbicsIGZvY3VzT24pXG5cbmZ1bmN0aW9uIGZvY3VzT24oKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBlbGVtLCBhdHRyKSB7XG4gICAgICAgIHNjb3BlLiRvbignZm9jdXNPbicsIGZ1bmN0aW9uKGUsIG5hbWUpIHtcbiAgICAgICAgICAgIGlmIChuYW1lID09PSBhdHRyLmZvY3VzT24pIHtcbiAgICAgICAgICAgICAgICBlbGVtWzBdLmZvY3VzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG59XG4iLCIndXNlIHN0cmljdCc7XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdwaW5jaEFwcCcpXG4gICAgLmRpcmVjdGl2ZSgndG9vbFRpcCcsIHRvb2xUaXApXG5cbmZ1bmN0aW9uIHRvb2xUaXAoKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgICBhbmd1bGFyLmVsZW1lbnQoJy50b29sLXRpcCcpLm9uKCdjbGljayBtb3VzZWxlYXZlJywgaGlkZVRvb2x0aXApO1xuICAgICAgICBhbmd1bGFyLmVsZW1lbnQoJy50b29sLXRpcCcpLm9uKCdtb3VzZWVudGVyJywgc2hvd1Rvb2x0aXApO1xuICAgIH07XG59XG5cbmZ1bmN0aW9uIGhpZGVUb29sdGlwKCkge1xuICAgICQodGhpcykudG9vbHRpcCgnaGlkZScpO1xufVxuXG5mdW5jdGlvbiBzaG93VG9vbHRpcCgpIHtcbiAgICAkKHRoaXMpLnRvb2x0aXAoJ3Nob3cnKTtcbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
