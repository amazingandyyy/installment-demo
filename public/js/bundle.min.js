"use strict";function init(){sticky(),windowScrollDown()}function sticky(){$(".singlePlanPreviewSticky").sticky({topSpacing:80})}function windowScrollDown(){var a,e=0;$(window).scroll(function(){a=$(this).scrollTop(),$(window).scrollTop()>30&&(e>a?($(".home-page nav").removeClass("folded"),$(".home-page nav").css("border-bottom","0px solid")):$(".home-page nav").addClass("folded")),e=a,$(window).scrollTop()<10&&$(".home-page nav").addClass("top"),$(window).scrollTop()>10&&$(".home-page nav").removeClass("top"),$(window).scrollTop()>30,$(window).scrollTop()<540&&$(".home-page nav").css("box-shadow","inset 0 -1px 0px 0px rgba(0,0,0,0)"),$(window).scrollTop()>540&&$(".home-page nav").css("box-shadow","inset 0 -1px 0px 0px rgba(0,0,0,0.1)")})}function Account(a){this.getCurrentUser=function(){return a({method:"GET",url:"/api/auth/currentUser"})},this.sendVerifyCode=function(e){return a({method:"POST",url:"/api/verify/phone",data:e})},this.verifyCode=function(e){return a({method:"PUT",url:"/api/verify/phone",data:e})},this.getUserData=function(e){return a({method:"GET",url:"/api/users/"+e})},this.updateUserData=function(e,n){return a({method:"PUT",url:"/api/users/"+e,data:n})}}function Payment(a){this.chargeNow=function(e){return a({method:"POST",url:"/api/payment/chargeNow",data:e})}}function focus(a,e){return function(n){e(function(){a.$broadcast("focusOn",n)},0)}}function Plan(a,e,n){this.addSinglePreview=function(e){return a(function(a,n){localStorage.planPreviewData=JSON.stringify(e),a(localStorage.planPreviewData)})},this.getSinglePreview=function(){return a(function(a,e){a(JSON.parse(localStorage.planPreviewData))})},this.saveSinglePlan=function(a){return n({method:"POST",url:"/api/plans/saveSinglePlan",data:a})},this.getSinglePlan=function(a){return n({method:"GET",url:"/api/plans/getSinglePlan/"+a})}}function Storage(a){this.get=function(){},this.save=function(a){console.log("obj: ",a)}}function homeCtrl(a,e,n,t,o,r,l){function s(){e.getToken()?t.getCurrentUser(e.getToken()).then(function(a){console.log("@CurrentUser: ",a.data),r.currentUser=a.data},function(a){return n.go("authEntrance")}):!e.getToken()&&l.$$path.includes("dashboard")&&n.go("authEntrance")}r.$on("$stateChangeSuccess",function(e,t,o,d,i){r.previousState=d.name,r.currentState=t.name,console.log(r.previousState," >>> ",r.currentState),"authEntrance"==r.currentState&&a.currentUser&&n.go("dashboard"),a.currentUrl=l.$$path,s()})}function authCtrl(a,e,n,t,o,r){a.auth_enter=function(a){e.signup(a).then(function(a){e.setToken(a),n.go("dashboard",{},{reload:!0}),console.log("res @auth_enter: ",a.data)},function(a){return console.log("err @auth_enter: ",a)})},a.authenticate=function(a){e.authenticate(a)}}function dashboardCtrl(a,e,n,t,o,r,l){a.logout=function(){console.log("check"),e.logout(),a.currentUser=null,n.go("landing",{},{reload:!0}),l.location.reload()},a.sendVerifyCode=function(e){if(console.log("phone: ",e),e.length>5){var n={userData:o.currentUser,phone:e};console.log("userObj: ",n),t.sendVerifyCode(n).then(function(n){console.log("res @sendVerifyCode: ",n.data),o.currentUser.phone.data=e,a.verifyPhoneSentOut=!0},function(a){console.log("err @sendVerifyCode: ",a)})}},a.verifyCode=function(a){if(console.log("code: ",a),0!==a.length){var e={userData:o.currentUser,code:a};t.verifyCode(e).then(function(a){console.log("res @verifyCode: ",a.data),a.data.msg?"incorrect"==a.data.msg?console.log("err: incorrect"):(a.data.msg="expired")&&console.log("err: expired"):o.currentUser.phone.verified=!0},function(a){console.log("err @verifyCode: ",a)})}},a.doCheckout=function(a){console.log("fff"),console.log("token: ",a);var e={stripeToken:a,userData:o.currentUser};r.chargeNow(e).then(function(a){console.log("res: ",a.data)},function(a){console.log("err: ",a)})}}function dashboardPlanCtrl(a,e,n,t,o,r){console.log("dashboardPlanCtrl loaded"),"dashboard_plan_single"==r.currentState&&(a.updateTimes=function(e){a.installmentsGraphData=[];for(var n=0;e>n;n++){var t=~~(a.plan.total/e),o=~~(200*(2/e));a.installmentsGraphData.push({price:t,style:{height:o+"px",width:"90%"}})}},a.defaultPlanTimes=function(e){return e?a.plan:a.plan.times=3},a.previewSinglePlan=function(a){console.log("plan: ",a),o.addSinglePreview(a).then(function(a){t.go("dashboard_plan_single_preview")},function(a){return console.log("err @addSinglePreview: ",a)})},a.plan={},a.singlePayment=function(){return(a.plan.total-a.plan.downpay)/a.plan.times},a.intervalSelected=function(e){a.plan.interval==e?a.plan.interval=null:a.plan.interval=e}),"dashboard_plan_single_preview"==r.currentState&&(o.getSinglePreview().then(function(e){console.log("res @getSinglePreview: ",e),a.planPreview=e,a.planPreview.installment=(e.total-e.downpay)/e.times},function(a){return console.log("err @getSinglePreview: ",a)}),a.saveSinglePlan=function(a){console.log(a);var e={planDetails:a,creator:r.currentUser};console.log("saveSinglePlanInfo: ",e),o.saveSinglePlan(e).then(function(a){console.log("res @saveSinglePlan: ",a.data),t.go("dashboard_plan_details",{planId:a.data._id},{reload:!0})},function(a){return console.log("err @saveSinglePlan: ",a)})},a.dashboard_plan_single_preview_goback=function(a){"dashboard_plan_details_edit"==r.previousState?t.go("dashboard_plan_details_edit",{planId:a._id}):"dashboard_plan_single"==r.previousState&&t.go("dashboard_plan_single")}),a.getAllPlans=function(){var a=r.currentUser._id;console.log("currentUserId: ",a)},"dashboard_plan_details"==r.currentState&&o.getSinglePlan(t.params.planId).then(function(e){console.log("res @getSinglePlan: ",e.data),a.plan=e.data.data,a.planId=e.data._id,a.itCreator=function(){return e.data.creator.includes(r.currentUser._id)}},function(a){return console.log("err @getSinglePlan: ",a)}),"dashboard_plan_details_edit"==r.currentState&&(console.log(t.params.planId),o.getSinglePlan(t.params.planId).then(function(e){e.data.creator.includes(r.currentUser._id)||t.go("dashboard"),console.log("res @getSinglePlan: ",e.data),a.plan=e.data.data,a.plan._id=e.data._id,a.itCreator=function(){return e.data.creator.includes(r.currentUser._id)},a.updateTimes=function(e){a.installmentsGraphData=[];for(var n=0;e>n;n++){var t=~~(a.plan.total/e),o=~~(200*(2/e));a.installmentsGraphData.push({price:t,style:{height:o+"px",width:"90%"}})}},a.defaultPlanTimes=function(e){return e?a.plan:a.plan.times=3},a.previewSinglePlan=function(a){o.addSinglePreview(a).then(function(a){t.go("dashboard_plan_single_preview")},function(a){return console.log("err @addSinglePreview: ",a)})},a.singlePayment=function(){return(a.plan.total-a.plan.downpay)/a.plan.times},a.intervalSelected=function(e){a.plan.interval==e?a.plan.interval=null:a.plan.interval=e}},function(a){return console.log("err @getSinglePlan: ",a)}))}function focusOn(){return function(a,e,n){a.$on("focusOn",function(a,t){t===n.focusOn&&e[0].focus()})}}function toolTip(){return function(a,e,n){angular.element(".tool-tip").on("click mouseleave",hideTooltip),angular.element(".tool-tip").on("mouseenter",showTooltip)}}function hideTooltip(){$(this).tooltip("hide")}function showTooltip(){$(this).tooltip("show")}angular.module("pinchApp",["ui.router","satellizer","ngAnimate","ngFileUpload","ngImgCrop","stripe.checkout","angular-loading-bar","anim-in-out"]).config(["$stateProvider","$urlRouterProvider","$authProvider",function(a,e,n){Stripe.setPublishableKey("pk_test_t1eThhOKl6esrp6f4jyWqU4J"),a.state(landing).state(authEntrance).state(dashboard).state(dashboard_payment).state(dashboard_plan).state(dashboard_plan_start).state(dashboard_plan_details).state(dashboard_plan_details_edit).state(dashboard_plan_choose).state(dashboard_plan_single).state(dashboard_plan_single_preview).state(dashboard_plan_multiple).state(dashboard_account),e.otherwise("/")}]);var landing={name:"landing",url:"/",views:{main:{templateUrl:"/html/landing.html",controller:"authCtrl"}}},authEntrance={name:"authEntrance",url:"/entrance",views:{main:{templateUrl:"/html/entrance.html",controller:"authCtrl"}}},dashboard={name:"dashboard",url:"/dashboard",views:{main:{templateUrl:"/html/dashboard.html",controller:"dashboardCtrl"}}},dashboard_payment={name:"dashboard_payment",url:"/payment",parent:"dashboard",views:{dashboard_section:{templateUrl:"/html/dashboard_payment.html",controller:"dashboardCtrl"}}},dashboard_plan={name:"dashboard_plan",url:"/plan",parent:"dashboard",views:{dashboard_section:{templateUrl:"/html/dashboard_plan.html",controller:"dashboardCtrl"}}},dashboard_plan_start={name:"dashboard_plan_start",url:"/start",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_start.html",controller:"dashboardCtrl"}}},dashboard_plan_details={name:"dashboard_plan_details",url:"/details/:planId",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_details.html",controller:"dashboardPlanCtrl"}}},dashboard_plan_details_edit={name:"dashboard_plan_details_edit",url:"/details/:planId/edit",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_details_edit.html",controller:"dashboardPlanCtrl"}}},dashboard_plan_choose={name:"dashboard_plan_choose",url:"/choose",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_choose.html",controller:"dashboardCtrl"}}},dashboard_plan_single={name:"dashboard_plan_single",url:"/choose/single",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_single.html",controller:"dashboardPlanCtrl"}}},dashboard_plan_single_preview={name:"dashboard_plan_single_preview",url:"/choose/single/preview",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_single_preview.html",controller:"dashboardPlanCtrl"}}},dashboard_plan_multiple={name:"dashboard_plan_multiple",url:"/choose/mutiple",parent:"dashboard_plan",views:{dashboard_child_section:{templateUrl:"/html/dashboard/dashboard_plan_multiple.html",controller:"dashboardCtrl"}}},dashboard_account={name:"dashboard_account",url:"/account",parent:"dashboard",views:{dashboard_section:{templateUrl:"/html/dashboard_account.html",controller:"dashboardCtrl"}}};$(document).ready(init),Account.$inject=["$http"],Payment.$inject=["$http"],focus.$inject=["$rootScope","$timeout"],Plan.$inject=["$q","Storage","$http"],Storage.$inject=["$q"],angular.module("pinchApp").service("Account",Account).service("Payment",Payment).factory("focus",focus).service("Plan",Plan).service("Storage",Storage),homeCtrl.$inject=["$scope","$auth","$state","Account","$window","$rootScope","$location"],authCtrl.$inject=["$scope","$auth","$state","Account","$window","$rootScope"],dashboardCtrl.$inject=["$scope","$auth","$state","Account","$rootScope","Payment","$window"],dashboardPlanCtrl.$inject=["$scope","Account","$stateParams","$state","Plan","$rootScope"],angular.module("pinchApp").controller("homeCtrl",homeCtrl).controller("authCtrl",authCtrl).controller("dashboardCtrl",dashboardCtrl).controller("dashboardPlanCtrl",dashboardPlanCtrl),angular.module("pinchApp").directive("focusOn",focusOn),angular.module("pinchApp").directive("toolTip",toolTip);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFtb2R1bGUuanMiLCJtYWluLmpzIiwic2VydmljZXMuanMiLCJjb250cm9sbGVycy9jb250cm9sbGVycy5qcyIsImRpcmVjdGl2ZXMvZm9jdXNPbi5kaXJlY3RpdmUuanMiLCJkaXJlY3RpdmVzL3Rvb2xUaXAuZGlyZWN0aXZlLmpzIl0sIm5hbWVzIjpbImluaXQiLCJzdGlja3kiLCJ3aW5kb3dTY3JvbGxEb3duIiwiJCIsInRvcFNwYWNpbmciLCJzdCIsImxhc3RTY3JvbGxUb3AiLCJ3aW5kb3ciLCJzY3JvbGwiLCJ0aGlzIiwic2Nyb2xsVG9wIiwicmVtb3ZlQ2xhc3MiLCJjc3MiLCJhZGRDbGFzcyIsIkFjY291bnQiLCIkaHR0cCIsImdldEN1cnJlbnRVc2VyIiwibWV0aG9kIiwidXJsIiwic2VuZFZlcmlmeUNvZGUiLCJ1c2VyT2JqIiwiZGF0YSIsInZlcmlmeUNvZGUiLCJnZXRVc2VyRGF0YSIsInVyaVVzZXJJZCIsInVwZGF0ZVVzZXJEYXRhIiwiUGF5bWVudCIsImNoYXJnZU5vdyIsImRhdGFPYmoiLCJmb2N1cyIsIiRyb290U2NvcGUiLCIkdGltZW91dCIsIm5hbWUiLCIkYnJvYWRjYXN0IiwiUGxhbiIsIiRxIiwiU3RvcmFnZSIsImFkZFNpbmdsZVByZXZpZXciLCJwbGFuIiwicmVzIiwicmVxIiwibG9jYWxTdG9yYWdlIiwicGxhblByZXZpZXdEYXRhIiwiSlNPTiIsInN0cmluZ2lmeSIsImdldFNpbmdsZVByZXZpZXciLCJyZWoiLCJwYXJzZSIsInNhdmVTaW5nbGVQbGFuIiwiZ2V0U2luZ2xlUGxhbiIsInBsYW5JZCIsImdldCIsInNhdmUiLCJvYmoiLCJjb25zb2xlIiwibG9nIiwiaG9tZUN0cmwiLCIkc2NvcGUiLCIkYXV0aCIsIiRzdGF0ZSIsIiR3aW5kb3ciLCIkbG9jYXRpb24iLCJnZXRUb2tlbiIsInRoZW4iLCJjdXJyZW50VXNlciIsImVyciIsImdvIiwiJCRwYXRoIiwiaW5jbHVkZXMiLCIkb24iLCJldiIsInRvIiwidG9QYXJhbXMiLCJmcm9tIiwiZnJvbVBhcmFtcyIsInByZXZpb3VzU3RhdGUiLCJjdXJyZW50U3RhdGUiLCJjdXJyZW50VXJsIiwiYXV0aEN0cmwiLCJhdXRoX2VudGVyIiwiYXV0aERhdGEiLCJzaWdudXAiLCJzZXRUb2tlbiIsInJlbG9hZCIsImF1dGhlbnRpY2F0ZSIsInByb3ZpZGVyIiwiZGFzaGJvYXJkQ3RybCIsImxvZ291dCIsImxvY2F0aW9uIiwicGhvbmUiLCJsZW5ndGgiLCJ1c2VyRGF0YSIsInZlcmlmeVBob25lU2VudE91dCIsImNvZGUiLCJtc2ciLCJ2ZXJpZmllZCIsImRvQ2hlY2tvdXQiLCJ0b2tlbiIsInN0cmlwZVRva2VuIiwiZGFzaGJvYXJkUGxhbkN0cmwiLCIkc3RhdGVQYXJhbXMiLCJ1cGRhdGVUaW1lcyIsInRpbWVzIiwiaW5zdGFsbG1lbnRzR3JhcGhEYXRhIiwiaSIsImluc3RhbGxtZW50IiwidG90YWwiLCJoZWlnaHQiLCJwdXNoIiwicHJpY2UiLCJzdHlsZSIsIndpZHRoIiwiZGVmYXVsdFBsYW5UaW1lcyIsInByZXZpZXdTaW5nbGVQbGFuIiwic2luZ2xlUGF5bWVudCIsImRvd25wYXkiLCJpbnRlcnZhbFNlbGVjdGVkIiwiY2hvaWNlIiwiaW50ZXJ2YWwiLCJwbGFuUHJldmlldyIsInNhdmVTaW5nbGVQbGFuSW5mbyIsInBsYW5EZXRhaWxzIiwiY3JlYXRvciIsIl9pZCIsImRhc2hib2FyZF9wbGFuX3NpbmdsZV9wcmV2aWV3X2dvYmFjayIsImdldEFsbFBsYW5zIiwiY3VycmVudFVzZXJJZCIsInBhcmFtcyIsIml0Q3JlYXRvciIsImZvY3VzT24iLCJzY29wZSIsImVsZW0iLCJhdHRyIiwiZSIsInRvb2xUaXAiLCJlbGVtZW50IiwiYXR0cnMiLCJhbmd1bGFyIiwib24iLCJoaWRlVG9vbHRpcCIsInNob3dUb29sdGlwIiwidG9vbHRpcCIsIm1vZHVsZSIsImNvbmZpZyIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwiJGF1dGhQcm92aWRlciIsIlN0cmlwZSIsInNldFB1Ymxpc2hhYmxlS2V5Iiwic3RhdGUiLCJsYW5kaW5nIiwiYXV0aEVudHJhbmNlIiwiZGFzaGJvYXJkIiwiZGFzaGJvYXJkX3BheW1lbnQiLCJkYXNoYm9hcmRfcGxhbiIsImRhc2hib2FyZF9wbGFuX3N0YXJ0IiwiZGFzaGJvYXJkX3BsYW5fZGV0YWlscyIsImRhc2hib2FyZF9wbGFuX2RldGFpbHNfZWRpdCIsImRhc2hib2FyZF9wbGFuX2Nob29zZSIsImRhc2hib2FyZF9wbGFuX3NpbmdsZSIsImRhc2hib2FyZF9wbGFuX3NpbmdsZV9wcmV2aWV3IiwiZGFzaGJvYXJkX3BsYW5fbXVsdGlwbGUiLCJkYXNoYm9hcmRfYWNjb3VudCIsIm90aGVyd2lzZSIsInZpZXdzIiwibWFpbiIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsInBhcmVudCIsImRhc2hib2FyZF9zZWN0aW9uIiwiZGFzaGJvYXJkX2NoaWxkX3NlY3Rpb24iLCJkb2N1bWVudCIsInJlYWR5IiwiJGluamVjdCIsInNlcnZpY2UiLCJmYWN0b3J5IiwiZGlyZWN0aXZlIl0sIm1hcHBpbmdzIjoiQUFBQSxZQ0lBLFNBQVNBLFFBQ0xDLFNBQ0FDLG1CQUdKLFFBQVNELFVBQ0xFLEVBQUUsNEJBQTRCRixRQUMxQkcsV0FBWSxLQUlwQixRQUFTRixvQkFDTCxHQUNJRyxHQURBQyxFQUFnQixDQUVwQkgsR0FBRUksUUFBUUMsT0FBTyxXQUViSCxFQUFLRixFQUFFTSxNQUFNQyxZQUNWUCxFQUFFSSxRQUFRRyxZQUFjLEtBQ2RKLEVBQUxELEdBQ0FGLEVBQUUsa0JBQWtCUSxZQUFZLFVBQ2hDUixFQUFFLGtCQUFrQlMsSUFBSSxnQkFBaUIsY0FFekNULEVBQUUsa0JBQWtCVSxTQUFTLFdBR3JDUCxFQUFnQkQsRUFFWkYsRUFBRUksUUFBUUcsWUFBYyxJQUN4QlAsRUFBRSxrQkFBa0JVLFNBQVMsT0FFN0JWLEVBQUVJLFFBQVFHLFlBQWMsSUFDeEJQLEVBQUUsa0JBQWtCUSxZQUFZLE9BRWhDUixFQUFFSSxRQUFRRyxZQUFj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QVcxQyIsImZpbGUiOiJidW5kbGUubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5hbmd1bGFyXG4gICAgLm1vZHVsZSgncGluY2hBcHAnLCBbXG4gICAgICAgICd1aS5yb3V0ZXInLFxuICAgICAgICAnc2F0ZWxsaXplcicsXG4gICAgICAgICduZ0FuaW1hdGUnLFxuICAgICAgICAvLyAndWkuYm9vdHN0cmFwJyxcbiAgICAgICAgJ25nRmlsZVVwbG9hZCcsXG4gICAgICAgICduZ0ltZ0Nyb3AnLFxuICAgICAgICAnc3RyaXBlLmNoZWNrb3V0JyxcbiAgICAgICAgJ2FuZ3VsYXItbG9hZGluZy1iYXInLFxuICAgICAgICAnYW5pbS1pbi1vdXQnXG4gICAgXSlcbiAgICAuY29uZmlnKGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIsICRhdXRoUHJvdmlkZXIpIHtcbiAgICAgICAgU3RyaXBlLnNldFB1Ymxpc2hhYmxlS2V5KCdwa190ZXN0X3QxZVRoaE9LbDZlc3JwNmY0anlXcVU0SicpXG5cbiAgICAgICAgLy8gJGF1dGhQcm92aWRlclxuICAgICAgICAvLyAgICAgLmZhY2Vib29rKHtcbiAgICAgICAgLy8gICAgICAgICBjbGllbnRJZDogJzI5ODE2NTExMzg0OTM2NidcbiAgICAgICAgLy8gICAgIH0pO1xuXG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUobGFuZGluZylcbiAgICAgICAgICAgIC5zdGF0ZShhdXRoRW50cmFuY2UpXG4gICAgICAgICAgICAuc3RhdGUoZGFzaGJvYXJkKVxuICAgICAgICAgICAgLnN0YXRlKGRhc2hib2FyZF9wYXltZW50KVxuICAgICAgICAgICAgLnN0YXRlKGRhc2hib2FyZF9wbGFuKVxuICAgICAgICAgICAgLnN0YXRlKGRhc2hib2FyZF9wbGFuX3N0YXJ0KVxuICAgICAgICAgICAgLnN0YXRlKGRhc2hib2FyZF9wbGFuX2RldGFpbHMpXG4gICAgICAgICAgICAuc3RhdGUoZGFzaGJvYXJkX3BsYW5fZGV0YWlsc19lZGl0KVxuICAgICAgICAgICAgLnN0YXRlKGRhc2hib2FyZF9wbGFuX2Nob29zZSlcbiAgICAgICAgICAgIC5zdGF0ZShkYXNoYm9hcmRfcGxhbl9zaW5nbGUpXG4gICAgICAgICAgICAuc3RhdGUoZGFzaGJvYXJkX3BsYW5fc2luZ2xlX3ByZXZpZXcpXG4gICAgICAgICAgICAuc3RhdGUoZGFzaGJvYXJkX3BsYW5fbXVsdGlwbGUpXG4gICAgICAgICAgICAuc3RhdGUoZGFzaGJvYXJkX2FjY291bnQpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHBhZ2UpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHBhZ2VfcHJvamVjdHMpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHBhZ2VfbGlrZWQpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHBhZ2VfZm9sbG93ZXJzKVxuICAgICAgICAgICAgLy8gLnN0YXRlKHByb2plY3RwYWdlKVxuICAgICAgICAgICAgLy8gLnN0YXRlKHByb2plY3RTZXR0aW5nKVxuICAgICAgICAgICAgLy8gLnN0YXRlKHByb2plY3RTZXR0aW5nX2dlbmVyYWwpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHJvamVjdFNldHRpbmdfcmVxdWVzdClcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcm9qZWN0U2V0dGluZ19wcml2YWN5KVxuICAgICAgICAgICAgLy8gLnN0YXRlKHByb2plY3RTZXR0aW5nX2RhbmdlcilcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcm9maWxlU2V0dGluZylcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcm9maWxlU2V0dGluZ19nZW5lcmFsKVxuICAgICAgICAgICAgLy8gLnN0YXRlKHByb2ZpbGVTZXR0aW5nX3JlcXVlc3QpXG4gICAgICAgICAgICAvLyAuc3RhdGUocHJvZmlsZVNldHRpbmdfcHJpdmFjeSlcbiAgICAgICAgICAgIC8vIC5zdGF0ZShwcm9maWxlU2V0dGluZ19kYW5nZXIpXG5cblxuICAgICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvJyk7XG4gICAgfSk7XG5cblxubGV0IGxhbmRpbmcgPSB7XG4gICAgbmFtZTogJ2xhbmRpbmcnLFxuICAgIHVybDogJy8nLFxuICAgIHZpZXdzOiB7XG4gICAgICAgIG1haW46IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvbGFuZGluZy5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdhdXRoQ3RybCdcbiAgICAgICAgfVxuICAgIH1cbn1cbmxldCBhdXRoRW50cmFuY2UgPSB7XG4gICAgbmFtZTogJ2F1dGhFbnRyYW5jZScsXG4gICAgdXJsOiAnL2VudHJhbmNlJyxcbiAgICB2aWV3czoge1xuICAgICAgICBtYWluOiB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL2VudHJhbmNlLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2F1dGhDdHJsJ1xuICAgICAgICB9XG4gICAgfVxufVxubGV0IGRhc2hib2FyZCA9IHtcbiAgICBuYW1lOiAnZGFzaGJvYXJkJyxcbiAgICB1cmw6ICcvZGFzaGJvYXJkJyxcbiAgICB2aWV3czoge1xuICAgICAgICBtYWluOiB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL2Rhc2hib2FyZC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdkYXNoYm9hcmRDdHJsJ1xuICAgICAgICB9XG4gICAgfVxufVxuXG5sZXQgZGFzaGJvYXJkX3BheW1lbnQgPSB7XG4gICAgbmFtZTogJ2Rhc2hib2FyZF9wYXltZW50JyxcbiAgICB1cmw6ICcvcGF5bWVudCcsXG4gICAgcGFyZW50OiAnZGFzaGJvYXJkJyxcbiAgICB2aWV3czoge1xuICAgICAgICBkYXNoYm9hcmRfc2VjdGlvbjoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9kYXNoYm9hcmRfcGF5bWVudC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdkYXNoYm9hcmRDdHJsJ1xuICAgICAgICB9XG4gICAgfVxufVxubGV0IGRhc2hib2FyZF9wbGFuID0ge1xuICAgIG5hbWU6ICdkYXNoYm9hcmRfcGxhbicsXG4gICAgdXJsOiAnL3BsYW4nLFxuICAgIHBhcmVudDogJ2Rhc2hib2FyZCcsXG4gICAgdmlld3M6IHtcbiAgICAgICAgZGFzaGJvYXJkX3NlY3Rpb246IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvZGFzaGJvYXJkX3BsYW4uaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnZGFzaGJvYXJkQ3RybCdcbiAgICAgICAgfVxuICAgIH1cbn1cbmxldCBkYXNoYm9hcmRfcGxhbl9zdGFydCA9IHtcbiAgICBuYW1lOiAnZGFzaGJvYXJkX3BsYW5fc3RhcnQnLFxuICAgIHVybDogJy9zdGFydCcsXG4gICAgcGFyZW50OiAnZGFzaGJvYXJkX3BsYW4nLFxuICAgIHZpZXdzOiB7XG4gICAgICAgIGRhc2hib2FyZF9jaGlsZF9zZWN0aW9uOiB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL2Rhc2hib2FyZC9kYXNoYm9hcmRfcGxhbl9zdGFydC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdkYXNoYm9hcmRDdHJsJ1xuICAgICAgICB9XG4gICAgfVxufVxubGV0IGRhc2hib2FyZF9wbGFuX2RldGFpbHMgPSB7XG4gICAgbmFtZTogJ2Rhc2hib2FyZF9wbGFuX2RldGFpbHMnLFxuICAgIHVybDogJy9kZXRhaWxzLzpwbGFuSWQnLFxuICAgIHBhcmVudDogJ2Rhc2hib2FyZF9wbGFuJyxcbiAgICB2aWV3czoge1xuICAgICAgICBkYXNoYm9hcmRfY2hpbGRfc2VjdGlvbjoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9kYXNoYm9hcmQvZGFzaGJvYXJkX3BsYW5fZGV0YWlscy5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdkYXNoYm9hcmRQbGFuQ3RybCdcbiAgICAgICAgfVxuICAgIH1cbn1cbmxldCBkYXNoYm9hcmRfcGxhbl9kZXRhaWxzX2VkaXQgPSB7XG4gICAgbmFtZTogJ2Rhc2hib2FyZF9wbGFuX2RldGFpbHNfZWRpdCcsXG4gICAgdXJsOiAnL2RldGFpbHMvOnBsYW5JZC9lZGl0JyxcbiAgICBwYXJlbnQ6ICdkYXNoYm9hcmRfcGxhbicsXG4gICAgdmlld3M6IHtcbiAgICAgICAgZGFzaGJvYXJkX2NoaWxkX3NlY3Rpb246IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvZGFzaGJvYXJkL2Rhc2hib2FyZF9wbGFuX2RldGFpbHNfZWRpdC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdkYXNoYm9hcmRQbGFuQ3RybCdcbiAgICAgICAgfVxuICAgIH1cbn1cbmxldCBkYXNoYm9hcmRfcGxhbl9jaG9vc2UgPSB7XG4gICAgbmFtZTogJ2Rhc2hib2FyZF9wbGFuX2Nob29zZScsXG4gICAgdXJsOiAnL2Nob29zZScsXG4gICAgcGFyZW50OiAnZGFzaGJvYXJkX3BsYW4nLFxuICAgIHZpZXdzOiB7XG4gICAgICAgIGRhc2hib2FyZF9jaGlsZF9zZWN0aW9uOiB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL2Rhc2hib2FyZC9kYXNoYm9hcmRfcGxhbl9jaG9vc2UuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnZGFzaGJvYXJkQ3RybCdcbiAgICAgICAgfVxuICAgIH1cbn1cbmxldCBkYXNoYm9hcmRfcGxhbl9zaW5nbGUgPSB7XG4gICAgbmFtZTogJ2Rhc2hib2FyZF9wbGFuX3NpbmdsZScsXG4gICAgdXJsOiAnL2Nob29zZS9zaW5nbGUnLFxuICAgIHBhcmVudDogJ2Rhc2hib2FyZF9wbGFuJyxcbiAgICB2aWV3czoge1xuICAgICAgICBkYXNoYm9hcmRfY2hpbGRfc2VjdGlvbjoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9kYXNoYm9hcmQvZGFzaGJvYXJkX3BsYW5fc2luZ2xlLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2Rhc2hib2FyZFBsYW5DdHJsJ1xuICAgICAgICB9XG4gICAgfVxufVxubGV0IGRhc2hib2FyZF9wbGFuX3NpbmdsZV9wcmV2aWV3ID0ge1xuICAgIG5hbWU6ICdkYXNoYm9hcmRfcGxhbl9zaW5nbGVfcHJldmlldycsXG4gICAgdXJsOiAnL2Nob29zZS9zaW5nbGUvcHJldmlldycsXG4gICAgcGFyZW50OiAnZGFzaGJvYXJkX3BsYW4nLFxuICAgIHZpZXdzOiB7XG4gICAgICAgIGRhc2hib2FyZF9jaGlsZF9zZWN0aW9uOiB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL2Rhc2hib2FyZC9kYXNoYm9hcmRfcGxhbl9zaW5nbGVfcHJldmlldy5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdkYXNoYm9hcmRQbGFuQ3RybCdcbiAgICAgICAgfVxuICAgIH1cbn1cbmxldCBkYXNoYm9hcmRfcGxhbl9tdWx0aXBsZSA9IHtcbiAgICBuYW1lOiAnZGFzaGJvYXJkX3BsYW5fbXVsdGlwbGUnLFxuICAgIHVybDogJy9jaG9vc2UvbXV0aXBsZScsXG4gICAgcGFyZW50OiAnZGFzaGJvYXJkX3BsYW4nLFxuICAgIHZpZXdzOiB7XG4gICAgICAgIGRhc2hib2FyZF9jaGlsZF9zZWN0aW9uOiB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL2Rhc2hib2FyZC9kYXNoYm9hcmRfcGxhbl9tdWx0aXBsZS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdkYXNoYm9hcmRDdHJsJ1xuICAgICAgICB9XG4gICAgfVxufVxubGV0IGRhc2hib2FyZF9hY2NvdW50ID0ge1xuICAgIG5hbWU6ICdkYXNoYm9hcmRfYWNjb3VudCcsXG4gICAgdXJsOiAnL2FjY291bnQnLFxuICAgIHBhcmVudDogJ2Rhc2hib2FyZCcsXG4gICAgdmlld3M6IHtcbiAgICAgICAgZGFzaGJvYXJkX3NlY3Rpb246IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvZGFzaGJvYXJkX2FjY291bnQuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnZGFzaGJvYXJkQ3RybCdcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsIid1c2Ugc3RyaWN0J1xuXG4kKGRvY3VtZW50KS5yZWFkeShpbml0KTtcblxuZnVuY3Rpb24gaW5pdCgpIHtcbiAgICBzdGlja3koKVxuICAgIHdpbmRvd1Njcm9sbERvd24oKVxufVxuXG5mdW5jdGlvbiBzdGlja3koKSB7XG4gICAgJChcIi5zaW5nbGVQbGFuUHJldmlld1N0aWNreVwiKS5zdGlja3koe1xuICAgICAgICB0b3BTcGFjaW5nOiA4MFxuICAgIH0pXG59XG5cbmZ1bmN0aW9uIHdpbmRvd1Njcm9sbERvd24oKSB7XG4gICAgdmFyIGxhc3RTY3JvbGxUb3AgPSAwXG4gICAgdmFyIHN0XG4gICAgJCh3aW5kb3cpLnNjcm9sbChmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJCh3aW5kb3cpLnNjcm9sbFRvcCgpKTtcbiAgICAgICAgc3QgPSAkKHRoaXMpLnNjcm9sbFRvcCgpO1xuICAgICAgICBpZigkKHdpbmRvdykuc2Nyb2xsVG9wKCkgPiAzMCl7XG4gICAgICAgICAgICBpZiAoc3QgPCBsYXN0U2Nyb2xsVG9wKSB7XG4gICAgICAgICAgICAgICAgJCgnLmhvbWUtcGFnZSBuYXYnKS5yZW1vdmVDbGFzcygnZm9sZGVkJylcbiAgICAgICAgICAgICAgICAkKCcuaG9tZS1wYWdlIG5hdicpLmNzcygnYm9yZGVyLWJvdHRvbScsICcwcHggc29saWQnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJCgnLmhvbWUtcGFnZSBuYXYnKS5hZGRDbGFzcygnZm9sZGVkJylcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBsYXN0U2Nyb2xsVG9wID0gc3RcblxuICAgICAgICBpZiAoJCh3aW5kb3cpLnNjcm9sbFRvcCgpIDwgMTApIHtcbiAgICAgICAgICAgICQoJy5ob21lLXBhZ2UgbmF2JykuYWRkQ2xhc3MoJ3RvcCcpXG4gICAgICAgIH1cbiAgICAgICAgaWYgKCQod2luZG93KS5zY3JvbGxUb3AoKSA+IDEwKSB7XG4gICAgICAgICAgICAkKCcuaG9tZS1wYWdlIG5hdicpLnJlbW92ZUNsYXNzKCd0b3AnKVxuICAgICAgICB9XG4gICAgICAgIGlmICgkKHdpbmRvdykuc2Nyb2xsVG9wKCkgPiAzMCkge1xuXG4gICAgICAgIH1cbiAgICAgICAgaWYgKCQod2luZG93KS5zY3JvbGxUb3AoKSA8IDU0MCkge1xuICAgICAgICAgICAgJCgnLmhvbWUtcGFnZSBuYXYnKS5jc3MoJ2JveC1zaGFkb3cnLCAnaW5zZXQgMCAtMXB4IDBweCAwcHggcmdiYSgwLDAsMCwwKScpO1xuICAgICAgICB9XG4gICAgICAgIGlmICgkKHdpbmRvdykuc2Nyb2xsVG9wKCkgPiA1NDApIHtcbiAgICAgICAgICAgICQoJy5ob21lLXBhZ2UgbmF2JykuY3NzKCdib3gtc2hhZG93JywgJ2luc2V0IDAgLTFweCAwcHggMHB4IHJnYmEoMCwwLDAsMC4xKScpO1xuICAgICAgICB9XG5cbiAgICB9KVxufVxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5hbmd1bGFyXG4gICAgLm1vZHVsZSgncGluY2hBcHAnKVxuICAgIC5zZXJ2aWNlKCdBY2NvdW50JywgQWNjb3VudClcbiAgICAuc2VydmljZSgnUGF5bWVudCcsIFBheW1lbnQpXG4gICAgLmZhY3RvcnkoJ2ZvY3VzJywgZm9jdXMpXG4gICAgLnNlcnZpY2UoJ1BsYW4nLCBQbGFuKVxuICAgIC5zZXJ2aWNlKCdTdG9yYWdlJywgU3RvcmFnZSlcblxuZnVuY3Rpb24gQWNjb3VudCgkaHR0cCkge1xuICAgIHRoaXMuZ2V0Q3VycmVudFVzZXIgPSAoKSA9PiB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgdXJsOiBgL2FwaS9hdXRoL2N1cnJlbnRVc2VyYFxuICAgICAgICB9KVxuICAgIH1cbiAgICB0aGlzLnNlbmRWZXJpZnlDb2RlID0gKHVzZXJPYmopID0+IHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgdXJsOiBgL2FwaS92ZXJpZnkvcGhvbmVgLFxuICAgICAgICAgICAgZGF0YTogdXNlck9ialxuICAgICAgICB9KVxuICAgIH1cbiAgICB0aGlzLnZlcmlmeUNvZGUgPSAodXNlck9iaikgPT4ge1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUFVUJyxcbiAgICAgICAgICAgIHVybDogYC9hcGkvdmVyaWZ5L3Bob25lYCxcbiAgICAgICAgICAgIGRhdGE6IHVzZXJPYmpcbiAgICAgICAgfSlcbiAgICB9XG4gICAgdGhpcy5nZXRVc2VyRGF0YSA9ICh1cmlVc2VySWQpID0+IHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICB1cmw6IGAvYXBpL3VzZXJzLyR7dXJpVXNlcklkfWBcbiAgICAgICAgfSlcbiAgICB9XG4gICAgdGhpcy51cGRhdGVVc2VyRGF0YSA9ICh1cmlVc2VySWQsIHVwZGF0ZVVzZXJEYXRhKSA9PiB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdQVVQnLFxuICAgICAgICAgICAgdXJsOiBgL2FwaS91c2Vycy8ke3VyaVVzZXJJZH1gLFxuICAgICAgICAgICAgZGF0YTogdXBkYXRlVXNlckRhdGFcbiAgICAgICAgfSlcbiAgICB9XG59XG5cbmZ1bmN0aW9uIFBheW1lbnQoJGh0dHApIHtcbiAgICB0aGlzLmNoYXJnZU5vdyA9IChkYXRhT2JqKSA9PiB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIHVybDogYC9hcGkvcGF5bWVudC9jaGFyZ2VOb3dgLFxuICAgICAgICAgICAgZGF0YTogZGF0YU9ialxuICAgICAgICB9KVxuICAgIH1cbn1cblxuZnVuY3Rpb24gZm9jdXMoJHJvb3RTY29wZSwgJHRpbWVvdXQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24obmFtZSkge1xuICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnZm9jdXNPbicsIG5hbWUpO1xuICAgICAgICB9LCAwKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIFBsYW4oJHEsIFN0b3JhZ2UsICRodHRwKSB7XG4gICAgdGhpcy5hZGRTaW5nbGVQcmV2aWV3ID0gKHBsYW4pID0+IHtcbiAgICAgICAgcmV0dXJuICRxKChyZXMsIHJlcSkgPT4ge1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnBsYW5QcmV2aWV3RGF0YSA9IEpTT04uc3RyaW5naWZ5KHBsYW4pXG4gICAgICAgICAgICByZXMobG9jYWxTdG9yYWdlLnBsYW5QcmV2aWV3RGF0YSlcbiAgICAgICAgfSlcbiAgICB9XG4gICAgdGhpcy5nZXRTaW5nbGVQcmV2aWV3ID0gKCkgPT4ge1xuICAgICAgICByZXR1cm4gJHEoKHJlcywgcmVqKSA9PiB7XG4gICAgICAgICAgICByZXMoSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UucGxhblByZXZpZXdEYXRhKSlcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICB0aGlzLnNhdmVTaW5nbGVQbGFuID0gKGRhdGEpID0+IHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgdXJsOiBgL2FwaS9wbGFucy9zYXZlU2luZ2xlUGxhbmAsXG4gICAgICAgICAgICBkYXRhOiBkYXRhXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgdGhpcy5nZXRTaW5nbGVQbGFuID0gKHBsYW5JZCkgPT4ge1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgIHVybDogYC9hcGkvcGxhbnMvZ2V0U2luZ2xlUGxhbi8ke3BsYW5JZH1gXG4gICAgICAgIH0pXG4gICAgfVxuXG59XG5cbmZ1bmN0aW9uIFN0b3JhZ2UoJHEpIHtcbiAgICB0aGlzLmdldCA9ICgpID0+IHtcbiAgICAgICAgLy8gcmV0dXJuICRxKChyZXMsIHJlaikgPT4ge1xuICAgICAgICAvLyAgICAgaWYgKCFsb2NhbFN0b3JhZ2Uuc2VwZXJwYXkpIHtcbiAgICAgICAgLy8gICAgICAgICBsb2NhbFN0b3JhZ2Uuc2VwZXJwYXkgPSB7fVxuICAgICAgICAvLyAgICAgICAgIHJlcyhKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5zZXBlcnBheSkpXG4gICAgICAgIC8vICAgICB9IGVsc2UgaWYgKGxvY2FsU3RvcmFnZS5zZXBlcnBheSkge1xuICAgICAgICAvLyAgICAgICAgIHJlcyhKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5zZXBlcnBheSkpXG4gICAgICAgIC8vICAgICB9XG4gICAgICAgIC8vIH0pXG4gICAgfVxuXG4gICAgdGhpcy5zYXZlID0gKG9iaikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygnb2JqOiAnLCBvYmopO1xuICAgICAgICAvLyB2YXIga2V5ID0gb2JqXG4gICAgICAgIC8vIHZhciBvYmogPSBKU09OLnN0cmluZ2lmeShvYmopXG4gICAgICAgIC8vIGxvY2FsU3RvcmFnZVxuICAgIH1cbn1cbiIsIid1c2Ugc3RyaWN0JztcblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ3BpbmNoQXBwJylcbiAgICAuY29udHJvbGxlcignaG9tZUN0cmwnLCBob21lQ3RybClcbiAgICAuY29udHJvbGxlcignYXV0aEN0cmwnLCBhdXRoQ3RybClcbiAgICAuY29udHJvbGxlcignZGFzaGJvYXJkQ3RybCcsIGRhc2hib2FyZEN0cmwpXG4gICAgLmNvbnRyb2xsZXIoJ2Rhc2hib2FyZFBsYW5DdHJsJywgZGFzaGJvYXJkUGxhbkN0cmwpXG5cbmZ1bmN0aW9uIGhvbWVDdHJsKCRzY29wZSwgJGF1dGgsICRzdGF0ZSwgQWNjb3VudCwgJHdpbmRvdywgJHJvb3RTY29wZSwgJGxvY2F0aW9uKSB7XG4gICAgJHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZVN1Y2Nlc3MnLCBmdW5jdGlvbihldiwgdG8sIHRvUGFyYW1zLCBmcm9tLCBmcm9tUGFyYW1zKSB7XG4gICAgICAgICRyb290U2NvcGUucHJldmlvdXNTdGF0ZSA9IGZyb20ubmFtZTtcbiAgICAgICAgJHJvb3RTY29wZS5jdXJyZW50U3RhdGUgPSB0by5uYW1lO1xuICAgICAgICBjb25zb2xlLmxvZygkcm9vdFNjb3BlLnByZXZpb3VzU3RhdGUsICcgPj4+ICcsICRyb290U2NvcGUuY3VycmVudFN0YXRlKVxuICAgICAgICBpZiAoJHJvb3RTY29wZS5jdXJyZW50U3RhdGUgPT0gJ2F1dGhFbnRyYW5jZScgJiYgJHNjb3BlLmN1cnJlbnRVc2VyKSAkc3RhdGUuZ28oJ2Rhc2hib2FyZCcpXG4gICAgICAgICRzY29wZS5jdXJyZW50VXJsID0gJGxvY2F0aW9uLiQkcGF0aDtcbiAgICAgICAgZ2V0Q3VycmVudFVzZXIoKVxuICAgIH0pXG5cbiAgICBmdW5jdGlvbiBnZXRDdXJyZW50VXNlcigpIHtcbiAgICAgICAgaWYgKCRhdXRoLmdldFRva2VuKCkpIHtcbiAgICAgICAgICAgIEFjY291bnQuZ2V0Q3VycmVudFVzZXIoJGF1dGguZ2V0VG9rZW4oKSlcbiAgICAgICAgICAgICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnQEN1cnJlbnRVc2VyOiAnLCByZXMuZGF0YSlcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5jdXJyZW50VXNlciA9IHJlcy5kYXRhXG4gICAgICAgICAgICAgICAgfSwgKGVycikgPT4gJHN0YXRlLmdvKCdhdXRoRW50cmFuY2UnKSlcbiAgICAgICAgfSBlbHNlIGlmICghJGF1dGguZ2V0VG9rZW4oKSAmJiAkbG9jYXRpb24uJCRwYXRoLmluY2x1ZGVzKCdkYXNoYm9hcmQnKSkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdhdXRoRW50cmFuY2UnKVxuICAgICAgICB9XG4gICAgfVxufVxuXG5mdW5jdGlvbiBhdXRoQ3RybCgkc2NvcGUsICRhdXRoLCAkc3RhdGUsIEFjY291bnQsICR3aW5kb3csICRyb290U2NvcGUpIHtcbiAgICAkc2NvcGUuYXV0aF9lbnRlciA9IChhdXRoRGF0YSkgPT4ge1xuICAgICAgICAkYXV0aC5zaWdudXAoYXV0aERhdGEpXG4gICAgICAgICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICAgICAgICAgICRhdXRoLnNldFRva2VuKHJlcyk7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdkYXNoYm9hcmQnLCB7fSwge1xuICAgICAgICAgICAgICAgICAgICByZWxvYWQ6IHRydWVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXMgQGF1dGhfZW50ZXI6ICcsIHJlcy5kYXRhKVxuICAgICAgICAgICAgfSwgKGVycikgPT4gY29uc29sZS5sb2coJ2VyciBAYXV0aF9lbnRlcjogJywgZXJyKSlcbiAgICB9XG5cbiAgICAkc2NvcGUuYXV0aGVudGljYXRlID0gKHByb3ZpZGVyKSA9PiB7XG4gICAgICAgICRhdXRoLmF1dGhlbnRpY2F0ZShwcm92aWRlcik7XG4gICAgfVxuXG59XG5cbmZ1bmN0aW9uIGRhc2hib2FyZEN0cmwoJHNjb3BlLCAkYXV0aCwgJHN0YXRlLCBBY2NvdW50LCAkcm9vdFNjb3BlLCBQYXltZW50LCAkd2luZG93KSB7XG4gICAgLy8gY29uc29sZS5sb2coJ2Rhc2hib2FyZEN0cmwgbG9hZGVkJylcbiAgICAvLyBjaGVja1ZlcmlmeVBob25lU2VudFN0YXR1cygkcm9vdFNjb3BlLmN1cnJlbnRVc2VyKVxuXG4gICAgJHNjb3BlLmxvZ291dCA9ICgpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ2NoZWNrJyk7XG4gICAgICAgICRhdXRoLmxvZ291dCgpXG4gICAgICAgICRzY29wZS5jdXJyZW50VXNlciA9IG51bGw7XG4gICAgICAgICRzdGF0ZS5nbygnbGFuZGluZycsIHt9LCB7XG4gICAgICAgICAgICByZWxvYWQ6IHRydWVcbiAgICAgICAgfSlcbiAgICAgICAgJHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjaGVja1ZlcmlmeVBob25lU2VudFN0YXR1cyhjdXJyZW50VXNlckRhdGEpIHtcbiAgICAgICAgJHNjb3BlLnZlcmlmeVBob25lU2VudE91dCA9IGZhbHNlXG5cbiAgICAgICAgbGV0IGV4cGlyZWRUaW1lID0gTnVtYmVyKGN1cnJlbnRVc2VyRGF0YS5waG9uZS52ZXJpZnlDb2RlLmV4cGlyZWRBdClcbiAgICAgICAgbGV0IG5vd1RpbWUgPSBEYXRlLm5vdygpXG4gICAgICAgIGlmIChleHBpcmVkVGltZSA+IG5vd1RpbWUpIHtcbiAgICAgICAgICAgICRzY29wZS52ZXJpZnlQaG9uZVNlbnRPdXQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgICRzY29wZS52ZXJpZnlQaG9uZUNvdW50RG93biA9ICgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBgJHtleHBpcmVkVGltZX1gXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAkc2NvcGUuc2VuZFZlcmlmeUNvZGUgPSAocGhvbmUpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ3Bob25lOiAnLCBwaG9uZSlcbiAgICAgICAgaWYgKHBob25lLmxlbmd0aCA+IDUpIHtcbiAgICAgICAgICAgIHZhciB1c2VyT2JqID0ge1xuICAgICAgICAgICAgICAgIHVzZXJEYXRhOiAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyLFxuICAgICAgICAgICAgICAgIHBob25lOiBwaG9uZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3VzZXJPYmo6ICcsIHVzZXJPYmopO1xuICAgICAgICAgICAgQWNjb3VudC5zZW5kVmVyaWZ5Q29kZSh1c2VyT2JqKVxuICAgICAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXMgQHNlbmRWZXJpZnlDb2RlOiAnLCByZXMuZGF0YSlcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5jdXJyZW50VXNlci5waG9uZS5kYXRhID0gcGhvbmU7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS52ZXJpZnlQaG9uZVNlbnRPdXQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0sIGVyciA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnIgQHNlbmRWZXJpZnlDb2RlOiAnLCBlcnIpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9XG4gICAgJHNjb3BlLnZlcmlmeUNvZGUgPSAoY29kZSkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygnY29kZTogJywgY29kZSlcbiAgICAgICAgaWYgKGNvZGUubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICB2YXIgdXNlck9iaiA9IHtcbiAgICAgICAgICAgICAgICB1c2VyRGF0YTogJHJvb3RTY29wZS5jdXJyZW50VXNlcixcbiAgICAgICAgICAgICAgICBjb2RlOiBjb2RlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBBY2NvdW50LnZlcmlmeUNvZGUodXNlck9iailcbiAgICAgICAgICAgICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncmVzIEB2ZXJpZnlDb2RlOiAnLCByZXMuZGF0YSlcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLm1zZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLm1zZyA9PSAnaW5jb3JyZWN0Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnI6IGluY29ycmVjdCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXMuZGF0YS5tc2cgPSAnZXhwaXJlZCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2VycjogZXhwaXJlZCcpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyLnBob25lLnZlcmlmaWVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIGVyciA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnIgQHZlcmlmeUNvZGU6ICcsIGVycik7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH1cblxuICAgICRzY29wZS5kb0NoZWNrb3V0ID0gKHRva2VuKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdmZmYnKTtcbiAgICAgICAgY29uc29sZS5sb2coJ3Rva2VuOiAnLCB0b2tlbik7XG4gICAgICAgIHZhciBkYXRhT2JqID0ge1xuICAgICAgICAgICAgc3RyaXBlVG9rZW46IHRva2VuLFxuICAgICAgICAgICAgdXNlckRhdGE6ICRyb290U2NvcGUuY3VycmVudFVzZXJcbiAgICAgICAgfVxuICAgICAgICBQYXltZW50LmNoYXJnZU5vdyhkYXRhT2JqKS50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygncmVzOiAnLCByZXMuZGF0YSk7XG4gICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2VycjogJywgZXJyKTtcbiAgICAgICAgfSlcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRhc2hib2FyZFBsYW5DdHJsKCRzY29wZSwgQWNjb3VudCwgJHN0YXRlUGFyYW1zLCAkc3RhdGUsIFBsYW4sICRyb290U2NvcGUpIHtcbiAgICBjb25zb2xlLmxvZygnZGFzaGJvYXJkUGxhbkN0cmwgbG9hZGVkJyk7XG5cbiAgICBpZiAoJHJvb3RTY29wZS5jdXJyZW50U3RhdGUgPT0gJ2Rhc2hib2FyZF9wbGFuX3NpbmdsZScpIHtcbiAgICAgICAgJHNjb3BlLnVwZGF0ZVRpbWVzID0gKHRpbWVzKSA9PiB7XG4gICAgICAgICAgICAkc2NvcGUuaW5zdGFsbG1lbnRzR3JhcGhEYXRhID0gW11cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGltZXM7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBpbnN0YWxsbWVudCA9IH5+KCgkc2NvcGUucGxhbi50b3RhbCAvIHRpbWVzKSk7XG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IH5+KDIwMCAqICgyIC8gdGltZXMpKVxuICAgICAgICAgICAgICAgICRzY29wZS5pbnN0YWxsbWVudHNHcmFwaERhdGEucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIHByaWNlOiBpbnN0YWxsbWVudCxcbiAgICAgICAgICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogYCR7aGVpZ2h0fXB4YCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBgOTAlYFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS5kZWZhdWx0UGxhblRpbWVzID0gKHRpbWVzKSA9PiB7XG4gICAgICAgICAgICBpZiAoIXRpbWVzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICRzY29wZS5wbGFuLnRpbWVzID0gM1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICRzY29wZS5wbGFuXG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUucHJldmlld1NpbmdsZVBsYW4gPSAocGxhbikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ3BsYW46ICcsIHBsYW4pO1xuICAgICAgICAgICAgUGxhbi5hZGRTaW5nbGVQcmV2aWV3KHBsYW4pLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2Rhc2hib2FyZF9wbGFuX3NpbmdsZV9wcmV2aWV3JylcbiAgICAgICAgICAgIH0sIChlcnIpID0+IGNvbnNvbGUubG9nKCdlcnIgQGFkZFNpbmdsZVByZXZpZXc6ICcsIGVycikpXG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUucGxhbiA9IHt9XG5cbiAgICAgICAgJHNjb3BlLnNpbmdsZVBheW1lbnQgPSAoKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gKCgkc2NvcGUucGxhbi50b3RhbCAtICRzY29wZS5wbGFuLmRvd25wYXkpIC8gJHNjb3BlLnBsYW4udGltZXMpXG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUuaW50ZXJ2YWxTZWxlY3RlZCA9IChjaG9pY2UpID0+IHtcbiAgICAgICAgICAgIGlmICgkc2NvcGUucGxhbi5pbnRlcnZhbCA9PSBjaG9pY2UpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUucGxhbi5pbnRlcnZhbCA9IG51bGxcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnBsYW4uaW50ZXJ2YWwgPSBjaG9pY2VcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmICgkcm9vdFNjb3BlLmN1cnJlbnRTdGF0ZSA9PSAnZGFzaGJvYXJkX3BsYW5fc2luZ2xlX3ByZXZpZXcnKSB7XG4gICAgICAgIFBsYW4uZ2V0U2luZ2xlUHJldmlldygpLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXMgQGdldFNpbmdsZVByZXZpZXc6ICcsIHJlcylcbiAgICAgICAgICAgICRzY29wZS5wbGFuUHJldmlldyA9IHJlcztcbiAgICAgICAgICAgICRzY29wZS5wbGFuUHJldmlldy5pbnN0YWxsbWVudCA9IChyZXMudG90YWwgLSByZXMuZG93bnBheSkgLyByZXMudGltZXNcbiAgICAgICAgfSwgKGVycikgPT4gY29uc29sZS5sb2coJ2VyciBAZ2V0U2luZ2xlUHJldmlldzogJywgZXJyKSlcblxuICAgICAgICAkc2NvcGUuc2F2ZVNpbmdsZVBsYW4gPSAocGxhbikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2cocGxhbilcbiAgICAgICAgICAgIGxldCBzYXZlU2luZ2xlUGxhbkluZm8gPSB7XG4gICAgICAgICAgICAgICAgcGxhbkRldGFpbHM6IHBsYW4sXG4gICAgICAgICAgICAgICAgY3JlYXRvcjogJHJvb3RTY29wZS5jdXJyZW50VXNlclxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3NhdmVTaW5nbGVQbGFuSW5mbzogJywgc2F2ZVNpbmdsZVBsYW5JbmZvKTtcbiAgICAgICAgICAgIFBsYW4uc2F2ZVNpbmdsZVBsYW4oc2F2ZVNpbmdsZVBsYW5JbmZvKVxuICAgICAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXMgQHNhdmVTaW5nbGVQbGFuOiAnLCByZXMuZGF0YSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICRzdGF0ZS5nbygnZGFzaGJvYXJkX3BsYW5fc3RhcnQnLCB7fSwgeyByZWxvYWQ6IHRydWUgfSk7XG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnZGFzaGJvYXJkX3BsYW5fZGV0YWlscycsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYW5JZDogcmVzLmRhdGEuX2lkXG4gICAgICAgICAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbG9hZDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9LCAoZXJyKSA9PiBjb25zb2xlLmxvZygnZXJyIEBzYXZlU2luZ2xlUGxhbjogJywgZXJyKSlcbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS5kYXNoYm9hcmRfcGxhbl9zaW5nbGVfcHJldmlld19nb2JhY2sgPSAocGxhbikgPT4ge1xuICAgICAgICAgICAgaWYgKCRyb290U2NvcGUucHJldmlvdXNTdGF0ZSA9PSAnZGFzaGJvYXJkX3BsYW5fZGV0YWlsc19lZGl0Jykge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnZGFzaGJvYXJkX3BsYW5fZGV0YWlsc19lZGl0Jywge3BsYW5JZDogcGxhbi5faWR9KVxuICAgICAgICAgICAgfWVsc2UgaWYoJHJvb3RTY29wZS5wcmV2aW91c1N0YXRlID09ICdkYXNoYm9hcmRfcGxhbl9zaW5nbGUnKXtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2Rhc2hib2FyZF9wbGFuX3NpbmdsZScpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAkc2NvcGUuZ2V0QWxsUGxhbnMgPSAoKSA9PiB7XG4gICAgICAgIGxldCBjdXJyZW50VXNlcklkID0gJHJvb3RTY29wZS5jdXJyZW50VXNlci5faWRcbiAgICAgICAgY29uc29sZS5sb2coJ2N1cnJlbnRVc2VySWQ6ICcsIGN1cnJlbnRVc2VySWQpO1xuICAgIH1cblxuICAgIGlmICgkcm9vdFNjb3BlLmN1cnJlbnRTdGF0ZSA9PSAnZGFzaGJvYXJkX3BsYW5fZGV0YWlscycpIHtcbiAgICAgICAgUGxhbi5nZXRTaW5nbGVQbGFuKCRzdGF0ZS5wYXJhbXMucGxhbklkKVxuICAgICAgICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncmVzIEBnZXRTaW5nbGVQbGFuOiAnLCByZXMuZGF0YSlcbiAgICAgICAgICAgICAgICAkc2NvcGUucGxhbiA9IHJlcy5kYXRhLmRhdGE7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnBsYW5JZCA9IHJlcy5kYXRhLl9pZFxuICAgICAgICAgICAgICAgICRzY29wZS5pdENyZWF0b3IgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuZGF0YS5jcmVhdG9yLmluY2x1ZGVzKCRyb290U2NvcGUuY3VycmVudFVzZXIuX2lkKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIChlcnIpID0+IGNvbnNvbGUubG9nKCdlcnIgQGdldFNpbmdsZVBsYW46ICcsIGVycikpXG4gICAgfVxuICAgIGlmICgkcm9vdFNjb3BlLmN1cnJlbnRTdGF0ZSA9PSAnZGFzaGJvYXJkX3BsYW5fZGV0YWlsc19lZGl0Jykge1xuICAgICAgICBjb25zb2xlLmxvZygkc3RhdGUucGFyYW1zLnBsYW5JZCk7XG5cbiAgICAgICAgUGxhbi5nZXRTaW5nbGVQbGFuKCRzdGF0ZS5wYXJhbXMucGxhbklkKVxuICAgICAgICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIXJlcy5kYXRhLmNyZWF0b3IuaW5jbHVkZXMoJHJvb3RTY29wZS5jdXJyZW50VXNlci5faWQpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGl0J3Mgbm90IGNyZWF0b3IsIHRoZW4gYmxvY2sgdGhlIHVzZXIgb3V0XG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnZGFzaGJvYXJkJylcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlcyBAZ2V0U2luZ2xlUGxhbjogJywgcmVzLmRhdGEpXG4gICAgICAgICAgICAgICAgJHNjb3BlLnBsYW4gPSByZXMuZGF0YS5kYXRhXG4gICAgICAgICAgICAgICAgJHNjb3BlLnBsYW4uX2lkID0gcmVzLmRhdGEuX2lkXG4gICAgICAgICAgICAgICAgJHNjb3BlLml0Q3JlYXRvciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5kYXRhLmNyZWF0b3IuaW5jbHVkZXMoJHJvb3RTY29wZS5jdXJyZW50VXNlci5faWQpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS51cGRhdGVUaW1lcyA9ICh0aW1lcykgPT4ge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaW5zdGFsbG1lbnRzR3JhcGhEYXRhID0gW11cbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aW1lczsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5zdGFsbG1lbnQgPSB+figoJHNjb3BlLnBsYW4udG90YWwgLyB0aW1lcykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IH5+KDIwMCAqICgyIC8gdGltZXMpKVxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmluc3RhbGxtZW50c0dyYXBoRGF0YS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmljZTogaW5zdGFsbG1lbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBgJHtoZWlnaHR9cHhgLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogYDkwJWBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgJHNjb3BlLmRlZmF1bHRQbGFuVGltZXMgPSAodGltZXMpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aW1lcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRzY29wZS5wbGFuLnRpbWVzID0gM1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAkc2NvcGUucGxhblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICRzY29wZS5wcmV2aWV3U2luZ2xlUGxhbiA9IChwbGFuKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIFBsYW4uYWRkU2luZ2xlUHJldmlldyhwbGFuKS50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2Rhc2hib2FyZF9wbGFuX3NpbmdsZV9wcmV2aWV3JylcbiAgICAgICAgICAgICAgICAgICAgfSwgKGVycikgPT4gY29uc29sZS5sb2coJ2VyciBAYWRkU2luZ2xlUHJldmlldzogJywgZXJyKSlcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAkc2NvcGUuc2luZ2xlUGF5bWVudCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgoJHNjb3BlLnBsYW4udG90YWwgLSAkc2NvcGUucGxhbi5kb3ducGF5KSAvICRzY29wZS5wbGFuLnRpbWVzKVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICRzY29wZS5pbnRlcnZhbFNlbGVjdGVkID0gKGNob2ljZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnBsYW4uaW50ZXJ2YWwgPT0gY2hvaWNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGxhbi5pbnRlcnZhbCA9IG51bGxcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5wbGFuLmludGVydmFsID0gY2hvaWNlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCAoZXJyKSA9PiBjb25zb2xlLmxvZygnZXJyIEBnZXRTaW5nbGVQbGFuOiAnLCBlcnIpKVxuICAgIH1cbn1cbiIsIid1c2Ugc3RyaWN0JztcblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ3BpbmNoQXBwJylcbiAgICAuZGlyZWN0aXZlKCdmb2N1c09uJywgZm9jdXNPbilcblxuZnVuY3Rpb24gZm9jdXNPbigpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGVsZW0sIGF0dHIpIHtcbiAgICAgICAgc2NvcGUuJG9uKCdmb2N1c09uJywgZnVuY3Rpb24oZSwgbmFtZSkge1xuICAgICAgICAgICAgaWYgKG5hbWUgPT09IGF0dHIuZm9jdXNPbikge1xuICAgICAgICAgICAgICAgIGVsZW1bMF0uZm9jdXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbn1cbiIsIid1c2Ugc3RyaWN0JztcblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ3BpbmNoQXBwJylcbiAgICAuZGlyZWN0aXZlKCd0b29sVGlwJywgdG9vbFRpcClcblxuZnVuY3Rpb24gdG9vbFRpcCgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudCgnLnRvb2wtdGlwJykub24oJ2NsaWNrIG1vdXNlbGVhdmUnLCBoaWRlVG9vbHRpcCk7XG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudCgnLnRvb2wtdGlwJykub24oJ21vdXNlZW50ZXInLCBzaG93VG9vbHRpcCk7XG4gICAgfTtcbn1cblxuZnVuY3Rpb24gaGlkZVRvb2x0aXAoKSB7XG4gICAgJCh0aGlzKS50b29sdGlwKCdoaWRlJyk7XG59XG5cbmZ1bmN0aW9uIHNob3dUb29sdGlwKCkge1xuICAgICQodGhpcykudG9vbHRpcCgnc2hvdycpO1xufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
